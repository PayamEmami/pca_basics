<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 PCA (mathematical details) | Principal Component Analysis (PCA)</title>
  <meta name="description" content="This is a short tutorial on how PCA works." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 PCA (mathematical details) | Principal Component Analysis (PCA)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a short tutorial on how PCA works." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 PCA (mathematical details) | Principal Component Analysis (PCA)" />
  
  <meta name="twitter:description" content="This is a short tutorial on how PCA works." />
  

<meta name="author" content="Payam Emami" />


<meta name="date" content="2020-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exer.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Principal Component Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="pcamot.html"><a href="pcamot.html"><i class="fa fa-check"></i><b>3</b> PCA (motivation)</a><ul>
<li class="chapter" data-level="3.1" data-path="pcamot.html"><a href="pcamot.html#summary-of-the-previous-chapter"><i class="fa fa-check"></i><b>3.1</b> Summary of the previous chapter</a></li>
<li class="chapter" data-level="3.2" data-path="pcamot.html"><a href="pcamot.html#variance-and-covariance"><i class="fa fa-check"></i><b>3.2</b> variance and covariance</a></li>
<li class="chapter" data-level="3.3" data-path="pcamot.html"><a href="pcamot.html#pcavar"><i class="fa fa-check"></i><b>3.3</b> Finding the largest variance</a></li>
<li class="chapter" data-level="3.4" data-path="pcamot.html"><a href="pcamot.html#pcafri"><i class="fa fa-check"></i><b>3.4</b> PCA (friendly definition)</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pcaapplications.html"><a href="pcaapplications.html"><i class="fa fa-check"></i><b>4</b> PCA (applications)</a><ul>
<li class="chapter" data-level="4.1" data-path="pcaapplications.html"><a href="pcaapplications.html#summary-of-the-previous-chapter-1"><i class="fa fa-check"></i><b>4.1</b> Summary of the previous chapter</a></li>
<li class="chapter" data-level="4.2" data-path="pcaapplications.html"><a href="pcaapplications.html#pcar"><i class="fa fa-check"></i><b>4.2</b> PCA in R</a></li>
<li class="chapter" data-level="4.3" data-path="pcaapplications.html"><a href="pcaapplications.html#centering"><i class="fa fa-check"></i><b>4.3</b> Centering</a></li>
<li class="chapter" data-level="4.4" data-path="pcaapplications.html"><a href="pcaapplications.html#scaling"><i class="fa fa-check"></i><b>4.4</b> Scaling</a></li>
<li class="chapter" data-level="4.5" data-path="pcaapplications.html"><a href="pcaapplications.html#pcavisdimreduct"><i class="fa fa-check"></i><b>4.5</b> Visualization of data and dimensionality reduction</a></li>
<li class="chapter" data-level="4.6" data-path="pcaapplications.html"><a href="pcaapplications.html#pcavarselect"><i class="fa fa-check"></i><b>4.6</b> Variable selection</a></li>
<li class="chapter" data-level="4.7" data-path="pcaapplications.html"><a href="pcaapplications.html#pcabtrm"><i class="fa fa-check"></i><b>4.7</b> Batch removing (removing variance)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exer.html"><a href="exer.html"><i class="fa fa-check"></i><b>5</b> Exercises</a><ul>
<li class="chapter" data-level="5.1" data-path="exer.html"><a href="exer.html#data"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="exer.html"><a href="exer.html#exercise-1"><i class="fa fa-check"></i><b>5.2</b> Exercise 1</a></li>
<li class="chapter" data-level="5.3" data-path="exer.html"><a href="exer.html#exercise-2"><i class="fa fa-check"></i><b>5.3</b> Exercise 2</a></li>
<li class="chapter" data-level="5.4" data-path="exer.html"><a href="exer.html#exercise-3"><i class="fa fa-check"></i><b>5.4</b> Exercise 3</a></li>
<li class="chapter" data-level="5.5" data-path="exer.html"><a href="exer.html#exercise-4"><i class="fa fa-check"></i><b>5.5</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pcamath.html"><a href="pcamath.html"><i class="fa fa-check"></i><b>6</b> PCA (mathematical details)</a><ul>
<li class="chapter" data-level="6.1" data-path="pcamath.html"><a href="pcamath.html#summary-of-the-previous-chapter-2"><i class="fa fa-check"></i><b>6.1</b> Summary of the previous chapter</a></li>
<li class="chapter" data-level="6.2" data-path="pcamath.html"><a href="pcamath.html#foundations"><i class="fa fa-check"></i><b>6.2</b> Foundations</a></li>
<li class="chapter" data-level="6.3" data-path="pcamath.html"><a href="pcamath.html#operations-on-vectors"><i class="fa fa-check"></i><b>6.3</b> Operations on vectors</a></li>
<li class="chapter" data-level="6.4" data-path="pcamath.html"><a href="pcamath.html#matrices"><i class="fa fa-check"></i><b>6.4</b> Matrices</a><ul>
<li class="chapter" data-level="6.4.1" data-path="pcamath.html"><a href="pcamath.html#matrix-multiplication"><i class="fa fa-check"></i><b>6.4.1</b> Matrix multiplication</a></li>
<li class="chapter" data-level="6.4.2" data-path="pcamath.html"><a href="pcamath.html#square-matrices"><i class="fa fa-check"></i><b>6.4.2</b> Square matrices</a></li>
<li class="chapter" data-level="6.4.3" data-path="pcamath.html"><a href="pcamath.html#determinant-of-a-matrix"><i class="fa fa-check"></i><b>6.4.3</b> Determinant of a matrix</a></li>
<li class="chapter" data-level="6.4.4" data-path="pcamath.html"><a href="pcamath.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>6.4.4</b> Inverse of a matrix</a></li>
<li class="chapter" data-level="6.4.5" data-path="pcamath.html"><a href="pcamath.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>6.4.5</b> Rank of a matrix</a></li>
<li class="chapter" data-level="6.4.6" data-path="pcamath.html"><a href="pcamath.html#eigenvector-eigenvalues"><i class="fa fa-check"></i><b>6.4.6</b> Eigenvector &amp; eigenvalues</a></li>
<li class="chapter" data-level="6.4.7" data-path="pcamath.html"><a href="pcamath.html#matrix-diagonalization"><i class="fa fa-check"></i><b>6.4.7</b> Matrix diagonalization</a></li>
<li class="chapter" data-level="6.4.8" data-path="pcamath.html"><a href="pcamath.html#eigendecomposition-of-a-covariance-matrix"><i class="fa fa-check"></i><b>6.4.8</b> Eigendecomposition of a covariance matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="pcamath.html"><a href="pcamath.html#extra-topics"><i class="fa fa-check"></i><b>6.5</b> Extra topics</a><ul>
<li class="chapter" data-level="6.5.1" data-path="pcamath.html"><a href="pcamath.html#pca-and-ellipses"><i class="fa fa-check"></i><b>6.5.1</b> PCA and ellipses</a></li>
<li class="chapter" data-level="6.5.2" data-path="pcamath.html"><a href="pcamath.html#choosing-the-number-of-components"><i class="fa fa-check"></i><b>6.5.2</b> Choosing the number of components</a></li>
<li class="chapter" data-level="6.5.3" data-path="pcamath.html"><a href="pcamath.html#eigenvectors-and-regression"><i class="fa fa-check"></i><b>6.5.3</b> Eigenvectors and regression</a></li>
<li class="chapter" data-level="6.5.4" data-path="pcamath.html"><a href="pcamath.html#eigenvectors-loadings-and-correlation"><i class="fa fa-check"></i><b>6.5.4</b> Eigenvectors, loadings, and correlation</a></li>
<li class="chapter" data-level="6.5.5" data-path="pcamath.html"><a href="pcamath.html#eigenvector-decomposition-vs.-singular-value-decomposition"><i class="fa fa-check"></i><b>6.5.5</b> Eigenvector decomposition vs. singular value decomposition</a></li>
<li class="chapter" data-level="6.5.6" data-path="pcamath.html"><a href="pcamath.html#assumptions-of-pca"><i class="fa fa-check"></i><b>6.5.6</b> Assumptions of PCA</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="pcamath.html"><a href="pcamath.html#final-notes"><i class="fa fa-check"></i><b>6.6</b> Final notes</a></li>
</ul></li>
<li class="divider"></li>
<li>Payam Emami ( <li><a href="https://www.nbis.se/">National Bioinformatics Infrastructure Sweden</a></li>)</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principal Component Analysis (PCA)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pcamath" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> PCA (mathematical details)</h1>
<p>Welcome to the last section of this chapter. We are going to talk a bit about the mathematical details of PCA. It’s important that it’s not necessary to understand the mathematical details of PCA in order to effectively apply this amazing method to your data. One can easily skip this section without having any problems when it comes to the application. So feel free to skip this if you find it difficult to follow!</p>
<div id="summary-of-the-previous-chapter-2" class="section level2">
<h2><span class="header-section-number">6.1</span> Summary of the previous chapter</h2>
<p>Since the beginning of this chapter, we have been talking about variance as a measure of variability in our data. We also talked a bit about covariance as a measure of concordance or redundancy in our data (or even total variance). We saw that working with high-dimensional data is challenging and PCA can help us summarize these dimensions (e.g. genes) into a set of new variables (scores/components) so that we see the pattern of data spread. The new dimensions were promised to be orthogonal (no covariance) and sorted so that the variance of the first variable is always higher than the second one and so on. We are now ready to see how PCA does this amazing calculation.</p>
</div>
<div id="foundations" class="section level2">
<h2><span class="header-section-number">6.2</span> Foundations</h2>
<p>In order to understand the math behind PCA, we need to agree on a set of definitions.</p>

<div class="definition">
<span id="def:scalar" class="definition"><strong>Definition 6.1  (Scalar)  </strong></span>A scalar is a number. We work a lot with scalars. For example age, speed, temperature, etc. Of course, scalars can have signs (positive and negative) and we can add them, subtract them, multiply, etc.
</div>


<div class="definition">
<span id="def:space" class="definition"><strong>Definition 6.2  (Space)  </strong></span>This might sound a bit tricky to understand. In fact, the meaning of space can be very complicated.
In our case, we define the space of a dataset to be the set of all variables defining the dimensions
of the space and their <strong>possible</strong> values define the extent of the space. In math we define space
by <span class="math inline">\({\rm I\!R}^n\)</span> or <span class="math inline">\({\rm I\!E}^n\)</span> where “n” means the number of dimensions.
</div>

<p>For example in our data, we have n=45101 that is equal to the number of genes we have measured, meaning that space our data has 45101 dimensions. You can think about the extent of these dimensions to be all possible expressions of each gene. For example, if we only have two genes in our data, we have <span class="math inline">\({\rm I\!R}^2\)</span> giving us a 2-dimensional space. The size of this space starts from the lowest possible value for the expression of the genes to the highest possible value. The exact measured expression of each gene gives us the location of our observation in the space.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="pcamath.html#cb64-1"></a><span class="co"># Select variable</span></span>
<span id="cb64-2"><a href="pcamath.html#cb64-2"></a>var1&lt;-<span class="dv">18924</span></span>
<span id="cb64-3"><a href="pcamath.html#cb64-3"></a>var3&lt;-<span class="dv">18505</span></span>
<span id="cb64-4"><a href="pcamath.html#cb64-4"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb64-5"><a href="pcamath.html#cb64-5"></a><span class="kw">plot</span>(data[,<span class="kw">c</span>(var1,var3)],<span class="dt">xlab =</span> <span class="st">&quot;Variable 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Variable 2&quot;</span>,</span>
<span id="cb64-6"><a href="pcamath.html#cb64-6"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex1"></span>
<img src="PCA_files/figure-html/spaceex1-1.png" alt="Plot of two genes showing the space defined by these two variables" width="672" />
<p class="caption">
Figure 6.1: Plot of two genes showing the space defined by these two variables
</p>
</div>
<p>In Figure <a href="pcamath.html#fig:spaceex1">6.1</a> we show two variables. the value of <em>variable 1</em> starts from 0 and goes all the way to 20 whereas the value of <em>variable 2</em> starts from 0 and goes to 15. So to put it in context, our space is defined by these variables and their possible values. Our observations (e.g. samples) are just some points or locations in that space. However, for simplicity, we limit the extent of the values to the ones that we observed in our data and not all possible values of variables 1 and 2.</p>
<p>Another way of thinking about space is to imagine <em>outer space</em> which more or less defines what exists in the universe and planets, stars, and in general celestial bodies are located somewhere in space.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="pcamath.html#cb65-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="kw">rep</span>(<span class="st">&#39;https://www.jpl.nasa.gov/spaceimages/images/wallpaper/PIA22564-640x350.jpg&#39;</span>))</span></code></pre></div>
<p><img src="https://www.jpl.nasa.gov/spaceimages/images/wallpaper/PIA22564-640x350.jpg" style="display: block; margin: auto;" /></p>

<div class="definition">
<span id="def:origin" class="definition"><strong>Definition 6.3  (Origin)  </strong></span>Let’s agree that the start of everything is from zero (0). Formally the location where the axis of our space intersects is zero. Another way of thinking about this is if you multiple anything by zero the result will be zero! This is normally denoted by <span class="math inline">\((0,0)\)</span> or sometimes just <span class="math inline">\(O\)</span>.
</div>

<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="pcamath.html#cb66-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb66-2"><a href="pcamath.html#cb66-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb66-3"><a href="pcamath.html#cb66-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb66-4"><a href="pcamath.html#cb66-4"></a></span>
<span id="cb66-5"><a href="pcamath.html#cb66-5"></a><span class="co"># plot the axis</span></span>
<span id="cb66-6"><a href="pcamath.html#cb66-6"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb66-7"><a href="pcamath.html#cb66-7"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb66-8"><a href="pcamath.html#cb66-8"></a></span>
<span id="cb66-9"><a href="pcamath.html#cb66-9"></a><span class="co"># plot arrow and text</span></span>
<span id="cb66-10"><a href="pcamath.html#cb66-10"></a><span class="kw">arrows</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb66-11"><a href="pcamath.html#cb66-11"></a><span class="kw">text</span>(<span class="kw">c</span>(<span class="fl">1.1</span>),<span class="dt">label =</span> <span class="st">&quot;Origin (0,0)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex2"></span>
<img src="PCA_files/figure-html/spaceex2-1.png" alt="Plot of the origin" width="672" />
<p class="caption">
Figure 6.2: Plot of the origin
</p>
</div>

<div class="definition">
<p><span id="def:vectors" class="definition"><strong>Definition 6.4  (Vector)  </strong></span>A vector is basically just a list of numbers, showing a location of a point in space. We like to show the vectors by their name and a small arrow on top of them (<span class="math inline">\(\vec{a}\)</span>). For example, if we say <span class="math inline">\(\vec{a}=[5,13]\)</span>, it means we are referring to a point in space where the value for the first axis is 2 and the second axis is 13. It’s often nice to show the vector with an arrow starting from the origin and finishing exactly at that point.</p>
</div>

<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="pcamath.html#cb67-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb67-2"><a href="pcamath.html#cb67-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb67-3"><a href="pcamath.html#cb67-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb67-4"><a href="pcamath.html#cb67-4"></a></span>
<span id="cb67-5"><a href="pcamath.html#cb67-5"></a><span class="co"># plot the point</span></span>
<span id="cb67-6"><a href="pcamath.html#cb67-6"></a><span class="kw">points</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb67-7"><a href="pcamath.html#cb67-7"></a><span class="co"># plot the axis</span></span>
<span id="cb67-8"><a href="pcamath.html#cb67-8"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb67-9"><a href="pcamath.html#cb67-9"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb67-10"><a href="pcamath.html#cb67-10"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb67-11"><a href="pcamath.html#cb67-11"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">17</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb67-12"><a href="pcamath.html#cb67-12"></a><span class="co"># plot arrow and text</span></span>
<span id="cb67-13"><a href="pcamath.html#cb67-13"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex3"></span>
<img src="PCA_files/figure-html/spaceex3-1.png" alt="Plotting a vector" width="672" />
<p class="caption">
Figure 6.3: Plotting a vector
</p>
</div>
<p>As we said, we like to put our starting point at <span class="math inline">\((0,0)\)</span>. Given this, we can also think about a vector, has magnitude (length of the arrow starting from the origin or distance to the origin), and also the direction to which the arrow is pointing.
So in <a href="#spaceex3">our case</a>, we have a vector that is defined by going to the right along the <span class="math inline">\(x\)</span> axis (red arrow in Figure <a href="pcamath.html#fig:spaceex4">6.4</a>) until reaching point 3 and the start going up along the <span class="math inline">\(y\)</span> axis (blue arrow in Figure <a href="pcamath.html#fig:spaceex4">6.4</a>) to reach the final point.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="pcamath.html#cb68-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb68-2"><a href="pcamath.html#cb68-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb68-3"><a href="pcamath.html#cb68-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb68-4"><a href="pcamath.html#cb68-4"></a></span>
<span id="cb68-5"><a href="pcamath.html#cb68-5"></a><span class="co"># plot the point</span></span>
<span id="cb68-6"><a href="pcamath.html#cb68-6"></a><span class="kw">points</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb68-7"><a href="pcamath.html#cb68-7"></a><span class="co"># plot the axis</span></span>
<span id="cb68-8"><a href="pcamath.html#cb68-8"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb68-9"><a href="pcamath.html#cb68-9"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb68-10"><a href="pcamath.html#cb68-10"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb68-11"><a href="pcamath.html#cb68-11"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb68-12"><a href="pcamath.html#cb68-12"></a><span class="co"># plot arrow and text</span></span>
<span id="cb68-13"><a href="pcamath.html#cb68-13"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb68-14"><a href="pcamath.html#cb68-14"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;Red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb68-15"><a href="pcamath.html#cb68-15"></a><span class="kw">arrows</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex4"></span>
<img src="PCA_files/figure-html/spaceex4-1.png" alt="Plotting a vector and the steps" width="672" />
<p class="caption">
Figure 6.4: Plotting a vector and the steps
</p>
</div>
<p>The magnitude of a vector is calculated by:</p>
<p><span class="math display">\[\|\vec{a}\|=\sqrt{x^2+y^2}\]</span>
Where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are the first and the second element of the vector. So in our case that is equal to <span class="math inline">\(\|\vec{a}\|=\sqrt{5^2+13^2}=13.93\)</span>.</p>
<p>We normally like to measure the direction of a vector based on the angle it makes with the <span class="math inline">\(x\)</span> axis.</p>
<p><span class="math display">\[\theta=\tan^{-1}\frac{x}{y}\]</span>
This thing can easily be calculated in R for example by</p>
<pre><code>atan(y/x)</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="pcamath.html#cb70-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb70-2"><a href="pcamath.html#cb70-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb70-3"><a href="pcamath.html#cb70-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb70-4"><a href="pcamath.html#cb70-4"></a></span>
<span id="cb70-5"><a href="pcamath.html#cb70-5"></a><span class="co"># plot the point</span></span>
<span id="cb70-6"><a href="pcamath.html#cb70-6"></a><span class="kw">points</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb70-7"><a href="pcamath.html#cb70-7"></a><span class="co"># plot the axis</span></span>
<span id="cb70-8"><a href="pcamath.html#cb70-8"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb70-9"><a href="pcamath.html#cb70-9"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb70-10"><a href="pcamath.html#cb70-10"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb70-11"><a href="pcamath.html#cb70-11"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb70-12"><a href="pcamath.html#cb70-12"></a><span class="co"># plot arrow and text</span></span>
<span id="cb70-13"><a href="pcamath.html#cb70-13"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb70-14"><a href="pcamath.html#cb70-14"></a></span>
<span id="cb70-15"><a href="pcamath.html#cb70-15"></a><span class="co"># draw arc</span></span>
<span id="cb70-16"><a href="pcamath.html#cb70-16"></a>plotrix<span class="op">::</span><span class="kw">draw.arc</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">angle2=</span><span class="dv">1</span>)</span>
<span id="cb70-17"><a href="pcamath.html#cb70-17"></a></span>
<span id="cb70-18"><a href="pcamath.html#cb70-18"></a><span class="co"># write text</span></span>
<span id="cb70-19"><a href="pcamath.html#cb70-19"></a><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;1.2&quot;</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex5"></span>
<img src="PCA_files/figure-html/spaceex5-1.png" alt="Plotting a vector and the steps" width="672" />
<p class="caption">
Figure 6.5: Plotting a vector and the steps
</p>
</div>
<p>So by now, we have the magnitude and direction of a vector. A vector also has a span. A span of a vector is a line resulted in stretching the vector from both ends to infinity.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="pcamath.html#cb71-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb71-2"><a href="pcamath.html#cb71-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb71-3"><a href="pcamath.html#cb71-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb71-4"><a href="pcamath.html#cb71-4"></a></span>
<span id="cb71-5"><a href="pcamath.html#cb71-5"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">500</span>,<span class="op">-</span><span class="dv">1300</span>,<span class="dv">500</span>,<span class="dv">1300</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb71-6"><a href="pcamath.html#cb71-6"></a><span class="kw">text</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="st">&quot;span of the vector&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb71-7"><a href="pcamath.html#cb71-7"></a><span class="co"># plot the point</span></span>
<span id="cb71-8"><a href="pcamath.html#cb71-8"></a><span class="kw">points</span>(<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb71-9"><a href="pcamath.html#cb71-9"></a><span class="co"># plot the axis</span></span>
<span id="cb71-10"><a href="pcamath.html#cb71-10"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb71-11"><a href="pcamath.html#cb71-11"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb71-12"><a href="pcamath.html#cb71-12"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb71-13"><a href="pcamath.html#cb71-13"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb71-14"><a href="pcamath.html#cb71-14"></a><span class="co"># plot arrow and text</span></span>
<span id="cb71-15"><a href="pcamath.html#cb71-15"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb71-16"><a href="pcamath.html#cb71-16"></a><span class="co"># draw circle</span></span>
<span id="cb71-17"><a href="pcamath.html#cb71-17"></a>plotrix<span class="op">::</span><span class="kw">draw.arc</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">angle2=</span><span class="dv">1</span>)</span>
<span id="cb71-18"><a href="pcamath.html#cb71-18"></a></span>
<span id="cb71-19"><a href="pcamath.html#cb71-19"></a><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;1.2&quot;</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex6"></span>
<img src="PCA_files/figure-html/spaceex6-1.png" alt="Plotting a vector and the steps" width="672" />
<p class="caption">
Figure 6.6: Plotting a vector and the steps
</p>
</div>
<p>Now we can go ahead and define some preliminary operations on the vector.</p>
</div>
<div id="operations-on-vectors" class="section level2">
<h2><span class="header-section-number">6.3</span> Operations on vectors</h2>

<div class="definition">
<p><span id="def:scalarv" class="definition"><strong>Definition 6.5  (Scalar multiplication)  </strong></span>If we multiply a vector by a scalar (a number) other than one (1), the resulting vector will change magnitude by not direction. However, a vector might flip (pointing to the opposite direction) but it will NEVER change the direction of its span.</p>
<p>When we multiply a scalar to a vector, we take each element of the vector (e.g. <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) and we multiply each of them by that scalar</p>
<p><span class="math display">\[\vec{a} \times j=[x\times j,y\times j]\]</span></p>
where <span class="math inline">\(\vec{a}\)</span> is a vector and <span class="math inline">\(j\)</span> is a scalar.
</div>

<p>For example if we take our vector <span class="math inline">\(\vec{a}=[5,13]\)</span> and multiply by <span class="math inline">\(1.5\)</span> the results will be <span class="math inline">\([5 \times 1.5, 13 \times 1.5]=[7.5,19.5]\)</span>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="pcamath.html#cb72-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb72-2"><a href="pcamath.html#cb72-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb72-3"><a href="pcamath.html#cb72-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb72-4"><a href="pcamath.html#cb72-4"></a></span>
<span id="cb72-5"><a href="pcamath.html#cb72-5"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">500</span>,<span class="op">-</span><span class="dv">1300</span>,<span class="dv">500</span>,<span class="dv">1300</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb72-6"><a href="pcamath.html#cb72-6"></a><span class="kw">text</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="st">&quot;span of the vector&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb72-7"><a href="pcamath.html#cb72-7"></a></span>
<span id="cb72-8"><a href="pcamath.html#cb72-8"></a><span class="co"># plot the axis</span></span>
<span id="cb72-9"><a href="pcamath.html#cb72-9"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb72-10"><a href="pcamath.html#cb72-10"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb72-11"><a href="pcamath.html#cb72-11"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb72-12"><a href="pcamath.html#cb72-12"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb72-13"><a href="pcamath.html#cb72-13"></a><span class="co"># plot arrow and text</span></span>
<span id="cb72-14"><a href="pcamath.html#cb72-14"></a></span>
<span id="cb72-15"><a href="pcamath.html#cb72-15"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span><span class="op">*</span><span class="fl">1.5</span>,<span class="dv">13</span><span class="op">*</span><span class="fl">1.5</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb72-16"><a href="pcamath.html#cb72-16"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb72-17"><a href="pcamath.html#cb72-17"></a></span>
<span id="cb72-18"><a href="pcamath.html#cb72-18"></a><span class="co"># draw circle</span></span>
<span id="cb72-19"><a href="pcamath.html#cb72-19"></a>plotrix<span class="op">::</span><span class="kw">draw.arc</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">angle2=</span><span class="dv">1</span>)</span>
<span id="cb72-20"><a href="pcamath.html#cb72-20"></a></span>
<span id="cb72-21"><a href="pcamath.html#cb72-21"></a><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;1.2&quot;</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex7"></span>
<img src="PCA_files/figure-html/spaceex7-1.png" alt="Multiplying a vector by a scalar" width="672" />
<p class="caption">
Figure 6.7: Multiplying a vector by a scalar
</p>
</div>
<p>As you see in Figure <a href="pcamath.html#fig:spaceex7">6.7</a>, the green vector is the result of the multiplication of our vector by 1.5. The vector has changed magnitude (length) but not the direction. If we now multiply by <span class="math inline">\(-1.5\)</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="pcamath.html#cb73-1"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb73-2"><a href="pcamath.html#cb73-2"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb73-3"><a href="pcamath.html#cb73-3"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb73-4"><a href="pcamath.html#cb73-4"></a></span>
<span id="cb73-5"><a href="pcamath.html#cb73-5"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">500</span>,<span class="op">-</span><span class="dv">1300</span>,<span class="dv">500</span>,<span class="dv">1300</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb73-6"><a href="pcamath.html#cb73-6"></a><span class="kw">text</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="st">&quot;span of the vector&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb73-7"><a href="pcamath.html#cb73-7"></a></span>
<span id="cb73-8"><a href="pcamath.html#cb73-8"></a></span>
<span id="cb73-9"><a href="pcamath.html#cb73-9"></a><span class="co"># plot the axis</span></span>
<span id="cb73-10"><a href="pcamath.html#cb73-10"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb73-11"><a href="pcamath.html#cb73-11"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb73-12"><a href="pcamath.html#cb73-12"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb73-13"><a href="pcamath.html#cb73-13"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb73-14"><a href="pcamath.html#cb73-14"></a><span class="co"># plot arrow and text</span></span>
<span id="cb73-15"><a href="pcamath.html#cb73-15"></a></span>
<span id="cb73-16"><a href="pcamath.html#cb73-16"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span><span class="op">*-</span><span class="fl">1.5</span>,<span class="dv">13</span><span class="op">*-</span><span class="fl">1.5</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb73-17"><a href="pcamath.html#cb73-17"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>)</span>
<span id="cb73-18"><a href="pcamath.html#cb73-18"></a></span>
<span id="cb73-19"><a href="pcamath.html#cb73-19"></a><span class="co"># draw circle</span></span>
<span id="cb73-20"><a href="pcamath.html#cb73-20"></a>plotrix<span class="op">::</span><span class="kw">draw.arc</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">angle2=</span><span class="dv">1</span>)</span>
<span id="cb73-21"><a href="pcamath.html#cb73-21"></a></span>
<span id="cb73-22"><a href="pcamath.html#cb73-22"></a><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;1.2&quot;</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex8"></span>
<img src="PCA_files/figure-html/spaceex8-1.png" alt="Multiplying a vector by a negative scalar" width="672" />
<p class="caption">
Figure 6.8: Multiplying a vector by a negative scalar
</p>
</div>
<p>You see that the green line now points to the negative direction but still stays on the same span (the red dashed line). Let’s move on to the addition. Obviously the same applies if we add a scalar to both elements of the vector.</p>
<p>Now let’s have a look at when we don’t have a scalar but have a vector. Let’s start with addition and subtraction</p>

<div class="definition">
<p><span id="def:vaddition" class="definition"><strong>Definition 6.6  (Vector addition and subtraction)  </strong></span>
We can add or substract two vectors only and only if they have the same number of elements. If we have <span class="math inline">\(\vec{a}=[x,y]\)</span> and <span class="math inline">\(\vec{b}=[p,z]\)</span> and the addition and subtraction are defined:</p>
<p><span class="math display">\[\vec{c}=\vec{a}+\vec{b}=[x+p, y+z]\]</span></p>
<p>and</p>
<p><span class="math display">\[\vec{c}=\vec{a}-\vec{b}=[x-p, y-z]\]</span></p>
<p>Obviously, we take a similar element of the vector and add or subtract them resulting to a new vector.</p>
</div>

<p>Let’s have a look at what it means using an example. Suppose we have two vectors, <span class="math inline">\(\vec{a}=[5,13]\)</span> and <span class="math inline">\(\vec{b}=[3,4]\)</span> we add them together and the result will be</p>
<p><span class="math display">\[\vec{c}=\vec{a}+\vec{b}=[5+3, 13+4]=[8,17]\]</span>
Similarly for subtraction</p>
<p><span class="math display">\[\vec{c}=\vec{a}+\vec{b}=[5-3, 13-4]=[2,9]\]</span></p>
<p>Graphically and verbally we can think about this, start with <span class="math inline">\(\vec{a}=[5,13]\)</span>, from the origin go 5 to the right and 13 up. Great! Stop here. Now let’s continue with <span class="math inline">\(\vec{b}=[3,4]\)</span>. Go 3 steps further to the right and then go 4 steps up! This is <span class="math inline">\(\vec{c}=\vec{a}+\vec{b}\)</span></p>
<p>Let’s look at the graphics:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="pcamath.html#cb74-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb74-2"><a href="pcamath.html#cb74-2"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb74-3"><a href="pcamath.html#cb74-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb74-4"><a href="pcamath.html#cb74-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb74-5"><a href="pcamath.html#cb74-5"></a></span>
<span id="cb74-6"><a href="pcamath.html#cb74-6"></a><span class="co"># plot the axis</span></span>
<span id="cb74-7"><a href="pcamath.html#cb74-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb74-8"><a href="pcamath.html#cb74-8"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb74-9"><a href="pcamath.html#cb74-9"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb74-10"><a href="pcamath.html#cb74-10"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb74-11"><a href="pcamath.html#cb74-11"></a><span class="co"># plot arrow and text</span></span>
<span id="cb74-12"><a href="pcamath.html#cb74-12"></a></span>
<span id="cb74-13"><a href="pcamath.html#cb74-13"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb74-14"><a href="pcamath.html#cb74-14"></a></span>
<span id="cb74-15"><a href="pcamath.html#cb74-15"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb74-16"><a href="pcamath.html#cb74-16"></a><span class="kw">title</span>(<span class="st">&quot;Original vectors a and b&quot;</span>)</span>
<span id="cb74-17"><a href="pcamath.html#cb74-17"></a></span>
<span id="cb74-18"><a href="pcamath.html#cb74-18"></a></span>
<span id="cb74-19"><a href="pcamath.html#cb74-19"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb74-20"><a href="pcamath.html#cb74-20"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb74-21"><a href="pcamath.html#cb74-21"></a></span>
<span id="cb74-22"><a href="pcamath.html#cb74-22"></a></span>
<span id="cb74-23"><a href="pcamath.html#cb74-23"></a></span>
<span id="cb74-24"><a href="pcamath.html#cb74-24"></a><span class="co"># plot the axis</span></span>
<span id="cb74-25"><a href="pcamath.html#cb74-25"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb74-26"><a href="pcamath.html#cb74-26"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb74-27"><a href="pcamath.html#cb74-27"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb74-28"><a href="pcamath.html#cb74-28"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb74-29"><a href="pcamath.html#cb74-29"></a><span class="co"># plot arrow and text</span></span>
<span id="cb74-30"><a href="pcamath.html#cb74-30"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">13</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb74-31"><a href="pcamath.html#cb74-31"></a></span>
<span id="cb74-32"><a href="pcamath.html#cb74-32"></a><span class="kw">arrows</span>(<span class="dv">5</span>,<span class="dv">13</span>,<span class="dv">8</span>,<span class="dv">17</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb74-33"><a href="pcamath.html#cb74-33"></a><span class="kw">title</span>(<span class="st">&quot;Addtion and a and b&quot;</span>)</span>
<span id="cb74-34"><a href="pcamath.html#cb74-34"></a></span>
<span id="cb74-35"><a href="pcamath.html#cb74-35"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">17</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb74-36"><a href="pcamath.html#cb74-36"></a></span>
<span id="cb74-37"><a href="pcamath.html#cb74-37"></a></span>
<span id="cb74-38"><a href="pcamath.html#cb74-38"></a><span class="co"># draw circle</span></span>
<span id="cb74-39"><a href="pcamath.html#cb74-39"></a>plotrix<span class="op">::</span><span class="kw">draw.arc</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">angle2=</span><span class="dv">1</span>)</span>
<span id="cb74-40"><a href="pcamath.html#cb74-40"></a></span>
<span id="cb74-41"><a href="pcamath.html#cb74-41"></a><span class="kw">text</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;1.2&quot;</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex9"></span>
<img src="PCA_files/figure-html/spaceex9-1.png" alt="Adding two vectors" width="672" />
<p class="caption">
Figure 6.9: Adding two vectors
</p>
</div>
<p>We have two vectors, <span class="math inline">\(\vec{a}\)</span> is red, <span class="math inline">\(\vec{b}\)</span> is green and <span class="math inline">\(\vec{c}\)</span> is black. So the black one is the resulting vector. Has it changed span?</p>
<p>Let’s look at the graphics:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="pcamath.html#cb75-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb75-2"><a href="pcamath.html#cb75-2"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb75-3"><a href="pcamath.html#cb75-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb75-4"><a href="pcamath.html#cb75-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb75-5"><a href="pcamath.html#cb75-5"></a></span>
<span id="cb75-6"><a href="pcamath.html#cb75-6"></a><span class="co"># plot the axis</span></span>
<span id="cb75-7"><a href="pcamath.html#cb75-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb75-8"><a href="pcamath.html#cb75-8"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb75-9"><a href="pcamath.html#cb75-9"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb75-10"><a href="pcamath.html#cb75-10"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb75-11"><a href="pcamath.html#cb75-11"></a><span class="co"># plot arrow </span></span>
<span id="cb75-12"><a href="pcamath.html#cb75-12"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">17</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb75-13"><a href="pcamath.html#cb75-13"></a></span>
<span id="cb75-14"><a href="pcamath.html#cb75-14"></a><span class="co"># plot span</span></span>
<span id="cb75-15"><a href="pcamath.html#cb75-15"></a></span>
<span id="cb75-16"><a href="pcamath.html#cb75-16"></a> <span class="kw">segments</span>(<span class="op">-</span><span class="dv">500</span>,<span class="op">-</span><span class="dv">1300</span>,<span class="dv">500</span>,<span class="dv">1300</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb75-17"><a href="pcamath.html#cb75-17"></a><span class="kw">text</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="st">&quot;span of the vector a&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb75-18"><a href="pcamath.html#cb75-18"></a></span>
<span id="cb75-19"><a href="pcamath.html#cb75-19"></a></span>
<span id="cb75-20"><a href="pcamath.html#cb75-20"></a> <span class="kw">segments</span>(<span class="op">-</span><span class="dv">300</span>,<span class="op">-</span><span class="dv">400</span>,<span class="dv">300</span>,<span class="dv">400</span>,<span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb75-21"><a href="pcamath.html#cb75-21"></a><span class="kw">text</span>(<span class="dv">13</span>,<span class="dv">10</span>,<span class="st">&quot;span of the vector b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb75-22"><a href="pcamath.html#cb75-22"></a></span>
<span id="cb75-23"><a href="pcamath.html#cb75-23"></a></span>
<span id="cb75-24"><a href="pcamath.html#cb75-24"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">800</span>,<span class="op">-</span><span class="dv">1700</span>,<span class="dv">800</span>,<span class="dv">1700</span>,<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex10"></span>
<img src="PCA_files/figure-html/spaceex10-1.png" alt="Span of vector a, b and c" width="672" />
<p class="caption">
Figure 6.10: Span of vector a, b and c
</p>
</div>
<p>You can obviously see that the span of <span class="math inline">\(\vec{c}\)</span> (the black dashed line) is not on either of <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span>. We will later talk about why this is important. Perhaps by now, you got the point that vectors are not just a list of numbers (like an expression of a gene for 10 samples) but rather a direction and magnitude.</p>
<p>There are three more things to talk about before moving forward to the next section.</p>
<p>First thing is that we can normalize a vector to have a magnitude of 1 but keep its direction. This can be simply down by diving every element of the vector by its magnitude.</p>
<p><span class="math display">\[\frac{\vec{a}}{\|\vec{a}\|}=[\frac{x}{\|\vec{a}\|},\frac{y}{\|\vec{a}\|}]\]</span></p>
<p>This will give a normalized or unit vector which the same direction but a magnitude of 1. This is handy because we have a vector irrespective of the magnitude but we can multiply it with a scalar to go back to the same vector as we had before.</p>
<p>For example, if we have <span class="math inline">\(\vec{a}=[3,13]\)</span> we can calculate its magnitude as <span class="math inline">\(\sqrt{3^2+13^2}=13.3\)</span> giving us the unit vector of <span class="math inline">\(\hat{a}=[\frac{3}{13.3},\frac{13}{13.3}]=[0.22,0.97]\)</span>. This will come handy later when we do a PCA.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="pcamath.html#cb76-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb76-2"><a href="pcamath.html#cb76-2"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb76-3"><a href="pcamath.html#cb76-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>,<span class="dv">15</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb76-4"><a href="pcamath.html#cb76-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb76-5"><a href="pcamath.html#cb76-5"></a></span>
<span id="cb76-6"><a href="pcamath.html#cb76-6"></a><span class="co"># plot the axis</span></span>
<span id="cb76-7"><a href="pcamath.html#cb76-7"></a><span class="kw">axis</span>(<span class="dv">1</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb76-8"><a href="pcamath.html#cb76-8"></a><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">10</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb76-9"><a href="pcamath.html#cb76-9"></a><span class="kw">axis</span>(<span class="dv">2</span>,<span class="dt">cex=</span><span class="dv">4</span>,<span class="dt">pos =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) )</span>
<span id="cb76-10"><a href="pcamath.html#cb76-10"></a><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">line=</span><span class="op">-</span><span class="dv">16</span>, <span class="dt">cex.lab=</span><span class="fl">1.2</span>,<span class="dt">adj=</span><span class="dv">1</span>)</span>
<span id="cb76-11"><a href="pcamath.html#cb76-11"></a><span class="co"># plot arrow </span></span>
<span id="cb76-12"><a href="pcamath.html#cb76-12"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">13</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb76-13"><a href="pcamath.html#cb76-13"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">13</span>)<span class="op">^</span><span class="dv">2</span>)),<span class="dv">13</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">13</span>)<span class="op">^</span><span class="dv">2</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex11"></span>
<img src="PCA_files/figure-html/spaceex11-1.png" alt="Unit vector of a has been depicted" width="672" />
<p class="caption">
Figure 6.11: Unit vector of a has been depicted
</p>
</div>
<p>As you see in Figure <a href="pcamath.html#fig:spaceex11">6.11</a>, the unit vector (red arrow) has the same direction as the original vector (black arrow) but it’s much smaller. In our example, we can multiple the unit vector to <span class="math inline">\(13.3\)</span> to get back to the original vector as we had.</p>
<p>The second point is that, I guess you noted that we talked about subtraction and addition but we did not talk about the multiplication of two vectors. There are two ways to multiply two vectors. One is called cross product that is written as <span class="math inline">\(\vec{a} \times \vec{b}\)</span> and the second one is called dot product that is written as <span class="math inline">\(\vec{a}\cdot\vec{b}\)</span> (sometimes we don’t write the dot). Throughout this chapter, we will only talk about dot product not the cross product. But just to briefly mention it, cross-product deals with finding an orthogonal to two other lines. That is if we say <span class="math inline">\(\vec{a}=\vec{a} \times \vec{b}\)</span>, it means that <span class="math inline">\(\vec{c}\)</span> is a line that is orthogonal to both <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span>. But Let’s ignore it and talk about the dot product.</p>

<div class="definition">
<p><span id="def:dotprod" class="definition"><strong>Definition 6.7  (Dot product of two vectors)  </strong></span>
The dot product of two vectors <span class="math inline">\(\vec{a}=[x,y]\)</span> and <span class="math inline">\(\vec{b}=[p,z]\)</span> is define as
<span class="math display">\[d=\vec{a}\cdot\vec{b}=x \times p+y \times z\]</span></p>
<p>It might look a bit fancy, but the concept is that we would like to project or mirror vector <span class="math inline">\(\vec{a}\)</span> onto the vector <span class="math inline">\(\vec{b}\)</span> (or perhaps the span of <span class="math inline">\(\vec{b}\)</span>). We take tip of the vector <span class="math inline">\(\vec{a}\)</span>, draw an orthogonal line from the time to the vector <span class="math inline">\(\vec{b}\)</span>, this gives us the location of vector <span class="math inline">\(\vec{a}\)</span> on <span class="math inline">\(\vec{b}\)</span>, let’s call this new location <span class="math inline">\(\vec{d}\)</span>, we now extend the vector <span class="math inline">\(\vec{d}\)</span> by the magnitude of <span class="math inline">\(\|\vec{b}\|\)</span>.</p>
</div>

<p>Ok! That was a little bit too much. Let’s look at an example to make this clear.</p>
<p>Let’s draw vector <span class="math inline">\(\vec{a}\)</span> and <span class="math inline">\(\vec{b}\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="pcamath.html#cb77-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb77-2"><a href="pcamath.html#cb77-2"></a><span class="co"># plot</span></span>
<span id="cb77-3"><a href="pcamath.html#cb77-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">40</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb77-4"><a href="pcamath.html#cb77-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb77-5"><a href="pcamath.html#cb77-5"></a></span>
<span id="cb77-6"><a href="pcamath.html#cb77-6"></a></span>
<span id="cb77-7"><a href="pcamath.html#cb77-7"></a><span class="co"># plot arrow b</span></span>
<span id="cb77-8"><a href="pcamath.html#cb77-8"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb77-9"><a href="pcamath.html#cb77-9"></a><span class="co"># write b</span></span>
<span id="cb77-10"><a href="pcamath.html#cb77-10"></a><span class="kw">text</span>(<span class="dv">10</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dt">labels =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb77-11"><a href="pcamath.html#cb77-11"></a></span>
<span id="cb77-12"><a href="pcamath.html#cb77-12"></a></span>
<span id="cb77-13"><a href="pcamath.html#cb77-13"></a><span class="co"># plot arrow b</span></span>
<span id="cb77-14"><a href="pcamath.html#cb77-14"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dt">y0 =</span> <span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb77-15"><a href="pcamath.html#cb77-15"></a><span class="co"># write a</span></span>
<span id="cb77-16"><a href="pcamath.html#cb77-16"></a><span class="kw">text</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="dt">labels =</span> <span class="st">&quot;a&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb77-17"><a href="pcamath.html#cb77-17"></a></span>
<span id="cb77-18"><a href="pcamath.html#cb77-18"></a><span class="kw">segments</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex12"></span>
<img src="PCA_files/figure-html/spaceex12-1.png" alt="Two vectors a and b" width="672" />
<p class="caption">
Figure 6.12: Two vectors a and b
</p>
</div>
<p>Great! Where does <span class="math inline">\(\vec{a}\)</span> land if it starts falling down? Now let’s take the tip of the <span class="math inline">\(\vec{a}\)</span> and draw a line perpendicular to <span class="math inline">\(\vec{b}\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="pcamath.html#cb78-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb78-2"><a href="pcamath.html#cb78-2"></a><span class="co"># plot</span></span>
<span id="cb78-3"><a href="pcamath.html#cb78-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">40</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb78-4"><a href="pcamath.html#cb78-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb78-5"><a href="pcamath.html#cb78-5"></a></span>
<span id="cb78-6"><a href="pcamath.html#cb78-6"></a></span>
<span id="cb78-7"><a href="pcamath.html#cb78-7"></a><span class="co"># plot arrow b</span></span>
<span id="cb78-8"><a href="pcamath.html#cb78-8"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb78-9"><a href="pcamath.html#cb78-9"></a><span class="co"># write b</span></span>
<span id="cb78-10"><a href="pcamath.html#cb78-10"></a><span class="kw">text</span>(<span class="dv">18</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dt">labels =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb78-11"><a href="pcamath.html#cb78-11"></a></span>
<span id="cb78-12"><a href="pcamath.html#cb78-12"></a></span>
<span id="cb78-13"><a href="pcamath.html#cb78-13"></a><span class="co"># plot arrow b</span></span>
<span id="cb78-14"><a href="pcamath.html#cb78-14"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dt">y0 =</span> <span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb78-15"><a href="pcamath.html#cb78-15"></a><span class="co"># write a</span></span>
<span id="cb78-16"><a href="pcamath.html#cb78-16"></a><span class="kw">text</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="dt">labels =</span> <span class="st">&quot;a&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb78-17"><a href="pcamath.html#cb78-17"></a><span class="co"># draw lines and arrows</span></span>
<span id="cb78-18"><a href="pcamath.html#cb78-18"></a><span class="kw">segments</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb78-19"><a href="pcamath.html#cb78-19"></a><span class="kw">text</span>(<span class="dv">20</span>,<span class="dv">6</span>,<span class="dt">labels =</span> <span class="st">&quot;perpendicular line (projection line)&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb78-20"><a href="pcamath.html#cb78-20"></a><span class="kw">arrows</span>(<span class="dv">4</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">8</span>, <span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb78-21"><a href="pcamath.html#cb78-21"></a><span class="kw">text</span>(<span class="dv">2</span>,<span class="op">-</span><span class="fl">1.5</span>,<span class="dt">labels =</span> <span class="st">&quot;projection location&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex13"></span>
<img src="PCA_files/figure-html/spaceex13-1.png" alt="Two vectors a and b" width="672" />
<p class="caption">
Figure 6.13: Two vectors a and b
</p>
</div>
<p>Now we know the location <span class="math inline">\(\vec{a}\)</span> on <span class="math inline">\(\vec{b}\)</span> this is exactly at 8 we can go ahead and multiply this but the magnitude of <span class="math inline">\(\vec{b}\)</span> (20):</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="pcamath.html#cb79-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb79-2"><a href="pcamath.html#cb79-2"></a><span class="co"># plot</span></span>
<span id="cb79-3"><a href="pcamath.html#cb79-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">165</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb79-4"><a href="pcamath.html#cb79-4"></a> <span class="dt">axes =</span> F,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb79-5"><a href="pcamath.html#cb79-5"></a></span>
<span id="cb79-6"><a href="pcamath.html#cb79-6"></a></span>
<span id="cb79-7"><a href="pcamath.html#cb79-7"></a><span class="co"># plot arrow b</span></span>
<span id="cb79-8"><a href="pcamath.html#cb79-8"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb79-9"><a href="pcamath.html#cb79-9"></a><span class="co"># write b</span></span>
<span id="cb79-10"><a href="pcamath.html#cb79-10"></a><span class="kw">text</span>(<span class="dv">18</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dt">labels =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb79-11"><a href="pcamath.html#cb79-11"></a></span>
<span id="cb79-12"><a href="pcamath.html#cb79-12"></a></span>
<span id="cb79-13"><a href="pcamath.html#cb79-13"></a><span class="co"># plot arrow b</span></span>
<span id="cb79-14"><a href="pcamath.html#cb79-14"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dt">y0 =</span> <span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb79-15"><a href="pcamath.html#cb79-15"></a><span class="co"># write a</span></span>
<span id="cb79-16"><a href="pcamath.html#cb79-16"></a><span class="kw">text</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="dt">labels =</span> <span class="st">&quot;a&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb79-17"><a href="pcamath.html#cb79-17"></a><span class="co"># draw lines and arrows</span></span>
<span id="cb79-18"><a href="pcamath.html#cb79-18"></a><span class="kw">segments</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb79-19"><a href="pcamath.html#cb79-19"></a></span>
<span id="cb79-20"><a href="pcamath.html#cb79-20"></a><span class="kw">text</span>(<span class="dv">50</span>,<span class="dv">6</span>,<span class="dt">labels =</span> <span class="st">&quot;perpendicular line (projection line)&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb79-21"><a href="pcamath.html#cb79-21"></a></span>
<span id="cb79-22"><a href="pcamath.html#cb79-22"></a><span class="kw">arrows</span>(<span class="dv">4</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">8</span>, <span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb79-23"><a href="pcamath.html#cb79-23"></a></span>
<span id="cb79-24"><a href="pcamath.html#cb79-24"></a><span class="kw">text</span>(<span class="dv">10</span>,<span class="op">-</span><span class="fl">1.5</span>,<span class="dt">labels =</span> <span class="st">&quot;projection location&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb79-25"><a href="pcamath.html#cb79-25"></a></span>
<span id="cb79-26"><a href="pcamath.html#cb79-26"></a></span>
<span id="cb79-27"><a href="pcamath.html#cb79-27"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">8</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">0</span>)<span class="op">^</span><span class="dv">2</span>)),<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb79-28"><a href="pcamath.html#cb79-28"></a></span>
<span id="cb79-29"><a href="pcamath.html#cb79-29"></a><span class="kw">text</span>(<span class="dv">150</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dt">labels =</span> <span class="st">&quot;dot product of a.b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex14"></span>
<img src="PCA_files/figure-html/spaceex14-1.png" alt="Two vectors a and b" width="672" />
<p class="caption">
Figure 6.14: Two vectors a and b
</p>
</div>
<p>So the dot product of <span class="math inline">\(\vec{a}\)</span> on <span class="math inline">\(\vec{b}\)</span> will be that dashed red line. One way to think about the whole concept as we have two different cells with different growth rates. We take cell <em>a</em> with some growth apply <em>b</em> growth to it. So if <em>a</em> is already going 2x, and <em>b</em> is going <em>3</em> we take 2 and make it 3 times larger! You will see soon that when we work with unit vectors (magnitude of 1), everything becomes much clearer.</p>
<p>The last thing we want to discuss about the vector is the definition of space (<a href="pcamath.html#def:space">6.2</a>). At that point, we did not know much about the vectors. We now can re-define our space as a vector space. The vector space is the set of all possible vectors that we can draw for our dimensions. So far we have been working on two dimensions and we said that we can think about each dimension as a gene or any kind of measurement of interest. Let’s consider two genes that can be either silent (zero) or have positive expressions. In reality, we barely know the extend of expression of one gene. It might go from zero to some unknown number. But let’s assume that it can go all the way to 20. Now we are given all the power in the world to be able to induce gene expression to create a human (based on two genes only). Since we know some good deal of linear algebra by now, it’s not that difficult! I can go ahead and say I have a person and gene 1=15 and gene 2=5.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="pcamath.html#cb80-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb80-2"><a href="pcamath.html#cb80-2"></a><span class="co"># plot</span></span>
<span id="cb80-3"><a href="pcamath.html#cb80-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb80-4"><a href="pcamath.html#cb80-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb80-5"><a href="pcamath.html#cb80-5"></a><span class="co"># plot arrow b</span></span>
<span id="cb80-6"><a href="pcamath.html#cb80-6"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb80-7"><a href="pcamath.html#cb80-7"></a><span class="co"># add point</span></span>
<span id="cb80-8"><a href="pcamath.html#cb80-8"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex15"></span>
<img src="PCA_files/figure-html/spaceex15-1.png" alt="Gene expression example" width="672" />
<p class="caption">
Figure 6.15: Gene expression example
</p>
</div>
<p>If we think a bit, we see that we can create so many humans by these two genes.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="pcamath.html#cb81-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb81-2"><a href="pcamath.html#cb81-2"></a><span class="co"># plot</span></span>
<span id="cb81-3"><a href="pcamath.html#cb81-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb81-4"><a href="pcamath.html#cb81-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb81-5"><a href="pcamath.html#cb81-5"></a></span>
<span id="cb81-6"><a href="pcamath.html#cb81-6"></a><span class="co">#Draw arrows</span></span>
<span id="cb81-7"><a href="pcamath.html#cb81-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</span>
<span id="cb81-8"><a href="pcamath.html#cb81-8"></a>{</span>
<span id="cb81-9"><a href="pcamath.html#cb81-9"></a>  <span class="kw">set.seed</span>(i)</span>
<span id="cb81-10"><a href="pcamath.html#cb81-10"></a>  g1&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">1</span>)</span>
<span id="cb81-11"><a href="pcamath.html#cb81-11"></a>   <span class="kw">set.seed</span>(i<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb81-12"><a href="pcamath.html#cb81-12"></a>  g2&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,<span class="dv">1</span>)</span>
<span id="cb81-13"><a href="pcamath.html#cb81-13"></a>  <span class="co"># plot arrow b</span></span>
<span id="cb81-14"><a href="pcamath.html#cb81-14"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,g1,g2,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb81-15"><a href="pcamath.html#cb81-15"></a><span class="co"># add point</span></span>
<span id="cb81-16"><a href="pcamath.html#cb81-16"></a><span class="kw">points</span>(g1,g2)</span>
<span id="cb81-17"><a href="pcamath.html#cb81-17"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex16"></span>
<img src="PCA_files/figure-html/spaceex16-1.png" alt="Gene expression example with more vectors" width="672" />
<p class="caption">
Figure 6.16: Gene expression example with more vectors
</p>
</div>
<p>These possible values are in fact part of your vector spaces. Essentially all the vectors that can be created are located in this space. The power we were given to work with such space and create what we want was already covered. Our tools are vector addition, subtraction, scalar multiplication, and possible dot product. There is only one thing left. We need two buffers, each container the two genes that we can activate/deactivate (<strong>ONE at the time</strong>), induce the expression, mix the buffers, and create a human! Our First buffer we call <em>b1</em> is contains both gene 1 and 2, but gene 2 is deactivated, giving us <span class="math inline">\(b1=[gene1,gene2]\)</span>. Let’s say we want to represent activated gene by 1 and deactivated gene by zero so b1 one becomes <span class="math inline">\(b1=[1,0]\)</span>. Let’s do the same thing for our second buffer, <span class="math inline">\(b2=[gene1,gene2]\)</span> and turn gene1 to off, <span class="math inline">\(b1=[0,1]\)</span>. Let’s again say that we want to create a human (<span class="math inline">\(h\)</span>) with gene1=15 and gene2=5 so our sample should <span class="math inline">\(h=[15,5]\)</span>. With the tools that we are given and two buffers <span class="math inline">\(b1=[1,0]\)</span> and <span class="math inline">\(b2=[0,1]\)</span> how can we reach to <span class="math inline">\(h=[15,5]\)</span>?</p>
<p>Well, that is not that difficult.</p>
<p>Let’s induce gene 1 and call it <span class="math inline">\(b1i\)</span>: <span class="math inline">\(b1i=15 \times b1=[15 \times 1, 15 \times 0]=[15,0]\)</span>. Perfect. We induced the first gene but scalar multiplication.
Now we do this for the second gene and call it <span class="math inline">\(b2i\)</span>: <span class="math inline">\(b2i=5 \times b2=[5 \times 0, 5 \times 1]=[0,5]\)</span>. We now have gene 2 again with scalar multiplication.
How can we mix these two genes and make our first human: <span class="math inline">\(h=b1i+b2i=[15+0,5+0]=[15,5]\)</span>. Yess! We made it!</p>
<p>These small raw vectors (<span class="math inline">\(\vec{b1}\)</span> and <span class="math inline">\(vec{b2}\)</span>) together with our operations (addition, multiplication, etc) help us to create any possible vector in our space. These are basis vectors.</p>

<div class="definition">
<p><span id="def:bvectors" class="definition"><strong>Definition 6.8  (Basis vectors)  </strong></span>
The basis vectors are a set of vectors that when used in weighted combination can create any vector in our space. In fact our space itself is defined by the basis vectors. To be called the basis vector, these should be pointing to different directions. To be more concrete, the basis vectors should be linearly independent, meaning that they cannot be created by a combination of other vectors.</p>
<p>Our “default” basis vectors are x=[1,0] and y=[0,1]. That is the only reason that when we plot any data in for example R, the values of our measurements will be plotted exactly as they are. If we assume anything else than x=[1,0] and y=[0,1], our plot will end up being something else. So in short, the default basis vector, let us moving around our space to any point and also show us the original angle of our data. We will see later that we can change these basis vectors in order to rotate our data and see another angle of them. So far let’s agree that our basis is [0,1] and [1,0] and they are used to construct our data vectors. We can think about this, with the help of our data change direction, and magnitude of the basis vectors in order to represent our data in the space defined by the basis vectors.</p>
</div>

<p>Let’s have a look at the previous example. We start with two basis vectors <span class="math inline">\(\vec{b1}=[1,0]\)</span> (blue arrow) and <span class="math inline">\(\vec{b2}=[0,1]\)</span> (green arrow). Our aim was to reach the vector <span class="math inline">\(\vec{h}=[15,5]\)</span> (black point):</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="pcamath.html#cb82-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb82-2"><a href="pcamath.html#cb82-2"></a><span class="co"># plot</span></span>
<span id="cb82-3"><a href="pcamath.html#cb82-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">15</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb82-4"><a href="pcamath.html#cb82-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb82-5"><a href="pcamath.html#cb82-5"></a></span>
<span id="cb82-6"><a href="pcamath.html#cb82-6"></a><span class="co"># draw arrows and text</span></span>
<span id="cb82-7"><a href="pcamath.html#cb82-7"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb82-8"><a href="pcamath.html#cb82-8"></a><span class="kw">text</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="st">&quot;b1&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb82-9"><a href="pcamath.html#cb82-9"></a></span>
<span id="cb82-10"><a href="pcamath.html#cb82-10"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb82-11"><a href="pcamath.html#cb82-11"></a><span class="kw">text</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="st">&quot;b2&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb82-12"><a href="pcamath.html#cb82-12"></a></span>
<span id="cb82-13"><a href="pcamath.html#cb82-13"></a><span class="co"># Draw plot</span></span>
<span id="cb82-14"><a href="pcamath.html#cb82-14"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex17"></span>
<img src="PCA_files/figure-html/spaceex17-1.png" alt="Example of basis vectors" width="672" />
<p class="caption">
Figure 6.17: Example of basis vectors
</p>
</div>
<p>We first calculate this: <span class="math inline">\(b1i\)</span>: <span class="math inline">\(b1i=15 \times b1=[15 \times 1, 15 \times 0]=[15,0]\)</span>, giving us the dashed arrow:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="pcamath.html#cb83-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-2"><a href="pcamath.html#cb83-2"></a><span class="co"># plot</span></span>
<span id="cb83-3"><a href="pcamath.html#cb83-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">15</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb83-4"><a href="pcamath.html#cb83-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb83-5"><a href="pcamath.html#cb83-5"></a><span class="co"># draw arrows</span></span>
<span id="cb83-6"><a href="pcamath.html#cb83-6"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb83-7"><a href="pcamath.html#cb83-7"></a><span class="kw">text</span>(<span class="dv">7</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="st">&quot;b1i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb83-8"><a href="pcamath.html#cb83-8"></a></span>
<span id="cb83-9"><a href="pcamath.html#cb83-9"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb83-10"><a href="pcamath.html#cb83-10"></a><span class="kw">text</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="st">&quot;y&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb83-11"><a href="pcamath.html#cb83-11"></a><span class="co"># put point</span></span>
<span id="cb83-12"><a href="pcamath.html#cb83-12"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex18"></span>
<img src="PCA_files/figure-html/spaceex18-1.png" alt="Example of basis vectors (scale b1)" width="672" />
<p class="caption">
Figure 6.18: Example of basis vectors (scale b1)
</p>
</div>
<p>We then calculate <span class="math inline">\(b2i\)</span>: <span class="math inline">\(b2i=5 \times b2=[5 \times 0, 5 \times 1]=[0,5]\)</span>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="pcamath.html#cb84-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb84-2"><a href="pcamath.html#cb84-2"></a><span class="co"># plot</span></span>
<span id="cb84-3"><a href="pcamath.html#cb84-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">15</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb84-4"><a href="pcamath.html#cb84-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb84-5"><a href="pcamath.html#cb84-5"></a><span class="co"># draw arrows</span></span>
<span id="cb84-6"><a href="pcamath.html#cb84-6"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb84-7"><a href="pcamath.html#cb84-7"></a><span class="kw">text</span>(<span class="dv">7</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="st">&quot;b1i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb84-8"><a href="pcamath.html#cb84-8"></a></span>
<span id="cb84-9"><a href="pcamath.html#cb84-9"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb84-10"><a href="pcamath.html#cb84-10"></a><span class="kw">text</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">2.5</span>,<span class="st">&quot;b2i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb84-11"><a href="pcamath.html#cb84-11"></a></span>
<span id="cb84-12"><a href="pcamath.html#cb84-12"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex19"></span>
<img src="PCA_files/figure-html/spaceex19-1.png" alt="Example of basis vectors (scale b2)" width="672" />
<p class="caption">
Figure 6.19: Example of basis vectors (scale b2)
</p>
</div>
<p>We can now calculate <span class="math inline">\(h=b1i+b2i=[15+0,5+0]=[15,5]\)</span>:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="pcamath.html#cb85-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb85-2"><a href="pcamath.html#cb85-2"></a><span class="co"># plot</span></span>
<span id="cb85-3"><a href="pcamath.html#cb85-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">15</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb85-4"><a href="pcamath.html#cb85-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb85-5"><a href="pcamath.html#cb85-5"></a><span class="co"># draw arrows</span></span>
<span id="cb85-6"><a href="pcamath.html#cb85-6"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb85-7"><a href="pcamath.html#cb85-7"></a><span class="kw">text</span>(<span class="dv">7</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="st">&quot;b1i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb85-8"><a href="pcamath.html#cb85-8"></a></span>
<span id="cb85-9"><a href="pcamath.html#cb85-9"></a><span class="kw">arrows</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb85-10"><a href="pcamath.html#cb85-10"></a><span class="kw">text</span>(<span class="fl">14.5</span>,<span class="fl">2.5</span>,<span class="st">&quot;b2i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb85-11"><a href="pcamath.html#cb85-11"></a></span>
<span id="cb85-12"><a href="pcamath.html#cb85-12"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex20"></span>
<img src="PCA_files/figure-html/spaceex20-1.png" alt="Example of basis vectors (b1i+b2i)" width="672" />
<p class="caption">
Figure 6.20: Example of basis vectors (b1i+b2i)
</p>
</div>
<p>We can now draw a line from the origin to the tip of <span class="math inline">\(b1i+b2i\)</span>:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="pcamath.html#cb86-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb86-2"><a href="pcamath.html#cb86-2"></a><span class="co"># plot</span></span>
<span id="cb86-3"><a href="pcamath.html#cb86-3"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">15</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;Gene 1&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;Gene 2&quot;</span>,</span>
<span id="cb86-4"><a href="pcamath.html#cb86-4"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb86-5"><a href="pcamath.html#cb86-5"></a><span class="co"># draw arrows</span></span>
<span id="cb86-6"><a href="pcamath.html#cb86-6"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb86-7"><a href="pcamath.html#cb86-7"></a><span class="kw">text</span>(<span class="dv">7</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="st">&quot;b1i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb86-8"><a href="pcamath.html#cb86-8"></a></span>
<span id="cb86-9"><a href="pcamath.html#cb86-9"></a><span class="kw">arrows</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb86-10"><a href="pcamath.html#cb86-10"></a><span class="kw">text</span>(<span class="fl">14.5</span>,<span class="fl">2.5</span>,<span class="st">&quot;b2i&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb86-11"><a href="pcamath.html#cb86-11"></a></span>
<span id="cb86-12"><a href="pcamath.html#cb86-12"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb86-13"><a href="pcamath.html#cb86-13"></a><span class="kw">text</span>(<span class="dv">8</span>,<span class="fl">3.5</span>,<span class="st">&quot;h&quot;</span>,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb86-14"><a href="pcamath.html#cb86-14"></a></span>
<span id="cb86-15"><a href="pcamath.html#cb86-15"></a><span class="kw">points</span>(<span class="dv">15</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:spaceex21"></span>
<img src="PCA_files/figure-html/spaceex21-1.png" alt="Example of basis vectors (calculating h)" width="672" />
<p class="caption">
Figure 6.21: Example of basis vectors (calculating h)
</p>
</div>
<p>I hope that you got the point by now. We can use the basis vectors to construct any vector in our space. In fact, our observations vectors (e.g. samples) are basis vectors that have been scaled and added.</p>
<p>We come to the end of the vector section. The important point here is that we have been working on two dimensions, all the operations and concepts discussed so far can be extended to work in a high dimension. Remember our dataset had 45101 dimensions. We have only worked on two of them so far :)</p>
</div>
<div id="matrices" class="section level2">
<h2><span class="header-section-number">6.4</span> Matrices</h2>
<p>Matrices can be thought of as a generalization of vectors where we put multiple vectors together to form a “table”. You can think about an Excel sheet where each row or each column is a vector but the complete sheet is a matrix. We normally store our data in matrices as we showed in Table <a href="pcaapplications.html#tab:tablesample">4.1</a>. As you noticed, matrices have can have columns and rows. These are dimensions of a matrix. In our test data, we dimension is</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="pcamath.html#cb87-1"></a><span class="co"># show dimensions of the data</span></span>
<span id="cb87-2"><a href="pcamath.html#cb87-2"></a><span class="kw">dim</span>(data)</span></code></pre></div>
<pre><code>## [1]    23 45101</code></pre>
<p>Throughout this section, we show matrices with capital letters as opposed to vectors that are shown using small letters.
<span class="math display">\[
A=\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6
\end{bmatrix}
\]</span>
As you see, we have two rows and three columns. When we want to refer to a specific location (<strong>called entry</strong>) in the matrix, we use <em>i</em> for the row index and <em>j</em> for the column index.</p>
<p>For example <span class="math inline">\(A_{1,2}\)</span> refers to an entry sitting in the <strong>first</strong> frow and the **second column of the matrix, giving us <span class="math inline">\(2\)</span>.</p>
<p>We refer to the entire row of the matrix by <em>i,*</em>. For example, <span class="math inline">\(A_{2,*}\)</span> will give us <span class="math inline">\([4,5,6]\)</span>. In the same way, we can refer to the entire column <span class="math inline">\(A_{*,2}\)</span>, giving us <span class="math inline">\([2,5]\)</span>.</p>
<p>Many of the operations defined for the vectors are also applied on the matrices. We can add or subtract them but the important thing is that the matrices <strong>MUST</strong> be the same size (same dimensions) to be able to perform addition and subtraction. In the case of addition and subtraction, each entry of the first matrix will be added or substracted to the same entry (same location) in the second matrix:</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6
\end{bmatrix}+
\begin{bmatrix}
7 &amp; 8 &amp; 9\\
10 &amp; 11 &amp; 12
\end{bmatrix}=
\begin{bmatrix}
1+7 &amp; 2+8 &amp; 3+9\\
4+10 &amp; 5+11 &amp; 6+12
\end{bmatrix}
\]</span>
The same applies in scalar multiplication:</p>
<p><span class="math display">\[
5 \times \begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6
\end{bmatrix}=
\begin{bmatrix}
5 \times 1 &amp; 5 \times 2 &amp; 5 \times 3\\
5 \times 4 &amp; 5 \times 5 &amp; 5 \times 6
\end{bmatrix}
\]</span>
We can think about addition, subtraction, and scalar multiplication the same way as the vectors. However, instead of having one vector, we have multiple ones.</p>
<p>For example, if we add <span class="math inline">\(A=\begin{bmatrix}2&amp;4\\5&amp;3\end{bmatrix}\)</span> and <span class="math inline">\(B=\begin{bmatrix}4&amp;5\\2&amp;2\end{bmatrix}\)</span> we will get <span class="math inline">\(C=\begin{bmatrix}6&amp;9\\7&amp;5\end{bmatrix}\)</span>. We can think about we have two genes (number of columns) and we have two patients (number of rows) in <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. Each patient will give us an arrow.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="pcamath.html#cb89-1"></a><span class="co"># </span></span>
<span id="cb89-2"><a href="pcamath.html#cb89-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb89-3"><a href="pcamath.html#cb89-3"></a><span class="co"># define matrices</span></span>
<span id="cb89-4"><a href="pcamath.html#cb89-4"></a>A&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb89-5"><a href="pcamath.html#cb89-5"></a></span>
<span id="cb89-6"><a href="pcamath.html#cb89-6"></a>B&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">ncol =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb89-7"><a href="pcamath.html#cb89-7"></a></span>
<span id="cb89-8"><a href="pcamath.html#cb89-8"></a>C=A<span class="op">+</span>B</span>
<span id="cb89-9"><a href="pcamath.html#cb89-9"></a></span>
<span id="cb89-10"><a href="pcamath.html#cb89-10"></a><span class="co"># Plot arrows in A</span></span>
<span id="cb89-11"><a href="pcamath.html#cb89-11"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb89-12"><a href="pcamath.html#cb89-12"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb89-13"><a href="pcamath.html#cb89-13"></a><span class="kw">title</span>(<span class="st">&quot;Matrix A&quot;</span>)</span>
<span id="cb89-14"><a href="pcamath.html#cb89-14"></a><span class="co"># draw arrows</span></span>
<span id="cb89-15"><a href="pcamath.html#cb89-15"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,A[<span class="dv">1</span>,<span class="dv">1</span>],A[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-16"><a href="pcamath.html#cb89-16"></a><span class="kw">text</span>(A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;A&#39;</span>[<span class="st">&quot;1,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-17"><a href="pcamath.html#cb89-17"></a></span>
<span id="cb89-18"><a href="pcamath.html#cb89-18"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,A[<span class="dv">2</span>,<span class="dv">1</span>],A[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-19"><a href="pcamath.html#cb89-19"></a><span class="kw">text</span>(A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;A&#39;</span>[<span class="st">&quot;2,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-20"><a href="pcamath.html#cb89-20"></a></span>
<span id="cb89-21"><a href="pcamath.html#cb89-21"></a><span class="co"># Plot arrows in B</span></span>
<span id="cb89-22"><a href="pcamath.html#cb89-22"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb89-23"><a href="pcamath.html#cb89-23"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb89-24"><a href="pcamath.html#cb89-24"></a><span class="kw">title</span>(<span class="st">&quot;Matrix B&quot;</span>)</span>
<span id="cb89-25"><a href="pcamath.html#cb89-25"></a></span>
<span id="cb89-26"><a href="pcamath.html#cb89-26"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,B[<span class="dv">1</span>,<span class="dv">1</span>],B[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-27"><a href="pcamath.html#cb89-27"></a><span class="kw">text</span>(B[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,B[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;B&#39;</span>[<span class="st">&quot;1,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-28"><a href="pcamath.html#cb89-28"></a></span>
<span id="cb89-29"><a href="pcamath.html#cb89-29"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,B[<span class="dv">2</span>,<span class="dv">1</span>],B[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-30"><a href="pcamath.html#cb89-30"></a><span class="kw">text</span>(B[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,B[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;B&#39;</span>[<span class="st">&quot;2,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-31"><a href="pcamath.html#cb89-31"></a></span>
<span id="cb89-32"><a href="pcamath.html#cb89-32"></a><span class="co"># Plot arrows in A+b</span></span>
<span id="cb89-33"><a href="pcamath.html#cb89-33"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb89-34"><a href="pcamath.html#cb89-34"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb89-35"><a href="pcamath.html#cb89-35"></a><span class="kw">title</span>(<span class="st">&quot;Matrix A+B&quot;</span>)</span>
<span id="cb89-36"><a href="pcamath.html#cb89-36"></a></span>
<span id="cb89-37"><a href="pcamath.html#cb89-37"></a><span class="co"># draw arrows</span></span>
<span id="cb89-38"><a href="pcamath.html#cb89-38"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,A[<span class="dv">1</span>,<span class="dv">1</span>],A[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-39"><a href="pcamath.html#cb89-39"></a><span class="kw">text</span>(A[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,A[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;A&#39;</span>[<span class="st">&quot;1,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-40"><a href="pcamath.html#cb89-40"></a></span>
<span id="cb89-41"><a href="pcamath.html#cb89-41"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,A[<span class="dv">2</span>,<span class="dv">1</span>],A[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-42"><a href="pcamath.html#cb89-42"></a><span class="kw">text</span>(A[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,A[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;A&#39;</span>[<span class="st">&quot;2,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-43"><a href="pcamath.html#cb89-43"></a></span>
<span id="cb89-44"><a href="pcamath.html#cb89-44"></a></span>
<span id="cb89-45"><a href="pcamath.html#cb89-45"></a><span class="kw">arrows</span>(A[<span class="dv">1</span>,<span class="dv">1</span>],A[<span class="dv">1</span>,<span class="dv">2</span>],C[<span class="dv">1</span>,<span class="dv">1</span>],C[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb89-46"><a href="pcamath.html#cb89-46"></a><span class="kw">text</span>(C[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,C[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,(<span class="kw">expression</span>(<span class="st">&#39;B&#39;</span>[<span class="st">&quot;1,*&quot;</span>])),<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb89-47"><a href="pcamath.html#cb89-47"></a></span>
<span id="cb89-48"><a href="pcamath.html#cb89-48"></a><span class="kw">arrows</span>(A[<span class="dv">2</span>,<span class="dv">1</span>],A[<span class="dv">2</span>,<span class="dv">2</span>],C[<span class="dv">2</span>,<span class="dv">1</span>],C[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb89-49"><a href="pcamath.html#cb89-49"></a><span class="kw">text</span>(C[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,(<span class="kw">expression</span>(<span class="st">&#39;B&#39;</span>[<span class="st">&quot;2,*&quot;</span>])),<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">adj =</span> <span class="dv">-2</span>)</span>
<span id="cb89-50"><a href="pcamath.html#cb89-50"></a></span>
<span id="cb89-51"><a href="pcamath.html#cb89-51"></a></span>
<span id="cb89-52"><a href="pcamath.html#cb89-52"></a><span class="co">## plot C</span></span>
<span id="cb89-53"><a href="pcamath.html#cb89-53"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb89-54"><a href="pcamath.html#cb89-54"></a> <span class="dt">axes =</span> T,<span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb89-55"><a href="pcamath.html#cb89-55"></a><span class="kw">title</span>(<span class="st">&quot;Matrix C&quot;</span>)</span>
<span id="cb89-56"><a href="pcamath.html#cb89-56"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,C[<span class="dv">1</span>,<span class="dv">1</span>],C[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-57"><a href="pcamath.html#cb89-57"></a><span class="kw">text</span>(C[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,C[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;C&#39;</span>[<span class="st">&quot;1,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span>
<span id="cb89-58"><a href="pcamath.html#cb89-58"></a></span>
<span id="cb89-59"><a href="pcamath.html#cb89-59"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,C[<span class="dv">2</span>,<span class="dv">1</span>],C[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-60"><a href="pcamath.html#cb89-60"></a><span class="kw">text</span>(C[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,<span class="kw">expression</span>(<span class="st">&#39;C&#39;</span>[<span class="st">&quot;2,*&quot;</span>]),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix1"></span>
<img src="PCA_files/figure-html/matrix1-1.png" alt="Example of matrix addition" width="672" />
<p class="caption">
Figure 6.22: Example of matrix addition
</p>
</div>
<p>So what we see in Figure <a href="pcamath.html#fig:matrix1">6.22</a> is that we have two matrices A and B, we take the vectors in B and put them at the tip of the vectors in A, we then draw two lines from the origin to the new tips of B. So as it’s obvious now, this is the same and vector addition we just do it for more vectors.</p>
<div id="matrix-multiplication" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Matrix multiplication</h3>
<p>In order to understand matrix multiplication, we have to think about the space again. <a href="#bvectors">If you remember</a>, we said the we can represent our space by the basis vector <span class="math inline">\(\vec{x}=[1,0]\)</span> and <span class="math inline">\(\vec{y}=[0,1]\)</span>. We can think about this as directions or our guide to move to any points in the space. We said that we can scale them, we can add/subtract them to represent any vectors in the space. Our space is an empty huge place wherein we just put our vectors! The way that we navigate in space, is just by scaling and adding and subtracting the basis vectors. I keep repeating this because it’s important to understand it thoroughly. So let’s have a look at our empty space (well, I just put the grid so we have a feeling of it)</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="pcamath.html#cb90-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb90-2"><a href="pcamath.html#cb90-2"></a><span class="co"># define data</span></span>
<span id="cb90-3"><a href="pcamath.html#cb90-3"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb90-4"><a href="pcamath.html#cb90-4"></a></span>
<span id="cb90-5"><a href="pcamath.html#cb90-5"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb90-6"><a href="pcamath.html#cb90-6"></a><span class="co"># Plot</span></span>
<span id="cb90-7"><a href="pcamath.html#cb90-7"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb90-8"><a href="pcamath.html#cb90-8"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb90-9"><a href="pcamath.html#cb90-9"></a></span>
<span id="cb90-10"><a href="pcamath.html#cb90-10"></a></span>
<span id="cb90-11"><a href="pcamath.html#cb90-11"></a><span class="co"># Draw lines</span></span>
<span id="cb90-12"><a href="pcamath.html#cb90-12"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb90-13"><a href="pcamath.html#cb90-13"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb90-14"><a href="pcamath.html#cb90-14"></a></span>
<span id="cb90-15"><a href="pcamath.html#cb90-15"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb90-16"><a href="pcamath.html#cb90-16"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb90-17"><a href="pcamath.html#cb90-17"></a></span>
<span id="cb90-18"><a href="pcamath.html#cb90-18"></a><span class="co"># Draw arrows</span></span>
<span id="cb90-19"><a href="pcamath.html#cb90-19"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb90-20"><a href="pcamath.html#cb90-20"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix2"></span>
<img src="PCA_files/figure-html/matrix2-1.png" alt="Empty space" width="672" />
<p class="caption">
Figure 6.23: Empty space
</p>
</div>
<p>We can go to any point on this grid, simply using our basis vectors.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="pcamath.html#cb91-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb91-2"><a href="pcamath.html#cb91-2"></a></span>
<span id="cb91-3"><a href="pcamath.html#cb91-3"></a><span class="co"># Define data</span></span>
<span id="cb91-4"><a href="pcamath.html#cb91-4"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb91-5"><a href="pcamath.html#cb91-5"></a></span>
<span id="cb91-6"><a href="pcamath.html#cb91-6"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb91-7"><a href="pcamath.html#cb91-7"></a></span>
<span id="cb91-8"><a href="pcamath.html#cb91-8"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb91-9"><a href="pcamath.html#cb91-9"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb91-10"><a href="pcamath.html#cb91-10"></a></span>
<span id="cb91-11"><a href="pcamath.html#cb91-11"></a><span class="co"># Draw lines</span></span>
<span id="cb91-12"><a href="pcamath.html#cb91-12"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb91-13"><a href="pcamath.html#cb91-13"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb91-14"><a href="pcamath.html#cb91-14"></a></span>
<span id="cb91-15"><a href="pcamath.html#cb91-15"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb91-16"><a href="pcamath.html#cb91-16"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb91-17"><a href="pcamath.html#cb91-17"></a></span>
<span id="cb91-18"><a href="pcamath.html#cb91-18"></a><span class="co"># Draw arrows</span></span>
<span id="cb91-19"><a href="pcamath.html#cb91-19"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb91-20"><a href="pcamath.html#cb91-20"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb91-21"><a href="pcamath.html#cb91-21"></a></span>
<span id="cb91-22"><a href="pcamath.html#cb91-22"></a><span class="kw">points</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix3"></span>
<img src="PCA_files/figure-html/matrix3-1.png" alt="Empty space and a target point" width="672" />
<p class="caption">
Figure 6.24: Empty space and a target point
</p>
</div>
<p>Remember now, this target point can be an observation (e.g. sample, etc). We can move to this point simply by multiplying <span class="math inline">\(\vec{x}\)</span> to 4 and <span class="math inline">\(\vec{y}\)</span> to 3 and then add the resulting vectors, giving us the location of the purple point <span class="math inline">\([4,3]\)</span>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="pcamath.html#cb92-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb92-2"><a href="pcamath.html#cb92-2"></a><span class="co"># Define data</span></span>
<span id="cb92-3"><a href="pcamath.html#cb92-3"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb92-4"><a href="pcamath.html#cb92-4"></a></span>
<span id="cb92-5"><a href="pcamath.html#cb92-5"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb92-6"><a href="pcamath.html#cb92-6"></a><span class="co"># plot data</span></span>
<span id="cb92-7"><a href="pcamath.html#cb92-7"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb92-8"><a href="pcamath.html#cb92-8"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb92-9"><a href="pcamath.html#cb92-9"></a></span>
<span id="cb92-10"><a href="pcamath.html#cb92-10"></a><span class="co"># Draw lines</span></span>
<span id="cb92-11"><a href="pcamath.html#cb92-11"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb92-12"><a href="pcamath.html#cb92-12"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb92-13"><a href="pcamath.html#cb92-13"></a></span>
<span id="cb92-14"><a href="pcamath.html#cb92-14"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb92-15"><a href="pcamath.html#cb92-15"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb92-16"><a href="pcamath.html#cb92-16"></a></span>
<span id="cb92-17"><a href="pcamath.html#cb92-17"></a><span class="co"># Draw arrows</span></span>
<span id="cb92-18"><a href="pcamath.html#cb92-18"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb92-19"><a href="pcamath.html#cb92-19"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb92-20"><a href="pcamath.html#cb92-20"></a></span>
<span id="cb92-21"><a href="pcamath.html#cb92-21"></a><span class="kw">points</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">7</span>)</span>
<span id="cb92-22"><a href="pcamath.html#cb92-22"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix4"></span>
<img src="PCA_files/figure-html/matrix4-1.png" alt="Empty space and a target point" width="672" />
<p class="caption">
Figure 6.25: Empty space and a target point
</p>
</div>
<p>So far we have only changed the vectors. But we can also change the space itself. If we multiply a matrix to space itself, we change the space. You can think about this like stretching, squeezing, etc applied on the whole grid and ALL the things on that grid. It might not be very understandable in the beginning. Let’s have a look at an example.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="pcamath.html#cb93-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb93-2"><a href="pcamath.html#cb93-2"></a><span class="co"># Define data</span></span>
<span id="cb93-3"><a href="pcamath.html#cb93-3"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb93-4"><a href="pcamath.html#cb93-4"></a></span>
<span id="cb93-5"><a href="pcamath.html#cb93-5"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb93-6"><a href="pcamath.html#cb93-6"></a></span>
<span id="cb93-7"><a href="pcamath.html#cb93-7"></a><span class="co"># Plot</span></span>
<span id="cb93-8"><a href="pcamath.html#cb93-8"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb93-9"><a href="pcamath.html#cb93-9"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb93-10"><a href="pcamath.html#cb93-10"></a></span>
<span id="cb93-11"><a href="pcamath.html#cb93-11"></a></span>
<span id="cb93-12"><a href="pcamath.html#cb93-12"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb93-13"><a href="pcamath.html#cb93-13"></a><span class="co"># calculate the transformation</span></span>
<span id="cb93-14"><a href="pcamath.html#cb93-14"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb93-15"><a href="pcamath.html#cb93-15"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb93-16"><a href="pcamath.html#cb93-16"></a></span>
<span id="cb93-17"><a href="pcamath.html#cb93-17"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb93-18"><a href="pcamath.html#cb93-18"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb93-19"><a href="pcamath.html#cb93-19"></a></span>
<span id="cb93-20"><a href="pcamath.html#cb93-20"></a><span class="co"># Draw lines</span></span>
<span id="cb93-21"><a href="pcamath.html#cb93-21"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb93-22"><a href="pcamath.html#cb93-22"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb93-23"><a href="pcamath.html#cb93-23"></a></span>
<span id="cb93-24"><a href="pcamath.html#cb93-24"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb93-25"><a href="pcamath.html#cb93-25"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix5"></span>
<img src="PCA_files/figure-html/matrix5-1.png" alt="Multiply a matrix to space" width="672" />
<p class="caption">
Figure 6.26: Multiply a matrix to space
</p>
</div>
<p>In figure <a href="pcamath.html#fig:matrix5">6.26</a>, we multiply <span class="math inline">\(\begin{bmatrix}1&amp;1\\0&amp;2\end{bmatrix}\)</span> to our space. Please remember, we agreed before that our space was defined by <span class="math inline">\(\vec{x}=[1,0]\)</span> and <span class="math inline">\(\vec{y}=[0,1]\)</span> and for clarification, we plotted all the parallel lines (grid) to <span class="math inline">\(\vec{x}=[1,0]\)</span> and <span class="math inline">\(\vec{y}=[0,1]\)</span>. Isn’t this awesome?! We can transform the space itself. We are in a transformed world! How do we find the new address (location) of the previous point (the purple one) in this new world? Well, the only thing we need, is our guides. The new location of the basis vectors. Once we get them, we can use them to find the new address. Let’s find them:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="pcamath.html#cb94-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb94-2"><a href="pcamath.html#cb94-2"></a></span>
<span id="cb94-3"><a href="pcamath.html#cb94-3"></a><span class="co"># Data</span></span>
<span id="cb94-4"><a href="pcamath.html#cb94-4"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb94-5"><a href="pcamath.html#cb94-5"></a></span>
<span id="cb94-6"><a href="pcamath.html#cb94-6"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb94-7"><a href="pcamath.html#cb94-7"></a></span>
<span id="cb94-8"><a href="pcamath.html#cb94-8"></a><span class="co"># Plot</span></span>
<span id="cb94-9"><a href="pcamath.html#cb94-9"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb94-10"><a href="pcamath.html#cb94-10"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb94-11"><a href="pcamath.html#cb94-11"></a></span>
<span id="cb94-12"><a href="pcamath.html#cb94-12"></a></span>
<span id="cb94-13"><a href="pcamath.html#cb94-13"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb94-14"><a href="pcamath.html#cb94-14"></a><span class="co"># calculate the transformation</span></span>
<span id="cb94-15"><a href="pcamath.html#cb94-15"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb94-16"><a href="pcamath.html#cb94-16"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb94-17"><a href="pcamath.html#cb94-17"></a></span>
<span id="cb94-18"><a href="pcamath.html#cb94-18"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb94-19"><a href="pcamath.html#cb94-19"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb94-20"><a href="pcamath.html#cb94-20"></a></span>
<span id="cb94-21"><a href="pcamath.html#cb94-21"></a><span class="co"># draw lines</span></span>
<span id="cb94-22"><a href="pcamath.html#cb94-22"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb94-23"><a href="pcamath.html#cb94-23"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb94-24"><a href="pcamath.html#cb94-24"></a></span>
<span id="cb94-25"><a href="pcamath.html#cb94-25"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb94-26"><a href="pcamath.html#cb94-26"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb94-27"><a href="pcamath.html#cb94-27"></a></span>
<span id="cb94-28"><a href="pcamath.html#cb94-28"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb94-29"><a href="pcamath.html#cb94-29"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix6"></span>
<img src="PCA_files/figure-html/matrix6-1.png" alt="Multiply a matrix to space, including the basis vectors" width="672" />
<p class="caption">
Figure 6.27: Multiply a matrix to space, including the basis vectors
</p>
</div>
<p>Now we have them. Great. In this new world, <span class="math inline">\(\vec{x}=[1,0]\)</span> so unchanged but <span class="math inline">\(\vec{y}=[1,2]\)</span>. Now we use the same address as before. We said that we multiple <span class="math inline">\(\vec{x}\)</span> to 4, so it becomes, <span class="math inline">\(\vec{x}=[4,0]\)</span> and we multiply <span class="math inline">\(\vec{y}\)</span> to 3 so it becomes <span class="math inline">\(\vec{y}=[3,6]\)</span>. Now we add them <span class="math inline">\(\vec{x}+\vec{y}=[7,6]\)</span>. This is the address of the same point in the new world!</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="pcamath.html#cb95-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb95-2"><a href="pcamath.html#cb95-2"></a><span class="co"># data</span></span>
<span id="cb95-3"><a href="pcamath.html#cb95-3"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb95-4"><a href="pcamath.html#cb95-4"></a></span>
<span id="cb95-5"><a href="pcamath.html#cb95-5"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb95-6"><a href="pcamath.html#cb95-6"></a><span class="co"># plot</span></span>
<span id="cb95-7"><a href="pcamath.html#cb95-7"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb95-8"><a href="pcamath.html#cb95-8"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb95-9"><a href="pcamath.html#cb95-9"></a></span>
<span id="cb95-10"><a href="pcamath.html#cb95-10"></a></span>
<span id="cb95-11"><a href="pcamath.html#cb95-11"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb95-12"><a href="pcamath.html#cb95-12"></a><span class="co"># calculate the transformation</span></span>
<span id="cb95-13"><a href="pcamath.html#cb95-13"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb95-14"><a href="pcamath.html#cb95-14"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb95-15"><a href="pcamath.html#cb95-15"></a></span>
<span id="cb95-16"><a href="pcamath.html#cb95-16"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb95-17"><a href="pcamath.html#cb95-17"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb95-18"><a href="pcamath.html#cb95-18"></a><span class="co"># lines</span></span>
<span id="cb95-19"><a href="pcamath.html#cb95-19"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb95-20"><a href="pcamath.html#cb95-20"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb95-21"><a href="pcamath.html#cb95-21"></a></span>
<span id="cb95-22"><a href="pcamath.html#cb95-22"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb95-23"><a href="pcamath.html#cb95-23"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb95-24"><a href="pcamath.html#cb95-24"></a></span>
<span id="cb95-25"><a href="pcamath.html#cb95-25"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb95-26"><a href="pcamath.html#cb95-26"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb95-27"><a href="pcamath.html#cb95-27"></a></span>
<span id="cb95-28"><a href="pcamath.html#cb95-28"></a><span class="kw">points</span>((b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">7</span>)</span>
<span id="cb95-29"><a href="pcamath.html#cb95-29"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix7"></span>
<img src="PCA_files/figure-html/matrix7-1.png" alt="Location of the target point" width="672" />
<p class="caption">
Figure 6.28: Location of the target point
</p>
</div>
<p>So to put it simply, we just changed our coordinate system. The way we use to move around space has changed. The only way to find the location of the previous point is to know what transformation has been done to space and what happened to our basis.</p>
<p>Let’s have a look at another transformation.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="pcamath.html#cb96-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb96-2"><a href="pcamath.html#cb96-2"></a><span class="co"># data</span></span>
<span id="cb96-3"><a href="pcamath.html#cb96-3"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb96-4"><a href="pcamath.html#cb96-4"></a></span>
<span id="cb96-5"><a href="pcamath.html#cb96-5"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb96-6"><a href="pcamath.html#cb96-6"></a><span class="co"># plot</span></span>
<span id="cb96-7"><a href="pcamath.html#cb96-7"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb96-8"><a href="pcamath.html#cb96-8"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb96-9"><a href="pcamath.html#cb96-9"></a></span>
<span id="cb96-10"><a href="pcamath.html#cb96-10"></a></span>
<span id="cb96-11"><a href="pcamath.html#cb96-11"></a>tet&lt;-<span class="dv">2</span></span>
<span id="cb96-12"><a href="pcamath.html#cb96-12"></a>b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">cos</span>(tet),<span class="kw">sin</span>(tet),<span class="op">-</span><span class="kw">sin</span>(tet),<span class="kw">cos</span>(tet)),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb96-13"><a href="pcamath.html#cb96-13"></a><span class="co"># calculate the transformation</span></span>
<span id="cb96-14"><a href="pcamath.html#cb96-14"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb96-15"><a href="pcamath.html#cb96-15"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb96-16"><a href="pcamath.html#cb96-16"></a></span>
<span id="cb96-17"><a href="pcamath.html#cb96-17"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb96-18"><a href="pcamath.html#cb96-18"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb96-19"><a href="pcamath.html#cb96-19"></a><span class="co"># lines and arrows</span></span>
<span id="cb96-20"><a href="pcamath.html#cb96-20"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb96-21"><a href="pcamath.html#cb96-21"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb96-22"><a href="pcamath.html#cb96-22"></a></span>
<span id="cb96-23"><a href="pcamath.html#cb96-23"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb96-24"><a href="pcamath.html#cb96-24"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>])})</span>
<span id="cb96-25"><a href="pcamath.html#cb96-25"></a></span>
<span id="cb96-26"><a href="pcamath.html#cb96-26"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb96-27"><a href="pcamath.html#cb96-27"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb96-28"><a href="pcamath.html#cb96-28"></a></span>
<span id="cb96-29"><a href="pcamath.html#cb96-29"></a><span class="kw">points</span>((b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">7</span>)</span>
<span id="cb96-30"><a href="pcamath.html#cb96-30"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))[<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix8"></span>
<img src="PCA_files/figure-html/matrix8-1.png" alt="Location of the target point in rotation" width="672" />
<p class="caption">
Figure 6.29: Location of the target point in rotation
</p>
</div>
<p>Exactly! This transformation has rotated our space. It’s really cool. The next time you use software to rotate your picture, you know there is the math behind it!!
So, We can change our empty base space to “any space” and still find the location at any point in that space.</p>

<div class="definition">
<p><span id="def:matrixm" class="definition"><strong>Definition 6.9  (Matrix multiplication)  </strong></span>
Matrix multiplication is used to transform the space into another shape. This multiplication is defined between two matrices and will produce another matrix as the result. In order to be able to multiply two matrices, the number of columns of the first matrix (left-hand side) <strong>MUST</strong> matches the number of rows in the second matrix. If the dimensions of the first matrix are <span class="math inline">\(l \times m\)</span> and the dimensions of the second matrix is <span class="math inline">\(m \times n\)</span>, the result of the multiplication will be a matrix with dimensions of <span class="math inline">\(l \times n\)</span>. <strong>We show matrix multiplication by just putting to matrix next to each other (e.g. <span class="math inline">\(AB\)</span> for multiplying <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>).</strong> Also please remember that <span class="math inline">\(AB\)</span> is not equal to <span class="math inline">\(BA\)</span>.</p>
<p>To multiply two matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, giving <span class="math inline">\(C\)</span>, we take the first <strong>row</strong> of <span class="math inline">\(A\)</span> and the first <strong>column</strong> of <span class="math inline">\(B\)</span>, multiple the corresponding elements, and sum the results. This result will be the first element in <span class="math inline">\(C\)</span> with location <span class="math inline">\([1,1]\)</span>. We then proceed with the second column of <span class="math inline">\(B\)</span> matrix and calculate its multiplication with the first row of <span class="math inline">\(A\)</span>, sum the results in <span class="math inline">\(C\)</span> at the first row and second column [1,2]. We repeat this until all columns of the second matrix have covered. We then move to the second row of <span class="math inline">\(A\)</span>, we repeat this process but put the results in the second row of <span class="math inline">\(C\)</span>. We keep doing this until we multiply all rows of <span class="math inline">\(A\)</span> by all columns of <span class="math inline">\(B\)</span>.</p>
<p><span class="math display">\[\begin{bmatrix}
a &amp; b \\
c &amp; d 
\end{bmatrix} \ 
\begin{bmatrix}
e &amp; f &amp; g\\
h &amp; i &amp; j
\end{bmatrix}=\begin{bmatrix}
a \times e +  b \times h&amp;
a \times f +  b \times i &amp; 
a \times g +  b \times j\\
c \times e +  d \times h&amp;
c \times f +  d \times i &amp; 
c \times g +  d \times j
\end{bmatrix}\]</span></p>
</div>

<p>Example:
<span class="math display">\[ 
\begin{bmatrix}
1 &amp; 2 \\
4 &amp; 5 
\end{bmatrix} \ 
\begin{bmatrix}
7 &amp; 8 &amp; 9\\
10 &amp; 11 &amp; 12
\end{bmatrix}=\begin{bmatrix}
1 \times 7 +  2 \times 10&amp;
1 \times 8 +  2 \times 11 &amp; 
1 \times 9 +  2 \times 12\\
4 \times 7 +  5 \times 10&amp;
4 \times 8 +  5 \times 11 &amp; 
4 \times 9 +  5 \times 12
\end{bmatrix}=\\\begin{bmatrix}
27 &amp; 30 &amp; 33\\
78 &amp; 87 &amp; 96
\end{bmatrix}
\]</span></p>
<p>Don’t worry if it’s too much work. You can calculate this with pretty much any statistical software. There are even websites that can help you understand and do this multiplication. But for now, let’s discuss what this matrix multiplication means, in the context of our gene expression dataset.</p>
<p>Considering what we have been saying, do you think our gene expression dataset changes the space?</p>
<p>From the linear algebra perspective, yes it does! It might not be that intuitive in the beginning, but if we assume a stem cell as our basis, we then change this stem cell in a way that represents the exact expression pattern found in a sample. We do pretty much the same thing with our spaces/vectors etc. We start with some basis vectors, a raw “meaningless” space (well, maybe biologically), we then change these to show our gene expression space.</p>
<p>So to summarize, we have a raw space (n dimensions) that is defined by a set of unit vectors (e.g. for two dimensions: <span class="math inline">\(\vec{x}=[1,0]\)</span> and <span class="math inline">\(\vec{y}={0,1}\)</span>), we then transform this space using our dataset so we are now in our gene expression space.</p>
<p>We do this simply and naively by</p>
<pre><code>data%*%diag(ncol(data))</code></pre>
<p>This funny operation <em>(%</em>%)* will do matrix multiplication. Read verbally, take a raw space with the dimensions of my data <em>ncol(data)</em> and transform it into my gene expression space. What are the results of this operation if you do it in R? Well, it’s going to be the exact gene expression data that you started with. So we actually don’t need to do that, mathematically, we almost always assume that our starting basis vectors are <span class="math inline">\(\vec{x}=[1,0]\)</span> and <span class="math inline">\(\vec{y}={0,1}\)</span>, etc. So we are in the gene expression space already from the start. Any location/observation/vectors can be found using the combination of genes.</p>
<p>There are a few important things to know before moving forward:</p>
<ul>
<li>Each matrix has two spaces: column space and row space</li>
</ul>
<p>I guess by now, you realized that matrices are very powerful, we can do a lot with them. The question is that what can we say about the transformation a matrix does to our space?
If we have thousands of variables (thousands of dimensions), defining our space transformation, it’s difficult to every time plot and sees what it does. We need to be able to at least say something about the transformation without plotting so many arrows and other stuff!</p>
<p>Almost all the operations that we will be talking about in the rest of the chapter is around square matrices. Let’s quickly define them and go forward with the rest of the chapter.</p>
</div>
<div id="square-matrices" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Square matrices</h3>
<p>A Square matrix is a matrix with the same number of rows and columns. Square matrices are used in linear algebra quite a lot and are easier to work with. There are several reasons why we want to use square matrices but to summarize all:
When we multiply a matrix with <span class="math inline">\(n\)</span> number of rows and <span class="math inline">\(m\)</span> number columns by another matrix with <span class="math inline">\(m\)</span> rows and <span class="math inline">\(l\)</span> columns, we are mapping the space from <span class="math inline">\(m\)</span> to <span class="math inline">\(n\)</span> which is essentially another space which might change the definitions of certain things. In many cases, we would like to stay in the same dimensions (not going to a totally different space). In these cases, square matrices are used to map from <span class="math inline">\(n\)</span> to <span class="math inline">\(n\)</span>, meaning that it maps from a space to itself. Please note that we are still doing the transformation to the vectors and everything else in that space, but we are in the same dimensions. Let’s look at an example.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="pcamath.html#cb98-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb98-2"><a href="pcamath.html#cb98-2"></a></span>
<span id="cb98-3"><a href="pcamath.html#cb98-3"></a><span class="co"># load cat data</span></span>
<span id="cb98-4"><a href="pcamath.html#cb98-4"></a>cat_data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;data/cat.tsv&quot;</span>)</span>
<span id="cb98-5"><a href="pcamath.html#cb98-5"></a><span class="co">#plot</span></span>
<span id="cb98-6"><a href="pcamath.html#cb98-6"></a>scatterplot3d<span class="op">::</span><span class="kw">scatterplot3d</span>(cat_data,<span class="dt">angle =</span> <span class="dv">150</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">zlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb98-7"><a href="pcamath.html#cb98-7"></a><span class="kw">title</span>(<span class="st">&quot;Original data&quot;</span>)</span>
<span id="cb98-8"><a href="pcamath.html#cb98-8"></a></span>
<span id="cb98-9"><a href="pcamath.html#cb98-9"></a></span>
<span id="cb98-10"><a href="pcamath.html#cb98-10"></a><span class="co"># rotation matrix</span></span>
<span id="cb98-11"><a href="pcamath.html#cb98-11"></a>tet&lt;-<span class="fl">3.2</span></span>
<span id="cb98-12"><a href="pcamath.html#cb98-12"></a>b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="kw">cos</span>(tet),<span class="kw">sin</span>(tet),<span class="dv">0</span>,<span class="op">-</span><span class="kw">sin</span>(tet),<span class="kw">cos</span>(tet)),<span class="dt">nrow =</span> <span class="dv">3</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb98-13"><a href="pcamath.html#cb98-13"></a><span class="co">#plot</span></span>
<span id="cb98-14"><a href="pcamath.html#cb98-14"></a>scatterplot3d<span class="op">::</span><span class="kw">scatterplot3d</span>(<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data))),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">zlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb98-15"><a href="pcamath.html#cb98-15"></a><span class="kw">title</span>(<span class="st">&quot;Square matrix (rotation)&quot;</span>)</span>
<span id="cb98-16"><a href="pcamath.html#cb98-16"></a></span>
<span id="cb98-17"><a href="pcamath.html#cb98-17"></a></span>
<span id="cb98-18"><a href="pcamath.html#cb98-18"></a><span class="kw">plot</span>(<span class="kw">t</span>(b[<span class="op">-</span><span class="dv">1</span>,]<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data))),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb98-19"><a href="pcamath.html#cb98-19"></a><span class="kw">title</span>(<span class="st">&quot;2d matrix transformation&quot;</span>)</span>
<span id="cb98-20"><a href="pcamath.html#cb98-20"></a></span>
<span id="cb98-21"><a href="pcamath.html#cb98-21"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">t</span>(b[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),]<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data))),<span class="dt">y=</span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(cat_data)),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb98-22"><a href="pcamath.html#cb98-22"></a><span class="kw">title</span>(<span class="st">&quot;1d matrix transformation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix9"></span>
<img src="PCA_files/figure-html/matrix9-1.png" alt="Cat example" width="672" />
<p class="caption">
Figure 6.30: Cat example
</p>
</div>
<p>You see in Figure <a href="pcamath.html#fig:matrix9">6.30</a> that at some point the meaning of things starts vanishing. We have volume in both top panel but no volume in the bottom ones. Obviously, the 1d transformation totally distorts our view. Can we say the cat’s tail is located in the middle of the body or the legs are almost parallel? Probably not in the 2d and 1d transformation. In any transformation, it’s nice to have the same geometric meaning of the concepts before and after performing such transformation.</p>
<p>In addition, working on square matrices gives us some extra tools that are handy for describing the space and the transformation itself.</p>
</div>
<div id="determinant-of-a-matrix" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Determinant of a matrix</h3>
<p>As we discussed before, matrix multiplication will change the space and anything inside. This change can be rotation, stretching, squeezing, etc. Some transformation such squeezing will make the space smaller, some like stretching will make it bigger, and some like rotation does not change the size or the volume of our space. The determinant of a matrix will summarize for us whether the transformation makes the volume of our data smaller or bigger or unchanged. Let’s have a look at an example:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="pcamath.html#cb99-1"></a><span class="co"># set number of figures</span></span>
<span id="cb99-2"><a href="pcamath.html#cb99-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb99-3"><a href="pcamath.html#cb99-3"></a></span>
<span id="cb99-4"><a href="pcamath.html#cb99-4"></a><span class="co"># read the data</span></span>
<span id="cb99-5"><a href="pcamath.html#cb99-5"></a>cat_data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;data/cat.tsv&quot;</span>)[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb99-6"><a href="pcamath.html#cb99-6"></a></span>
<span id="cb99-7"><a href="pcamath.html#cb99-7"></a><span class="co"># plot the original space</span></span>
<span id="cb99-8"><a href="pcamath.html#cb99-8"></a><span class="kw">plot</span>(cat_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">110</span>,<span class="dv">110</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">150</span>,<span class="dv">150</span>))</span>
<span id="cb99-9"><a href="pcamath.html#cb99-9"></a><span class="co"># write title</span></span>
<span id="cb99-10"><a href="pcamath.html#cb99-10"></a><span class="kw">title</span>(<span class="st">&quot;Original&quot;</span>)</span>
<span id="cb99-11"><a href="pcamath.html#cb99-11"></a></span>
<span id="cb99-12"><a href="pcamath.html#cb99-12"></a><span class="co"># create a rotation matrix</span></span>
<span id="cb99-13"><a href="pcamath.html#cb99-13"></a>tet&lt;-<span class="dv">2</span></span>
<span id="cb99-14"><a href="pcamath.html#cb99-14"></a>b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">cos</span>(tet),<span class="kw">sin</span>(tet),<span class="op">-</span><span class="kw">sin</span>(tet),<span class="kw">cos</span>(tet)),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb99-15"><a href="pcamath.html#cb99-15"></a></span>
<span id="cb99-16"><a href="pcamath.html#cb99-16"></a><span class="co"># plot the rotated data</span></span>
<span id="cb99-17"><a href="pcamath.html#cb99-17"></a>rt_data&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data)))</span>
<span id="cb99-18"><a href="pcamath.html#cb99-18"></a><span class="kw">plot</span>(rt_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">110</span>,<span class="dv">110</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">150</span>,<span class="dv">150</span>))</span>
<span id="cb99-19"><a href="pcamath.html#cb99-19"></a><span class="kw">title</span>(<span class="st">&quot;Rotated&quot;</span>)</span>
<span id="cb99-20"><a href="pcamath.html#cb99-20"></a><span class="co"># do inverse</span></span>
<span id="cb99-21"><a href="pcamath.html#cb99-21"></a>bs&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dv">2</span>)</span>
<span id="cb99-22"><a href="pcamath.html#cb99-22"></a><span class="co"># plot inverse</span></span>
<span id="cb99-23"><a href="pcamath.html#cb99-23"></a><span class="kw">plot</span>(<span class="kw">t</span>(bs<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data))),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">110</span>,<span class="dv">110</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">150</span>,<span class="dv">150</span>))</span>
<span id="cb99-24"><a href="pcamath.html#cb99-24"></a><span class="co"># write title</span></span>
<span id="cb99-25"><a href="pcamath.html#cb99-25"></a><span class="kw">title</span>(<span class="st">&quot;Squeezing&quot;</span>)</span>
<span id="cb99-26"><a href="pcamath.html#cb99-26"></a></span>
<span id="cb99-27"><a href="pcamath.html#cb99-27"></a>bs2&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dv">2</span>)</span>
<span id="cb99-28"><a href="pcamath.html#cb99-28"></a><span class="co"># plot inverse</span></span>
<span id="cb99-29"><a href="pcamath.html#cb99-29"></a><span class="kw">plot</span>(<span class="kw">t</span>(bs2<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data))),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">110</span>,<span class="dv">110</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">150</span>,<span class="dv">150</span>))</span>
<span id="cb99-30"><a href="pcamath.html#cb99-30"></a><span class="co"># write title</span></span>
<span id="cb99-31"><a href="pcamath.html#cb99-31"></a><span class="kw">title</span>(<span class="st">&quot;Stretching&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix10"></span>
<img src="PCA_files/figure-html/matrix10-1.png" alt="Space volume of cat" width="672" />
<p class="caption">
Figure 6.31: Space volume of cat
</p>
</div>
<p>It’s obvious in Figure <a href="pcamath.html#fig:matrix11">6.32</a> that, the volume of data is the same between the original cat picture and the rotated one. This gives us a determinant of 1 for rotated space, meaning that the volume has not changed. Anything lower than one means the volume has decreased. For example, in Squeezing, the determinant is 0.25. Obviously, in stretching, the volume has increasing which gives us the determinant of 2.25, meaning that the volume has increased by 2.25 scaling factor.</p>

<div class="definition">
<p><span id="def:det" class="definition"><strong>Definition 6.10  (Determinant)  </strong></span>The determinant is a scalar value that is computed from square matrices. The absolute value of the determinant shows the scaling of the volume resulted from the matrix transformation. Here we show the determinant of matrix A by |A|.
It should be clear by now that the determinant of zero means that our transformation has mapped the space to something that has no volume, for example, either a line or just the origin. More formally, if there exist two columns or rows in the matrix that are linear dependent (eg. <span class="math inline">\(\vec{a}=c \times \vec{b}\)</span>), the determinant will be zero.</p>
</div>

<p>The determinant of 2 by 2 matrix is calculated by:</p>
<p><span class="math display">\[|A|=\begin{vmatrix} a &amp; b \\ c &amp; d \end{vmatrix}=
  ad-bc\]</span></p>
<p>For 3 by 3:</p>
<p><span class="math display">\[|A|=\begin{vmatrix} a &amp; b &amp;c \\ d &amp; e &amp; f\\g &amp; h &amp;i \end{vmatrix}=
  a\begin{vmatrix} e &amp; f \\ h &amp; i \end{vmatrix}-b\begin{vmatrix} d &amp; f \\ g &amp; i \end{vmatrix}+c\begin{vmatrix} d &amp; e \\ h &amp; g \end{vmatrix}=
  aei+bfg+cdh-ceg-bdi-afh\]</span></p>
<p>For example:</p>
<p><span class="math display">\[|A|=\begin{vmatrix} 1 &amp; 0\\ 0 &amp; 1 \end{vmatrix}=
  1 \times 1-0 \times 0=1\]</span></p>
<p>In practice, these numbers are calculated by software for a programming language.</p>
</div>
<div id="inverse-of-a-matrix" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Inverse of a matrix</h3>
<p>The inverse of a matrix is defined as the opposite transformation of what it does to space (the inverse of a matrix <span class="math inline">\(X\)</span> is shown by <span class="math inline">\(X^{-1}\)</span>). For example, if a matrix rotates the space by <span class="math inline">\(45^o\)</span>, the inverse of it will rotate the space back by <span class="math inline">\(45^o\)</span>. Let’s have a look at an example:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="pcamath.html#cb100-1"></a><span class="co"># set number of figures</span></span>
<span id="cb100-2"><a href="pcamath.html#cb100-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb100-3"><a href="pcamath.html#cb100-3"></a></span>
<span id="cb100-4"><a href="pcamath.html#cb100-4"></a><span class="co"># read the data</span></span>
<span id="cb100-5"><a href="pcamath.html#cb100-5"></a>cat_data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;data/cat.tsv&quot;</span>)[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb100-6"><a href="pcamath.html#cb100-6"></a></span>
<span id="cb100-7"><a href="pcamath.html#cb100-7"></a><span class="co"># plot the original space</span></span>
<span id="cb100-8"><a href="pcamath.html#cb100-8"></a><span class="kw">plot</span>(cat_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb100-9"><a href="pcamath.html#cb100-9"></a><span class="co"># write title</span></span>
<span id="cb100-10"><a href="pcamath.html#cb100-10"></a><span class="kw">title</span>(<span class="st">&quot;Original space&quot;</span>)</span>
<span id="cb100-11"><a href="pcamath.html#cb100-11"></a></span>
<span id="cb100-12"><a href="pcamath.html#cb100-12"></a><span class="co"># create a rotation matrix</span></span>
<span id="cb100-13"><a href="pcamath.html#cb100-13"></a>tet&lt;-<span class="dv">2</span></span>
<span id="cb100-14"><a href="pcamath.html#cb100-14"></a>b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">cos</span>(tet),<span class="kw">sin</span>(tet),<span class="op">-</span><span class="kw">sin</span>(tet),<span class="kw">cos</span>(tet)),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb100-15"><a href="pcamath.html#cb100-15"></a></span>
<span id="cb100-16"><a href="pcamath.html#cb100-16"></a><span class="co"># plot the rotated data</span></span>
<span id="cb100-17"><a href="pcamath.html#cb100-17"></a>rt_data&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(cat_data)))</span>
<span id="cb100-18"><a href="pcamath.html#cb100-18"></a><span class="kw">plot</span>(rt_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb100-19"><a href="pcamath.html#cb100-19"></a><span class="kw">title</span>(<span class="st">&quot;Rotated data&quot;</span>)</span>
<span id="cb100-20"><a href="pcamath.html#cb100-20"></a><span class="co"># do inverse</span></span>
<span id="cb100-21"><a href="pcamath.html#cb100-21"></a>bin&lt;-<span class="kw">solve</span>(b)</span>
<span id="cb100-22"><a href="pcamath.html#cb100-22"></a><span class="co"># plot inverse</span></span>
<span id="cb100-23"><a href="pcamath.html#cb100-23"></a><span class="kw">plot</span>(<span class="kw">t</span>(bin<span class="op">%*%</span><span class="kw">t</span>(<span class="kw">as.matrix</span>(rt_data))),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb100-24"><a href="pcamath.html#cb100-24"></a><span class="co"># write title</span></span>
<span id="cb100-25"><a href="pcamath.html#cb100-25"></a><span class="kw">title</span>(<span class="st">&quot;Inverse of rotation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:matrix11"></span>
<img src="PCA_files/figure-html/matrix11-1.png" alt="Inverse of a matrix" width="672" />
<p class="caption">
Figure 6.32: Inverse of a matrix
</p>
</div>
<p>Another way of understanding the inverse is by thinking about division. If we have a scalar <span class="math inline">\(7\)</span> and multiply it by another scalar <span class="math inline">\(2\)</span>, giving us <span class="math inline">\(14\)</span>, how do we go back to <span class="math inline">\(2\)</span>? Well, we divide <span class="math inline">\(14\)</span> by <span class="math inline">\(7\)</span>. The division is matrix world is by multiply the result matrix by the inverse of the transformation matrix. Therefore, we can deduce that if <span class="math inline">\(\frac{7}{7}=1\)</span>, <span class="math inline">\(X\  X^{-1}=I\)</span>. Here <span class="math inline">\(I\)</span> is a special matrix (called identity matrix) that has “1” on its main diagonal elements and zero elsewhere. I identity matrix does not change the space if multiply with another matrix.</p>

<div class="definition">
<p><span id="def:inv" class="definition"><strong>Definition 6.11  (Inverse of a matrix)  </strong></span>The inverse of matrix <span class="math inline">\(A\)</span> is defined by the reverse transformation induced by A which is denoted by <span class="math inline">\(A^-1\)</span>. More formally if the matrix is invertible, there exists another matrix <span class="math inline">\(A^-1\)</span> where <span class="math inline">\(A \  A^{-1} =A^{-1} \  A=I\)</span>, where <span class="math inline">\(I\)</span> is identity matrix. Not all the matrices have an inverse. If the determinant (<a href="pcamath.html#def:det">6.10</a>) of a matrix is zero, the matrix is not invertible (there is no reverse transformation).</p>
</div>

<p>There are many methods for finding the inverse of a matrix. Here we focus on one solution.</p>
<p>Given, a matrix <span class="math inline">\(A\)</span>, <span class="math inline">\(A^{-1}\)</span> can be calculated using:</p>
<p><span class="math display">\[A^{-1}=\frac{1}{|A|}\begin{vmatrix} C_{11} &amp; C_{21} &amp; ... &amp; C_{n1}\\ C_{12} &amp; C_{22} &amp; ... &amp; C_{n2}\\.&amp;.&amp;.&amp;.\\.&amp;.&amp;.&amp;.\\.&amp;.&amp;.&amp;.\\C_{1n} &amp; C_{2n} &amp; ... &amp; C_{nn}\
\end{vmatrix}\]</span></p>
<p>Yes. It looks scary and in fact, it is!. Let’s break it down to three steps:</p>
<p><strong>Step 1:</strong>
In step one, we want to find that big matrix.</p>
<p><span class="math display">\[\begin{vmatrix} C_{11} &amp; C_{21} &amp; ... &amp; C_{n1}\\ C_{12} &amp; C_{22} &amp; ... &amp; C_{n2}\\\vdots &amp;\vdots&amp;\ddots&amp; \vdots\\C_{1n} &amp; C_{2n} &amp; ... &amp; C_{nn}\
\end{vmatrix}\]</span></p>
<p>This is called cofactors. It still looks scary but let’s look at the square matrix together.</p>
<p><span class="math display">\[\begin{vmatrix} a &amp; b &amp;c \\ d &amp; e &amp; f\\g &amp; h &amp;i \end{vmatrix}\]</span>
Can we see any sub-square in this matrix? Let’s try to see how we can extract the sub squares of this matrix:</p>
<p>Let’s select the first element of the matrix, that is <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[\left|\begin{array}{ccc}
\textbf{a} &amp; \underline{b} &amp; \underline{c}\\ 
\underline{d} &amp;
\begin{array}{|c}
\hline e
\end{array} &amp; 
\begin{array}{c|}
\hline f
\end{array}
\\ \underline{g} &amp;
\begin{array}{|c}
h\\ \hline 
\end{array} &amp; 
\begin{array}{c|}
i\\
\hline
\end{array}\end{array}\right|\]</span></p>
<p><span class="math inline">\(a\)</span> is bold in the matrix above, if we ignore all elements (underlined text) sitting on the same row (<span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>) and same column (<span class="math inline">\(d\)</span> and <span class="math inline">\(g\)</span>) as <span class="math inline">\(a\)</span>, the rest of the elements give us a square. We just calculate the determinant of this square and call it <span class="math inline">\(a_t\)</span>. We put <span class="math inline">\(a_t\)</span> in an empty matrix in the exact location of <span class="math inline">\(a\)</span>, <span class="math inline">\(\begin{vmatrix} a_t &amp; &amp; \\ &amp; &amp; \\ &amp; &amp; \end{vmatrix}\)</span> We now move to the second element in our matrix (<span class="math inline">\(b\)</span>).</p>
<p><span class="math display">\[\left|\begin{array}{ccc}
\underline{a} &amp; \textbf{b} &amp; \underline{c}\\ 
\begin{array}{|c}
 \hline d
 \end{array} &amp;
\underline{e}
 &amp; 
\begin{array}{c|}
\hline f
\end{array} 
\\
\begin{array}{|c}
g \\ \hline 
 \end{array}  &amp;
\begin{array}{c}
\underline{h}\\ 
\end{array} &amp; 
\begin{array}{c|}
i\\
\hline
\end{array}\end{array}\right|\]</span></p>
<p>In this case, if we ignore all the underlined elements, we will end up with another square <span class="math inline">\(\begin{vmatrix} d &amp; f \\ g &amp; i \end{vmatrix}\)</span>, we calculate its determinant call it <span class="math inline">\(b_t\)</span>. We put it in the matrix:
<span class="math inline">\(\begin{vmatrix} a_t &amp; b_t &amp; \\ &amp; &amp; \\ &amp; &amp; \end{vmatrix}\)</span>
If we do the same procedure for all the elements of the matrix, we end up with</p>
<p><span class="math display">\[M=\begin{vmatrix} a_t &amp; b_t &amp;c_t \\ d_t &amp; e_t &amp; f_t\\g_t &amp; h_t &amp;i_t \end{vmatrix}\]</span></p>
<p>This is our matrix of minor.</p>
<p><strong>Step 2</strong></p>
<p>We can now calculate our matrix of cofactors easily. We start from the first element of <span class="math inline">\(M\)</span> and multiply with <span class="math inline">\(+1\)</span></p>
<p><span class="math display">\[M_1=\begin{vmatrix} a_t \times +1 &amp; b_t &amp;c_t \\ d_t &amp; e_t &amp; f_t\\g_t &amp; h_t &amp;i_t \end{vmatrix}\]</span>
We now take the second element and multiply by -1!</p>
<p><span class="math display">\[M_1=\begin{vmatrix} a_t \times +1 &amp; b_t \times -1 &amp;c_t \\ d_t &amp; e_t &amp; f_t\\g_t &amp; h_t &amp;i_t \end{vmatrix}\]</span>
Now for the third one +1!
<span class="math display">\[M_1=\begin{vmatrix} a_t \times +1 &amp; b_t \times -1 &amp;c_t \times +1 \\ d_t &amp; e_t &amp; f_t\\g_t &amp; h_t &amp;i_t \end{vmatrix}\]</span>
We just keep doing this for all the elements and every time change the sign of <span class="math inline">\(1\)</span> to <span class="math inline">\(+\)</span> or <span class="math inline">\(-\)</span>.</p>
<p><span class="math display">\[C=\begin{vmatrix} a_t \times +1 &amp; b_t \times -1 &amp;c_t \times +1 \\ d_t \times -1 &amp; e_t \times +1 &amp; f_t \times -1\\g_t \times +1 &amp; h_t \times -1 &amp;i_t\times +1 \end{vmatrix}\]</span>
We now transpose <span class="math inline">\(C\)</span>.</p>

<div class="definition">
<p><span id="def:transpose" class="definition"><strong>Definition 6.12  (Transpose of a matrix)  </strong></span>Transpose of a matrix is simply an operation and swap the position of rows and columns of the matrix, so the first column of the matrix is now the first row and so forth. Transpose of matrix <span class="math inline">\(X\)</span> is shown by <span class="math inline">\(X^T\)</span>. For example,</p>
<p><span class="math inline">\(X=\begin{vmatrix} a &amp; b &amp;c \\ d &amp; e &amp; f\\g &amp; h &amp;i \end{vmatrix}\)</span>
So</p>
<span class="math inline">\(X^{T}=\begin{vmatrix} a &amp; d &amp;g \\ b &amp; e &amp; h\\c &amp; f &amp;i \end{vmatrix}\)</span>
</div>

<p>At this stage, the big formula we had up there can be written as
<span class="math display">\[A^{-1}=\frac{1}{|A|}C^T\]</span>
Where <span class="math inline">\(C^T\)</span> is the transpose of the <span class="math inline">\(C\)</span> matrix we calculate up there and <span class="math inline">\(|A|\)</span> is determinant of <span class="math inline">\(A\)</span> that we know how to calculate (<a href="pcamath.html#def:det">6.10</a>).</p>
<p>For example,</p>
<p><span class="math display">\[A=\begin{vmatrix}
1 &amp; 4 &amp; 3\\
1 &amp; 5 &amp; 1\\
3 &amp; 2 &amp; 1\\
\end{vmatrix}\]</span></p>
<p>We find <span class="math inline">\(a_t=5 \times 1 - 1 \times 2=3\)</span>, <span class="math inline">\(b_t=1 \times 1 - 1 \times 3=-2\)</span>, … , <span class="math inline">\(i_t=1 \times 5 - 4 \times 1=1\)</span></p>
<p>We put them to a matrix</p>
<p><span class="math display">\[C=
\begin{vmatrix}
3 &amp; -2 &amp; -13\\
-2 &amp; -8 &amp; -10\\
-11 &amp; -2 &amp; 1\\
\end{vmatrix}\]</span></p>
<p>Now we multiply this by <span class="math inline">\(+\)</span> and <span class="math inline">\(-\)</span> (this is elementwise multiplication: each element on the left-hand matrix will be multiplied by its corresponding one right hand):</p>
<p><span class="math display">\[C=\begin{vmatrix}
3 &amp; -2 &amp; -13\\
-2 &amp; -8 &amp; -10\\
-11 &amp; -2 &amp; 1\\
\end{vmatrix} \times \begin{vmatrix}
1 &amp; -1 &amp; 1\\
-1 &amp; 1 &amp; -1\\
1 &amp; -1 &amp; 1\\
\end{vmatrix}=\begin{vmatrix}
3 &amp; 2 &amp; -13\\
2 &amp; -8 &amp; 10\\
-11 &amp; 2 &amp; 1\\
\end{vmatrix}\]</span></p>
<p>we can now calculate the transpose of <span class="math inline">\(C\)</span>:</p>
<p><span class="math display">\[C^T=\begin{vmatrix}
3 &amp; 2 &amp; -13\\
2 &amp; -8 &amp; 10\\
-11 &amp; 2 &amp; 1\\
\end{vmatrix}^{T}=\begin{vmatrix}
3 &amp; 2 &amp; -11\\
2 &amp; -8 &amp; 2\\
-13 &amp; 10 &amp; 1\\
\end{vmatrix}\]</span></p>
<p>So</p>
<p><span class="math display">\[A^{-1}=\frac{1}{|A|}C^T=  \frac{1}{-28} \begin{vmatrix}
3 &amp; 2 &amp; -11\\
2 &amp; -8 &amp; 2\\
-13 &amp; 10 &amp; 1\\
\end{vmatrix}=\begin{vmatrix}
-0.1071429 &amp; -0.0714286 &amp; 0.3928571\\
-0.0714286 &amp; 0.2857143 &amp; -0.0714286\\
0.4642857 &amp; -0.3571429 &amp; -0.0357143\\
\end{vmatrix}
\]</span></p>
<p>In practice you will use a function in R to do that:</p>
<pre><code>solve(A)</code></pre>
<p>Easy right?! Let’s move forward.</p>
</div>
<div id="rank-of-a-matrix" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Rank of a matrix</h3>
<p>Remember we talked about the basis vectors (<a href="pcamath.html#def:bvectors">6.8</a>)? We said that the basis vectors are vectors that define our space and they must be linearly independent. The linear independence means that, if we select one of the basis vectors, this vector cannot be constructed by linearly combining the other vectors. For example we consider our standard basis vectors in 3d dimensions <span class="math inline">\(\vec{x}=[1,0,0]\)</span>, <span class="math inline">\(\vec{y}=[0,1,0]\)</span>, and <span class="math inline">\(\vec{z}=[0,0,1]\)</span>, Can we come us with a formula to combine <span class="math inline">\(\vec{x}\)</span> and <span class="math inline">\(\vec{y}\)</span> to be equal to <span class="math inline">\(\vec{z}\)</span>? We said that we can use addition, multiplication, subtraction, etc. For example, can we find a scalar <span class="math inline">\(c\)</span> such that <span class="math inline">\(\vec{z}=c \times \vec{x} + c \times \vec{y}\)</span>? The answer is no if the vectors are linearly independent. By definition, the standard basis vectors are linearly independent. But here comes a problem! We said a matrix will change our space including the position of our standard basis vectors. So are these new locations (vectors) linearly independent? Or similarly, can the new vectors be called basis vectors? Let’s have a look at an example:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="pcamath.html#cb102-1"></a><span class="co"># fix the plot number</span></span>
<span id="cb102-2"><a href="pcamath.html#cb102-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb102-3"><a href="pcamath.html#cb102-3"></a></span>
<span id="cb102-4"><a href="pcamath.html#cb102-4"></a><span class="co"># create basis vector</span></span>
<span id="cb102-5"><a href="pcamath.html#cb102-5"></a>basis_vectors&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">byrow =</span> T,<span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb102-6"><a href="pcamath.html#cb102-6"></a></span>
<span id="cb102-7"><a href="pcamath.html#cb102-7"></a><span class="co"># create transformation matrix</span></span>
<span id="cb102-8"><a href="pcamath.html#cb102-8"></a>b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>),<span class="dt">nrow =</span> <span class="dv">2</span>,<span class="dt">byrow =</span> T)</span>
<span id="cb102-9"><a href="pcamath.html#cb102-9"></a></span>
<span id="cb102-10"><a href="pcamath.html#cb102-10"></a><span class="co"># create the transformed vectors</span></span>
<span id="cb102-11"><a href="pcamath.html#cb102-11"></a>trasformed_spcae&lt;-b<span class="op">%*%</span>basis_vectors</span>
<span id="cb102-12"><a href="pcamath.html#cb102-12"></a></span>
<span id="cb102-13"><a href="pcamath.html#cb102-13"></a><span class="co"># empty plot</span></span>
<span id="cb102-14"><a href="pcamath.html#cb102-14"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">11</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">11</span>),<span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb102-15"><a href="pcamath.html#cb102-15"></a></span>
<span id="cb102-16"><a href="pcamath.html#cb102-16"></a></span>
<span id="cb102-17"><a href="pcamath.html#cb102-17"></a><span class="co">## base arrows</span></span>
<span id="cb102-18"><a href="pcamath.html#cb102-18"></a><span class="co"># arrows</span></span>
<span id="cb102-19"><a href="pcamath.html#cb102-19"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb102-20"><a href="pcamath.html#cb102-20"></a><span class="co"># arrows</span></span>
<span id="cb102-21"><a href="pcamath.html#cb102-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb102-22"><a href="pcamath.html#cb102-22"></a></span>
<span id="cb102-23"><a href="pcamath.html#cb102-23"></a></span>
<span id="cb102-24"><a href="pcamath.html#cb102-24"></a><span class="co"># trasformed arrows</span></span>
<span id="cb102-25"><a href="pcamath.html#cb102-25"></a><span class="co"># arrows</span></span>
<span id="cb102-26"><a href="pcamath.html#cb102-26"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,trasformed_spcae[<span class="dv">1</span>,<span class="dv">1</span>],trasformed_spcae[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb102-27"><a href="pcamath.html#cb102-27"></a><span class="co"># arrows</span></span>
<span id="cb102-28"><a href="pcamath.html#cb102-28"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,trasformed_spcae[<span class="dv">1</span>,<span class="dv">2</span>],trasformed_spcae[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bvectors1"></span>
<img src="PCA_files/figure-html/bvectors1-1.png" alt="The transformed basis vectors" width="672" />
<p class="caption">
Figure 6.33: The transformed basis vectors
</p>
</div>
<p>We see if Figure <a href="pcamath.html#fig:bvectors1">6.33</a> that using <span class="math inline">\(\begin{vmatrix} 1&amp;2\\3&amp;6 \end{vmatrix}\)</span> matrix we transformed our basis vectors from <span class="math inline">\(\vec{x}=[1,0] \ and \ \vec{y}=[0,1]\)</span> (solid lines) to <span class="math inline">\(\vec{x}=[1,3] \ and \ \vec{y}=[2,6]\)</span>. Are these new vectors basis vectors? We can see that <span class="math inline">\(\vec{y}\)</span> is basically <span class="math inline">\(2 \times \vec{x}\)</span>, so no they are not basis vectors. In fact, they might be thought of as redundant. Thinking about addressing in space, we can go to exact locations that we can go with <span class="math inline">\(\vec{y}\)</span> using <span class="math inline">\(\vec{x}\)</span>. So all of these means that we have only one basis vector in the new space! This is related to the <strong>rank of a matrix</strong>.</p>

<div class="definition">
<span id="def:matrixr" class="definition"><strong>Definition 6.13  (Rank of a matrix)  </strong></span>The rank of a matrix <span class="math inline">\(A\)</span> is defined by the maximum number of linearly independent vectors generated by the transformation via <span class="math inline">\(A\)</span>. We show the rank of matrix <span class="math inline">\(A\)</span> by <span class="math inline">\(Rank(A)\)</span> As we saw, the concept is very related to the basis of the space generated by that matrix. However, the rank of a matrix is independent of the choice of the basis. If the rank of a matrix is equal to the number of variables (or the number of samples), we say the matrix is full rank. That means all the vectors are linearly independent. Otherwise, we call the matrix rank deficient. The matrix with no zero determinant is always full rank!
</div>

<p>There many methods for calculating the rank of a matrix. The simplest one is called row reduction or even fancier Gaussian elimination! Without going into much detail about this beast, this is a process by which would like to transform our matrix into a form where everything becomes zero! Well, that sounds easy! We can just multiply a matrix by zero! Nope! We are given three tools:</p>
<ul>
<li>1: We can only multiply a row by a non zero scalar</li>
<li>2: We can swap the position of two rows</li>
<li>3: We can add or subtract two rows from each other</li>
</ul>
<p>We can use any number of steps above in order to reach our goal. We at some stage, it was not possible to go forward, we just stop. We count the number of non-zero rows, that is the rank of the matrix! Let’s start with</p>
<p><span class="math inline">\(A=\begin{vmatrix} 1&amp;2&amp;3\\4&amp;5&amp;12\\3&amp;1&amp;9\end{vmatrix}\)</span></p>
<p>Let’s for the start, add “4” to the first row</p>
<p><span class="math display">\[\begin{vmatrix} 4&amp;8&amp;12\\4&amp;5&amp;12\\3&amp;1&amp;9\end{vmatrix}\]</span>
Why did we add 4? Because we looked at the first and third entities of the second row and saw it’s like that first row multiply by 4! Doing that will give us the chance of subtracting the first row from the second one making some elements zero! Let’s do it.</p>
<p><span class="math display">\[\begin{vmatrix} 4&amp;8&amp;12\\0&amp;-3&amp;0\\3&amp;1&amp;9\end{vmatrix}\]</span></p>
<p>Awww! We are getting close. Now let’s do the same thing for the third row!</p>
<p>Now multiply the first row by <span class="math inline">\(\frac{3}{4}\)</span></p>
<p><span class="math display">\[\begin{vmatrix} 3&amp;6&amp;9\\0&amp;-3&amp;0\\3&amp;1&amp;9\end{vmatrix}\]</span></p>
<p>Then subtract from the third row.</p>
<p><span class="math display">\[\begin{vmatrix} 3&amp;6&amp;9\\0&amp;-3&amp;0\\0&amp;-5&amp;0\end{vmatrix}\]</span></p>
<p>A little bit more! We multiply the second row with <span class="math inline">\(\frac{5}{3}\)</span></p>
<p><span class="math display">\[\begin{vmatrix} 3&amp;6&amp;9\\0&amp;-5&amp;0\\0&amp;-5&amp;0\end{vmatrix}\]</span>
You see, now we can get rid of the third row by subtracting the second row from the third one!</p>
<p><span class="math display">\[\begin{vmatrix} 3&amp;6&amp;9\\0&amp;-5&amp;0\\0&amp;0&amp;0\end{vmatrix}\]</span>
At this point, no matter how much we try, we won’t be able to change make the first and the second row zero. What is the rank of the matrix? It’s the number of non zero rows. That is 2!</p>
<p>In practice, you can calculate that using a function in R (like this one in Matrix package):</p>
<pre><code>Matrix::rankMatrix()</code></pre>
<p>We are now ready to know a bit more about the matrices. Let’s move forward to one of the most amazing topics linear algebra.</p>
</div>
<div id="eigenvector-eigenvalues" class="section level3">
<h3><span class="header-section-number">6.4.6</span> Eigenvector &amp; eigenvalues</h3>
<p>Remember, we said if we multiply a matrix <span class="math inline">\(A\)</span> by <span class="math inline">\(B\)</span> (<span class="math inline">\(A\  B\)</span>), it will transform the space of <span class="math inline">\(B\)</span> including all the vectors inside B?</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="pcamath.html#cb104-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb104-2"><a href="pcamath.html#cb104-2"></a></span>
<span id="cb104-3"><a href="pcamath.html#cb104-3"></a></span>
<span id="cb104-4"><a href="pcamath.html#cb104-4"></a><span class="co"># data</span></span>
<span id="cb104-5"><a href="pcamath.html#cb104-5"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb104-6"><a href="pcamath.html#cb104-6"></a></span>
<span id="cb104-7"><a href="pcamath.html#cb104-7"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb104-8"><a href="pcamath.html#cb104-8"></a><span class="co"># plot</span></span>
<span id="cb104-9"><a href="pcamath.html#cb104-9"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb104-10"><a href="pcamath.html#cb104-10"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb104-11"><a href="pcamath.html#cb104-11"></a></span>
<span id="cb104-12"><a href="pcamath.html#cb104-12"></a><span class="co"># lines</span></span>
<span id="cb104-13"><a href="pcamath.html#cb104-13"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb104-14"><a href="pcamath.html#cb104-14"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb104-15"><a href="pcamath.html#cb104-15"></a></span>
<span id="cb104-16"><a href="pcamath.html#cb104-16"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb104-17"><a href="pcamath.html#cb104-17"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb104-18"><a href="pcamath.html#cb104-18"></a></span>
<span id="cb104-19"><a href="pcamath.html#cb104-19"></a></span>
<span id="cb104-20"><a href="pcamath.html#cb104-20"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb104-21"><a href="pcamath.html#cb104-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb104-22"><a href="pcamath.html#cb104-22"></a><span class="kw">title</span>(<span class="st">&quot;Original space&quot;</span>)</span>
<span id="cb104-23"><a href="pcamath.html#cb104-23"></a></span>
<span id="cb104-24"><a href="pcamath.html#cb104-24"></a><span class="co"># another data</span></span>
<span id="cb104-25"><a href="pcamath.html#cb104-25"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb104-26"><a href="pcamath.html#cb104-26"></a></span>
<span id="cb104-27"><a href="pcamath.html#cb104-27"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb104-28"><a href="pcamath.html#cb104-28"></a><span class="co"># plot</span></span>
<span id="cb104-29"><a href="pcamath.html#cb104-29"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb104-30"><a href="pcamath.html#cb104-30"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb104-31"><a href="pcamath.html#cb104-31"></a></span>
<span id="cb104-32"><a href="pcamath.html#cb104-32"></a><span class="co"># transformation matrix</span></span>
<span id="cb104-33"><a href="pcamath.html#cb104-33"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb104-34"><a href="pcamath.html#cb104-34"></a><span class="co"># multiplication</span></span>
<span id="cb104-35"><a href="pcamath.html#cb104-35"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb104-36"><a href="pcamath.html#cb104-36"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb104-37"><a href="pcamath.html#cb104-37"></a></span>
<span id="cb104-38"><a href="pcamath.html#cb104-38"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb104-39"><a href="pcamath.html#cb104-39"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb104-40"><a href="pcamath.html#cb104-40"></a><span class="co"># lines</span></span>
<span id="cb104-41"><a href="pcamath.html#cb104-41"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb104-42"><a href="pcamath.html#cb104-42"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb104-43"><a href="pcamath.html#cb104-43"></a></span>
<span id="cb104-44"><a href="pcamath.html#cb104-44"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb104-45"><a href="pcamath.html#cb104-45"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb104-46"><a href="pcamath.html#cb104-46"></a><span class="co"># arrows</span></span>
<span id="cb104-47"><a href="pcamath.html#cb104-47"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb104-48"><a href="pcamath.html#cb104-48"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb104-49"><a href="pcamath.html#cb104-49"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen1"></span>
<img src="PCA_files/figure-html/eigen1-1.png" alt="Multiply a matrix to space, including the basis vectors" width="672" />
<p class="caption">
Figure 6.34: Multiply a matrix to space, including the basis vectors
</p>
</div>
<p>Well, yes that’s true but not completely true! Sometimes there exist some vectors that the matrix transformation cannot move that much! In fact, it can move them by just stretching them. It cannot move the span of those vectors.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="pcamath.html#cb105-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb105-2"><a href="pcamath.html#cb105-2"></a></span>
<span id="cb105-3"><a href="pcamath.html#cb105-3"></a></span>
<span id="cb105-4"><a href="pcamath.html#cb105-4"></a><span class="co"># data</span></span>
<span id="cb105-5"><a href="pcamath.html#cb105-5"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb105-6"><a href="pcamath.html#cb105-6"></a></span>
<span id="cb105-7"><a href="pcamath.html#cb105-7"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb105-8"><a href="pcamath.html#cb105-8"></a><span class="co"># plot</span></span>
<span id="cb105-9"><a href="pcamath.html#cb105-9"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb105-10"><a href="pcamath.html#cb105-10"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb105-11"><a href="pcamath.html#cb105-11"></a></span>
<span id="cb105-12"><a href="pcamath.html#cb105-12"></a><span class="co"># lines</span></span>
<span id="cb105-13"><a href="pcamath.html#cb105-13"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb105-14"><a href="pcamath.html#cb105-14"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb105-15"><a href="pcamath.html#cb105-15"></a></span>
<span id="cb105-16"><a href="pcamath.html#cb105-16"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb105-17"><a href="pcamath.html#cb105-17"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb105-18"><a href="pcamath.html#cb105-18"></a></span>
<span id="cb105-19"><a href="pcamath.html#cb105-19"></a></span>
<span id="cb105-20"><a href="pcamath.html#cb105-20"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb105-21"><a href="pcamath.html#cb105-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb105-22"><a href="pcamath.html#cb105-22"></a></span>
<span id="cb105-23"><a href="pcamath.html#cb105-23"></a></span>
<span id="cb105-24"><a href="pcamath.html#cb105-24"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb105-25"><a href="pcamath.html#cb105-25"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">10</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb105-26"><a href="pcamath.html#cb105-26"></a></span>
<span id="cb105-27"><a href="pcamath.html#cb105-27"></a><span class="kw">title</span>(<span class="st">&quot;Original space&quot;</span>)</span>
<span id="cb105-28"><a href="pcamath.html#cb105-28"></a></span>
<span id="cb105-29"><a href="pcamath.html#cb105-29"></a><span class="co"># send data</span></span>
<span id="cb105-30"><a href="pcamath.html#cb105-30"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb105-31"><a href="pcamath.html#cb105-31"></a></span>
<span id="cb105-32"><a href="pcamath.html#cb105-32"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb105-33"><a href="pcamath.html#cb105-33"></a></span>
<span id="cb105-34"><a href="pcamath.html#cb105-34"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb105-35"><a href="pcamath.html#cb105-35"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb105-36"><a href="pcamath.html#cb105-36"></a></span>
<span id="cb105-37"><a href="pcamath.html#cb105-37"></a><span class="co"># matrix transformation</span></span>
<span id="cb105-38"><a href="pcamath.html#cb105-38"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb105-39"><a href="pcamath.html#cb105-39"></a></span>
<span id="cb105-40"><a href="pcamath.html#cb105-40"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb105-41"><a href="pcamath.html#cb105-41"></a></span>
<span id="cb105-42"><a href="pcamath.html#cb105-42"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb105-43"><a href="pcamath.html#cb105-43"></a><span class="co"># do the transform</span></span>
<span id="cb105-44"><a href="pcamath.html#cb105-44"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb105-45"><a href="pcamath.html#cb105-45"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb105-46"><a href="pcamath.html#cb105-46"></a></span>
<span id="cb105-47"><a href="pcamath.html#cb105-47"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb105-48"><a href="pcamath.html#cb105-48"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb105-49"><a href="pcamath.html#cb105-49"></a><span class="co"># lines and arrows</span></span>
<span id="cb105-50"><a href="pcamath.html#cb105-50"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb105-51"><a href="pcamath.html#cb105-51"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb105-52"><a href="pcamath.html#cb105-52"></a></span>
<span id="cb105-53"><a href="pcamath.html#cb105-53"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb105-54"><a href="pcamath.html#cb105-54"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb105-55"><a href="pcamath.html#cb105-55"></a></span>
<span id="cb105-56"><a href="pcamath.html#cb105-56"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb105-57"><a href="pcamath.html#cb105-57"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb105-58"><a href="pcamath.html#cb105-58"></a></span>
<span id="cb105-59"><a href="pcamath.html#cb105-59"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,(b<span class="op">%*%</span><span class="kw">eigen</span>(b)<span class="op">$</span>vectors)[<span class="dv">1</span>,<span class="dv">1</span>],(b<span class="op">%*%</span><span class="kw">eigen</span>(b)<span class="op">$</span>vectors)[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb105-60"><a href="pcamath.html#cb105-60"></a><span class="kw">segments</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">10</span>,(b<span class="op">%*%</span><span class="kw">eigen</span>(b)<span class="op">$</span>vectors)[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,(b<span class="op">%*%</span><span class="kw">eigen</span>(b)<span class="op">$</span>vectors)[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb105-61"><a href="pcamath.html#cb105-61"></a></span>
<span id="cb105-62"><a href="pcamath.html#cb105-62"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen2"></span>
<img src="PCA_files/figure-html/eigen2-1.png" alt="Multiply a matrix to space, including the basis vectors and span of eigen vectors" width="672" />
<p class="caption">
Figure 6.35: Multiply a matrix to space, including the basis vectors and span of eigen vectors
</p>
</div>
<p>What we see in Figure <a href="pcamath.html#fig:eigen2">6.35</a> is that the purple vector stays on its span (the black line) but the blue vector has been knocked off its span. These vectors that stay on their span might be stretched or flipped but they will hold on to the span. Can you find another vector that stays on its span? Yes exactly. That is the red one! It is the same vector, the same size, and the same direction. These guys are called eigenvectors. Pretty awesome, right!? But we said although the vector stays on its span can be stretched. How much? The value that this specific vector is stretched by is called an eigenvalue. I agree! That is difficult to imagine! Let’s look at our cat!</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="pcamath.html#cb106-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb106-2"><a href="pcamath.html#cb106-2"></a><span class="co"># read data</span></span>
<span id="cb106-3"><a href="pcamath.html#cb106-3"></a>cat_data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;data/cat.tsv&quot;</span>)[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb106-4"><a href="pcamath.html#cb106-4"></a><span class="co"># center</span></span>
<span id="cb106-5"><a href="pcamath.html#cb106-5"></a>cat_data&lt;-<span class="kw">scale</span>(cat_data,<span class="dt">center =</span> T)</span>
<span id="cb106-6"><a href="pcamath.html#cb106-6"></a><span class="co"># plot</span></span>
<span id="cb106-7"><a href="pcamath.html#cb106-7"></a><span class="kw">plot</span>(cat_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb106-8"><a href="pcamath.html#cb106-8"></a><span class="kw">title</span>(<span class="st">&quot;Original cat image&quot;</span>)</span>
<span id="cb106-9"><a href="pcamath.html#cb106-9"></a></span>
<span id="cb106-10"><a href="pcamath.html#cb106-10"></a></span>
<span id="cb106-11"><a href="pcamath.html#cb106-11"></a><span class="co"># transoform</span></span>
<span id="cb106-12"><a href="pcamath.html#cb106-12"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb106-13"><a href="pcamath.html#cb106-13"></a></span>
<span id="cb106-14"><a href="pcamath.html#cb106-14"></a><span class="co"># plot eigens</span></span>
<span id="cb106-15"><a href="pcamath.html#cb106-15"></a><span class="kw">arrows</span>(<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">100</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb106-16"><a href="pcamath.html#cb106-16"></a></span>
<span id="cb106-17"><a href="pcamath.html#cb106-17"></a><span class="kw">arrows</span>(<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">100</span>,<span class="kw">eigen</span>(b)<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">100</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb106-18"><a href="pcamath.html#cb106-18"></a></span>
<span id="cb106-19"><a href="pcamath.html#cb106-19"></a></span>
<span id="cb106-20"><a href="pcamath.html#cb106-20"></a></span>
<span id="cb106-21"><a href="pcamath.html#cb106-21"></a><span class="co"># plot selected points</span></span>
<span id="cb106-22"><a href="pcamath.html#cb106-22"></a>eigenB&lt;-<span class="kw">eigen</span>(b)</span>
<span id="cb106-23"><a href="pcamath.html#cb106-23"></a>eigendif&lt;-<span class="kw">apply</span>(cat_data,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="kw">data.frame</span>(<span class="dt">x=</span>x[<span class="dv">1</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">y=</span>x[<span class="dv">2</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>])})</span>
<span id="cb106-24"><a href="pcamath.html#cb106-24"></a></span>
<span id="cb106-25"><a href="pcamath.html#cb106-25"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="kw">which</span>(<span class="kw">abs</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(eigendif,<span class="cf">function</span>(x){x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]})))<span class="op">&lt;</span><span class="fl">0.2</span>))</span>
<span id="cb106-26"><a href="pcamath.html#cb106-26"></a>{</span>
<span id="cb106-27"><a href="pcamath.html#cb106-27"></a>  <span class="kw">points</span>(cat_data[x][<span class="dv">1</span>],cat_data[x,][<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb106-28"><a href="pcamath.html#cb106-28"></a>}</span>
<span id="cb106-29"><a href="pcamath.html#cb106-29"></a></span>
<span id="cb106-30"><a href="pcamath.html#cb106-30"></a></span>
<span id="cb106-31"><a href="pcamath.html#cb106-31"></a><span class="co"># transformation</span></span>
<span id="cb106-32"><a href="pcamath.html#cb106-32"></a>eigendif&lt;-<span class="kw">apply</span>(cat_data,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="kw">data.frame</span>(<span class="dt">x=</span>x[<span class="dv">1</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">y=</span>x[<span class="dv">2</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>])})</span>
<span id="cb106-33"><a href="pcamath.html#cb106-33"></a></span>
<span id="cb106-34"><a href="pcamath.html#cb106-34"></a><span class="co"># plot</span></span>
<span id="cb106-35"><a href="pcamath.html#cb106-35"></a>selectedPoints2&lt;-<span class="kw">which</span>(<span class="kw">abs</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(eigendif,<span class="cf">function</span>(x){x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]})))<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb106-36"><a href="pcamath.html#cb106-36"></a><span class="cf">for</span>(x <span class="cf">in</span> selectedPoints2)</span>
<span id="cb106-37"><a href="pcamath.html#cb106-37"></a>{</span>
<span id="cb106-38"><a href="pcamath.html#cb106-38"></a>  <span class="kw">points</span>(cat_data[x][<span class="dv">1</span>],cat_data[x,][<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb106-39"><a href="pcamath.html#cb106-39"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen3"></span>
<img src="PCA_files/figure-html/eigen3-1.png" alt="Eigenvector and values of a cat!" width="672" />
<p class="caption">
Figure 6.36: Eigenvector and values of a cat!
</p>
</div>
<p>In this Figure, we plotted the eigenvectors of the cat! The blue one is the eigenvector with the largest span of eigenvalue whereas the red line is the span of the eigenvector with the smallest eigenvalue.
There are some green points also on the plot. These are the points that are colored green and purple. The green points are on (or very close) to the first eigenvector. The purple ones are on the second eigenvector.</p>
<p>Let’s now look at what happens when we transform the space using our amazing matrix:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="pcamath.html#cb107-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-2"><a href="pcamath.html#cb107-2"></a><span class="co"># data</span></span>
<span id="cb107-3"><a href="pcamath.html#cb107-3"></a>cat_data&lt;-<span class="kw">read.table</span>(<span class="st">&quot;data/cat.tsv&quot;</span>)[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb107-4"><a href="pcamath.html#cb107-4"></a></span>
<span id="cb107-5"><a href="pcamath.html#cb107-5"></a>cat_data&lt;-<span class="kw">scale</span>(cat_data,<span class="dt">center =</span> T)</span>
<span id="cb107-6"><a href="pcamath.html#cb107-6"></a></span>
<span id="cb107-7"><a href="pcamath.html#cb107-7"></a><span class="co"># make transform matrix</span></span>
<span id="cb107-8"><a href="pcamath.html#cb107-8"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb107-9"><a href="pcamath.html#cb107-9"></a><span class="co"># do transformation</span></span>
<span id="cb107-10"><a href="pcamath.html#cb107-10"></a>cat_data&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(cat_data))</span>
<span id="cb107-11"><a href="pcamath.html#cb107-11"></a>cat_data&lt;-<span class="kw">scale</span>(cat_data,<span class="dt">center =</span> T)</span>
<span id="cb107-12"><a href="pcamath.html#cb107-12"></a></span>
<span id="cb107-13"><a href="pcamath.html#cb107-13"></a><span class="co"># Plot</span></span>
<span id="cb107-14"><a href="pcamath.html#cb107-14"></a><span class="kw">plot</span>(cat_data,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb107-15"><a href="pcamath.html#cb107-15"></a><span class="kw">title</span>(<span class="st">&quot;Transformed cat image&quot;</span>)</span>
<span id="cb107-16"><a href="pcamath.html#cb107-16"></a></span>
<span id="cb107-17"><a href="pcamath.html#cb107-17"></a></span>
<span id="cb107-18"><a href="pcamath.html#cb107-18"></a><span class="co"># map eigens</span></span>
<span id="cb107-19"><a href="pcamath.html#cb107-19"></a>eigenVectors&lt;-<span class="kw">eigen</span>(b)<span class="op">$</span>vectors</span>
<span id="cb107-20"><a href="pcamath.html#cb107-20"></a></span>
<span id="cb107-21"><a href="pcamath.html#cb107-21"></a>eigenVectors&lt;-b<span class="op">%*%</span>eigenVectors</span>
<span id="cb107-22"><a href="pcamath.html#cb107-22"></a></span>
<span id="cb107-23"><a href="pcamath.html#cb107-23"></a></span>
<span id="cb107-24"><a href="pcamath.html#cb107-24"></a><span class="kw">arrows</span>(eigenVectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>,eigenVectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">100</span>,eigenVectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">100</span>,eigenVectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">100</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb107-25"><a href="pcamath.html#cb107-25"></a></span>
<span id="cb107-26"><a href="pcamath.html#cb107-26"></a><span class="kw">arrows</span>(eigenVectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">100</span>,eigenVectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">100</span>,eigenVectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">100</span>,eigenVectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">100</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb107-27"><a href="pcamath.html#cb107-27"></a></span>
<span id="cb107-28"><a href="pcamath.html#cb107-28"></a></span>
<span id="cb107-29"><a href="pcamath.html#cb107-29"></a></span>
<span id="cb107-30"><a href="pcamath.html#cb107-30"></a><span class="co"># plot saved points</span></span>
<span id="cb107-31"><a href="pcamath.html#cb107-31"></a>eigenB&lt;-<span class="kw">eigen</span>(b)</span>
<span id="cb107-32"><a href="pcamath.html#cb107-32"></a>eigendif&lt;-<span class="kw">apply</span>(cat_data,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="kw">data.frame</span>(<span class="dt">x=</span>x[<span class="dv">1</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">y=</span>x[<span class="dv">2</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>])})</span>
<span id="cb107-33"><a href="pcamath.html#cb107-33"></a></span>
<span id="cb107-34"><a href="pcamath.html#cb107-34"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="kw">which</span>(<span class="kw">abs</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(eigendif,<span class="cf">function</span>(x){x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]})))<span class="op">&lt;</span><span class="fl">0.2</span>))<span class="co">#which(abs(tmp[,1]-tmp[,2])&lt;0.013))</span></span>
<span id="cb107-35"><a href="pcamath.html#cb107-35"></a>{</span>
<span id="cb107-36"><a href="pcamath.html#cb107-36"></a>  <span class="kw">points</span>(cat_data[x][<span class="dv">1</span>],cat_data[x,][<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb107-37"><a href="pcamath.html#cb107-37"></a>}</span>
<span id="cb107-38"><a href="pcamath.html#cb107-38"></a></span>
<span id="cb107-39"><a href="pcamath.html#cb107-39"></a><span class="co"># plot saved</span></span>
<span id="cb107-40"><a href="pcamath.html#cb107-40"></a>eigendif&lt;-<span class="kw">apply</span>(cat_data,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="kw">data.frame</span>(<span class="dt">x=</span>x[<span class="dv">1</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">y=</span>x[<span class="dv">2</span>]<span class="op">/</span>eigenB<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>])})</span>
<span id="cb107-41"><a href="pcamath.html#cb107-41"></a></span>
<span id="cb107-42"><a href="pcamath.html#cb107-42"></a>selectedPoints2&lt;-<span class="kw">which</span>(<span class="kw">abs</span>(<span class="kw">unlist</span>(<span class="kw">sapply</span>(eigendif,<span class="cf">function</span>(x){x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]})))<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb107-43"><a href="pcamath.html#cb107-43"></a><span class="cf">for</span>(x <span class="cf">in</span> selectedPoints2)<span class="co">#which(abs(tmp[,1]-tmp[,2])&lt;0.013))</span></span>
<span id="cb107-44"><a href="pcamath.html#cb107-44"></a>{</span>
<span id="cb107-45"><a href="pcamath.html#cb107-45"></a>  <span class="kw">points</span>(cat_data[x][<span class="dv">1</span>],cat_data[x,][<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb107-46"><a href="pcamath.html#cb107-46"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen4"></span>
<img src="PCA_files/figure-html/eigen4-1.png" alt="Eigenvector and values of transformed cat!" width="672" />
<p class="caption">
Figure 6.37: Eigenvector and values of transformed cat!
</p>
</div>
<p>Isn’t this beautiful? The colored points are still on the same lines! Every other point (black ones) have changed directions. Put it simply, the eigenvectors give us the direction which does not change direction after transforming the data. In other words, it gives us the axis around which our image has been transformed. That is the reason why the points on the eigenvectors will never go off their spans. Let’s take it step by step! First, consider the blue line. We took the blue line and then flipped the cat around the blue line. We then did some stretching. Next, we took the red line and did a bit of squeezing. So great. So we now know the axis of rotation. But how about squeezing and stretching? It seems like the distance between the head and the tip of the tails of the cat is a bit longer in Figure <a href="pcamath.html#fig:eigen4">6.37</a> compared to the original image (<a href="pcamath.html#fig:eigen3">6.36</a>). Also, the distance between the feet and the back of the cat seems to be squeezed. Can we say that we actually stretched the cat along the blue line so that the cat is more spread along the blue line? Yes of course. We also did squeezing along the red line so the cat is less spread along that line. The eigenvalues exactly say the same thing! Do you remember, the blue line is the first eigenvector that has the largest eigenvalue, meaning that it has more spread than the red line? The same applies to gene expression data. The eigenvalues can be thought of as the backbone of data or its structure (you will see soon). The eigenvalues are spread of the data on these lines. So now we have tools to find the spread of our space (e.g. variance) and also we know in which direction space has been changed. But there might still be a question that: why are these vectors are so important for us? Well, simply talking we can use these vectors to squish the whole space into a single line. But this line has a very specific meaning, that the direction of changes our data has done to space which in turn means the direction in which our data has the most variance. These directions can be used to define another space that can be thought of as a backbone of our data. Let’s look at an example.</p>
<p>Imagine we have a matrix of <span class="math display">\[A=\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix}\]</span>
You can consider this as a very small, gene expression data where we have two genes (columns) and two patients (rows)
We also want to define our space by basis vector <span class="math inline">\(\vec{y}=[0,1]\)</span> so <span class="math inline">\(\vec{x}=[0,0]\)</span> or we just ignore <span class="math inline">\(x\)</span> for now. What does this transformation look if we do <span class="math inline">\(A \  y\)</span>? Let’s have a look:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="pcamath.html#cb108-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb108-2"><a href="pcamath.html#cb108-2"></a></span>
<span id="cb108-3"><a href="pcamath.html#cb108-3"></a></span>
<span id="cb108-4"><a href="pcamath.html#cb108-4"></a><span class="co"># some data</span></span>
<span id="cb108-5"><a href="pcamath.html#cb108-5"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb108-6"><a href="pcamath.html#cb108-6"></a></span>
<span id="cb108-7"><a href="pcamath.html#cb108-7"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb108-8"><a href="pcamath.html#cb108-8"></a></span>
<span id="cb108-9"><a href="pcamath.html#cb108-9"></a><span class="co"># plot</span></span>
<span id="cb108-10"><a href="pcamath.html#cb108-10"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb108-11"><a href="pcamath.html#cb108-11"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb108-12"><a href="pcamath.html#cb108-12"></a></span>
<span id="cb108-13"><a href="pcamath.html#cb108-13"></a><span class="co"># lines</span></span>
<span id="cb108-14"><a href="pcamath.html#cb108-14"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb108-15"><a href="pcamath.html#cb108-15"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb108-16"><a href="pcamath.html#cb108-16"></a></span>
<span id="cb108-17"><a href="pcamath.html#cb108-17"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb108-18"><a href="pcamath.html#cb108-18"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb108-19"><a href="pcamath.html#cb108-19"></a></span>
<span id="cb108-20"><a href="pcamath.html#cb108-20"></a><span class="co"># arrows</span></span>
<span id="cb108-21"><a href="pcamath.html#cb108-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb108-22"><a href="pcamath.html#cb108-22"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb108-23"><a href="pcamath.html#cb108-23"></a></span>
<span id="cb108-24"><a href="pcamath.html#cb108-24"></a><span class="kw">title</span>(<span class="st">&quot;Original space&quot;</span>)</span>
<span id="cb108-25"><a href="pcamath.html#cb108-25"></a></span>
<span id="cb108-26"><a href="pcamath.html#cb108-26"></a><span class="co"># another set</span></span>
<span id="cb108-27"><a href="pcamath.html#cb108-27"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb108-28"><a href="pcamath.html#cb108-28"></a></span>
<span id="cb108-29"><a href="pcamath.html#cb108-29"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb108-30"><a href="pcamath.html#cb108-30"></a></span>
<span id="cb108-31"><a href="pcamath.html#cb108-31"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb108-32"><a href="pcamath.html#cb108-32"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> F,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb108-33"><a href="pcamath.html#cb108-33"></a></span>
<span id="cb108-34"><a href="pcamath.html#cb108-34"></a><span class="co"># transform matrix</span></span>
<span id="cb108-35"><a href="pcamath.html#cb108-35"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">7</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb108-36"><a href="pcamath.html#cb108-36"></a></span>
<span id="cb108-37"><a href="pcamath.html#cb108-37"></a>mydata&lt;-<span class="kw">cbind</span>(<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>))</span>
<span id="cb108-38"><a href="pcamath.html#cb108-38"></a></span>
<span id="cb108-39"><a href="pcamath.html#cb108-39"></a>mydata2&lt;-<span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>,<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">11</span>),<span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb108-40"><a href="pcamath.html#cb108-40"></a><span class="co"># do transformation</span></span>
<span id="cb108-41"><a href="pcamath.html#cb108-41"></a>mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb108-42"><a href="pcamath.html#cb108-42"></a>mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb108-43"><a href="pcamath.html#cb108-43"></a></span>
<span id="cb108-44"><a href="pcamath.html#cb108-44"></a>mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]))</span>
<span id="cb108-45"><a href="pcamath.html#cb108-45"></a>mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]&lt;-<span class="kw">t</span>(b<span class="op">%*%</span><span class="kw">t</span>(mydata2[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]))</span>
<span id="cb108-46"><a href="pcamath.html#cb108-46"></a></span>
<span id="cb108-47"><a href="pcamath.html#cb108-47"></a><span class="co"># plot lines</span></span>
<span id="cb108-48"><a href="pcamath.html#cb108-48"></a>nl&lt;-<span class="kw">apply</span>(mydata,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb108-49"><a href="pcamath.html#cb108-49"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb108-50"><a href="pcamath.html#cb108-50"></a></span>
<span id="cb108-51"><a href="pcamath.html#cb108-51"></a>nl&lt;-<span class="kw">apply</span>(mydata2,<span class="dt">MARGIN =</span> <span class="dv">1</span>,<span class="cf">function</span>(x){</span>
<span id="cb108-52"><a href="pcamath.html#cb108-52"></a>  <span class="kw">segments</span>(x[<span class="dv">1</span>],x[<span class="dv">2</span>],x[<span class="dv">3</span>],x[<span class="dv">4</span>],<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)})</span>
<span id="cb108-53"><a href="pcamath.html#cb108-53"></a></span>
<span id="cb108-54"><a href="pcamath.html#cb108-54"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,b[<span class="dv">1</span>,<span class="dv">1</span>],b[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb108-55"><a href="pcamath.html#cb108-55"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,b[<span class="dv">1</span>,<span class="dv">2</span>],b[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb108-56"><a href="pcamath.html#cb108-56"></a></span>
<span id="cb108-57"><a href="pcamath.html#cb108-57"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space&quot;</span>)</span>
<span id="cb108-58"><a href="pcamath.html#cb108-58"></a></span>
<span id="cb108-59"><a href="pcamath.html#cb108-59"></a></span>
<span id="cb108-60"><a href="pcamath.html#cb108-60"></a><span class="kw">plot</span>(<span class="kw">t</span>(b),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">8</span>),<span class="dt">axes =</span> T,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb108-61"><a href="pcamath.html#cb108-61"></a><span class="kw">text</span>(<span class="kw">t</span>(b),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sample 1&quot;</span>,<span class="st">&quot;sample 2&quot;</span>),<span class="dt">adj =</span> <span class="fl">1.2</span>)</span>
<span id="cb108-62"><a href="pcamath.html#cb108-62"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,b[<span class="dv">1</span>,<span class="dv">1</span>],b[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb108-63"><a href="pcamath.html#cb108-63"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,b[<span class="dv">1</span>,<span class="dv">2</span>],b[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb108-64"><a href="pcamath.html#cb108-64"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space without grid&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen5"></span>
<img src="PCA_files/figure-html/eigen5-1.png" alt="Smal gene expression matrix has been used to trasform a basic space" width="672" />
<p class="caption">
Figure 6.38: Smal gene expression matrix has been used to trasform a basic space
</p>
</div>
<p>Well, that was not unexpected. As we talked about before, our small gene expression matrix changes the basis vectors to point to each patient. However, as mentioned, it also transformed the base, standard space to the gene expression space. How about if we start from another space which is different from the standard one. Well, we saw that standard space has a simple meaning: a space that can be transformed to anything, and after the transformation, its not the standard space anymore! But do we have another space that has a more concrete meaning compared to the standard one and still keeps its meaning if we transform it? Yes, we do. That is the space defined by our eigenvectors. The eigenvectors cannot be changed (their span of course), so they keep their meaning even after transformation:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="pcamath.html#cb109-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb109-2"><a href="pcamath.html#cb109-2"></a><span class="co"># transformation matrix</span></span>
<span id="cb109-3"><a href="pcamath.html#cb109-3"></a>b&lt;-<span class="kw">as.matrix</span>(<span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">7</span>),<span class="dt">b=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb109-4"><a href="pcamath.html#cb109-4"></a><span class="co"># plot</span></span>
<span id="cb109-5"><a href="pcamath.html#cb109-5"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb109-6"><a href="pcamath.html#cb109-6"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> T,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb109-7"><a href="pcamath.html#cb109-7"></a></span>
<span id="cb109-8"><a href="pcamath.html#cb109-8"></a><span class="kw">title</span>(<span class="st">&quot;Original eigen space&quot;</span>)</span>
<span id="cb109-9"><a href="pcamath.html#cb109-9"></a><span class="co"># plot eigen lines</span></span>
<span id="cb109-10"><a href="pcamath.html#cb109-10"></a>eigen_b&lt;-<span class="kw">eigen</span>(b)</span>
<span id="cb109-11"><a href="pcamath.html#cb109-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">-110</span><span class="op">:</span><span class="dv">110</span>)</span>
<span id="cb109-12"><a href="pcamath.html#cb109-12"></a>{</span>
<span id="cb109-13"><a href="pcamath.html#cb109-13"></a> <span class="kw">abline</span>(<span class="dt">a=</span>i,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span>eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb109-14"><a href="pcamath.html#cb109-14"></a> <span class="kw">abline</span>(<span class="dt">a=</span>i,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span>eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb109-15"><a href="pcamath.html#cb109-15"></a>}</span>
<span id="cb109-16"><a href="pcamath.html#cb109-16"></a></span>
<span id="cb109-17"><a href="pcamath.html#cb109-17"></a></span>
<span id="cb109-18"><a href="pcamath.html#cb109-18"></a><span class="co"># draw arrows and spans</span></span>
<span id="cb109-19"><a href="pcamath.html#cb109-19"></a>eigen_b<span class="op">$</span>vectors&lt;-eigen_b<span class="op">$</span>vectors</span>
<span id="cb109-20"><a href="pcamath.html#cb109-20"></a></span>
<span id="cb109-21"><a href="pcamath.html#cb109-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb109-22"><a href="pcamath.html#cb109-22"></a><span class="kw">text</span>(eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">&quot;eigen1&quot;</span>,<span class="dt">adj =</span> <span class="fl">-0.5</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb109-23"><a href="pcamath.html#cb109-23"></a></span>
<span id="cb109-24"><a href="pcamath.html#cb109-24"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb109-25"><a href="pcamath.html#cb109-25"></a><span class="kw">text</span>(eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="st">&quot;eigen2&quot;</span>,<span class="dt">adj =</span> <span class="dv">2</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb109-26"><a href="pcamath.html#cb109-26"></a></span>
<span id="cb109-27"><a href="pcamath.html#cb109-27"></a></span>
<span id="cb109-28"><a href="pcamath.html#cb109-28"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-29"><a href="pcamath.html#cb109-29"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-30"><a href="pcamath.html#cb109-30"></a></span>
<span id="cb109-31"><a href="pcamath.html#cb109-31"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-32"><a href="pcamath.html#cb109-32"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-33"><a href="pcamath.html#cb109-33"></a></span>
<span id="cb109-34"><a href="pcamath.html#cb109-34"></a><span class="co"># map the eigens to the space</span></span>
<span id="cb109-35"><a href="pcamath.html#cb109-35"></a>eigen_b<span class="op">$</span>vectors&lt;-b<span class="op">%*%</span>eigen_b<span class="op">$</span>vectors</span>
<span id="cb109-36"><a href="pcamath.html#cb109-36"></a></span>
<span id="cb109-37"><a href="pcamath.html#cb109-37"></a><span class="kw">plot</span>(<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">1</span>],mydata[,<span class="dv">3</span>])),<span class="kw">range</span>(<span class="kw">rbind</span>(mydata[,<span class="dv">2</span>],mydata[,<span class="dv">4</span>])),</span>
<span id="cb109-38"><a href="pcamath.html#cb109-38"></a>     <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> T,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb109-39"><a href="pcamath.html#cb109-39"></a></span>
<span id="cb109-40"><a href="pcamath.html#cb109-40"></a><span class="co"># draw spans</span></span>
<span id="cb109-41"><a href="pcamath.html#cb109-41"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">-110</span><span class="op">:</span><span class="dv">110</span>)</span>
<span id="cb109-42"><a href="pcamath.html#cb109-42"></a>{</span>
<span id="cb109-43"><a href="pcamath.html#cb109-43"></a> <span class="kw">abline</span>(<span class="dt">a=</span>i,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">/</span>eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb109-44"><a href="pcamath.html#cb109-44"></a> <span class="kw">abline</span>(<span class="dt">a=</span>i,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span>eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb109-45"><a href="pcamath.html#cb109-45"></a>}</span>
<span id="cb109-46"><a href="pcamath.html#cb109-46"></a></span>
<span id="cb109-47"><a href="pcamath.html#cb109-47"></a><span class="co"># arrows and other stuff!</span></span>
<span id="cb109-48"><a href="pcamath.html#cb109-48"></a></span>
<span id="cb109-49"><a href="pcamath.html#cb109-49"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb109-50"><a href="pcamath.html#cb109-50"></a></span>
<span id="cb109-51"><a href="pcamath.html#cb109-51"></a></span>
<span id="cb109-52"><a href="pcamath.html#cb109-52"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb109-53"><a href="pcamath.html#cb109-53"></a></span>
<span id="cb109-54"><a href="pcamath.html#cb109-54"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-55"><a href="pcamath.html#cb109-55"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-56"><a href="pcamath.html#cb109-56"></a></span>
<span id="cb109-57"><a href="pcamath.html#cb109-57"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>]<span class="op">*-</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-58"><a href="pcamath.html#cb109-58"></a><span class="kw">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">10</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">*-</span><span class="dv">10</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb109-59"><a href="pcamath.html#cb109-59"></a></span>
<span id="cb109-60"><a href="pcamath.html#cb109-60"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space&quot;</span>)</span>
<span id="cb109-61"><a href="pcamath.html#cb109-61"></a></span>
<span id="cb109-62"><a href="pcamath.html#cb109-62"></a></span>
<span id="cb109-63"><a href="pcamath.html#cb109-63"></a><span class="kw">plot</span>(<span class="kw">t</span>(eigen_b<span class="op">$</span>vectors),<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">axes =</span> T,<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb109-64"><a href="pcamath.html#cb109-64"></a><span class="kw">text</span>(<span class="kw">t</span>(eigen_b<span class="op">$</span>vectors),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;sample 1&quot;</span>,<span class="st">&quot;sample 2&quot;</span>),<span class="dt">adj =</span> <span class="fl">1.2</span>)</span>
<span id="cb109-65"><a href="pcamath.html#cb109-65"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>,)</span>
<span id="cb109-66"><a href="pcamath.html#cb109-66"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_b<span class="op">$</span>vectors[<span class="dv">1</span>,<span class="dv">2</span>],eigen_b<span class="op">$</span>vectors[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb109-67"><a href="pcamath.html#cb109-67"></a><span class="kw">title</span>(<span class="st">&quot;Transformed space without grid&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eigen6"></span>
<img src="PCA_files/figure-html/eigen6-1.png" alt="Smal gene expression matrix has been used to transform the eigenvector space" width="672" />
<p class="caption">
Figure 6.39: Smal gene expression matrix has been used to transform the eigenvector space
</p>
</div>
<p>What happened? Well, instead of the standard basis, we started from another set of bases (eigenbasis). In Figure <a href="pcamath.html#fig:eigen6">6.39</a>, we plotted the eigenvectors as those small little red and blue vectors. Their corresponding span has been plotted as dashed lines and we have grid lines (line parallel to the vectors). We then did the transformation of <span class="math inline">\(A \  E\)</span> where <span class="math inline">\(E\)</span> is now our matrix of eigenvectors. What we see in the upper right panel is that our transformation could not change the space! The eigenvectors were stretched or squeezed but they are on the same spans. What does this mean? Let’s start from the start, we had a basis vector defining a space for us. We took our data, smashed it into that space. Because space was too “flexible”, our data changed the space to the shape of our data. Like smashing an apple to a wall made of dough! It was too flexible! We changed our basis to eigenvectors (concrete wall). We smash our data to this new space so instead of reshaping the wall, our data gets flattened on the space, giving us its overall shape. That is the lower-left panel in Figure <a href="pcamath.html#fig:eigen6">6.39</a>. Another interesting point, if our data is an apple (3d), we smash to dough (standard space), the dough itself is going to be 3d! But if we define a concrete wall (eigenspace) that is 2d and smash our 3d apple against it, the apple is going to be 2d! Yes! This sounds familiar, right? This is dimensionality reduction. Exactly what PCA or similar methods do for us! Fun is enough! Let’s try to mathematically find that concrete wall!</p>

<div class="definition">
<p><span id="def:eigens" class="definition"><strong>Definition 6.14  (Eigenvectors and eigenvalues)  </strong></span>Eigenvectors are vectors in space that when transformed by a matrix, do not change span but only scale by a certain factor. This scaling factor is called an eigenvalue. So if we have eigenvectors in <span class="math inline">\(v\)</span> and we have a matrix <span class="math inline">\(A\)</span>:</p>
<p><span class="math inline">\(A \  v = \lambda \  v\)</span></p>
<p>Which is basically saying that after transformation, our eigenvectors are just become scaled by <span class="math inline">\(\lambda\)</span> (which is scalar)! As opposed to what some think, eigenvectors might not necessarily orthogonal to each other. In special cases of symmetric matrix (a matrix that has same things on upper diagonal elements than the lower part (for example, <span class="math inline">\(A=\begin{vmatrix} 1&amp;2&amp;3\\2&amp;4&amp;6\\3&amp;6&amp;9\end{vmatrix}\)</span>), the eigenvectors become orthogonal. The number of eigenvectors in a matrix is equal to its rank.</p>
</div>

<p>How do we calculate the eigenvalues and eigenvectors from this equation? Let’s go step by step.</p>
<p><span class="math inline">\(A \  v = \lambda \  v\)</span></p>
<p>We have a few problems now, <span class="math inline">\(A\)</span> and <span class="math inline">\(v\)</span> are matrices but <span class="math inline">\(\lambda\)</span> is just a number. If we want to solve this funny equation, we have brought <span class="math inline">\(\lambda \  v\)</span> to the left part of the equation. To do so we have to transform it into a matrix shape by just multiply it to an identity matrix, the size of the number of columns of <span class="math inline">\(A\)</span>. So let’s do it</p>
<p><span class="math inline">\(A \  v = \lambda \  I_n \  v\)</span></p>
<p>We can now safely bring <span class="math inline">\(\lambda \  I_n \  v\)</span> to the left part.</p>
<p><span class="math inline">\(A \  v - \lambda \  I_n \  v=0\)</span></p>
<p>Noticed how <span class="math inline">\(v\)</span> is repeating here? We have <span class="math inline">\(A \  v\)</span> and <span class="math inline">\(\lambda \  I_n \  v\)</span>, we can factor <span class="math inline">\(v\)</span> and rewrite the whole thing as</p>
<p><span class="math inline">\((A -\lambda \  I_n) \  v=0\)</span></p>
<p>Ok! That became a little boring. To solve this, we could just find the inverse of <span class="math inline">\((A -\lambda \  I_n)\)</span> and multiply it by both sides? We know that if we multiply a matrix by its inverse, the result will be an identity matrix (like 1 in you divide a number by itself). In this case, <span class="math inline">\(v\)</span> will be zero. So our eigenvector is just zero! Boring!</p>
<p>Let’s be smart! We have matrix <span class="math inline">\(A\)</span>, that is our data. We are left with one parameter to change that <span class="math inline">\(\lambda\)</span>, we can choose <span class="math inline">\(\lambda\)</span> in a way that <span class="math inline">\((A -\lambda \  I_n)\)</span> does not have an inverse anymore so we cannot end up with <span class="math inline">\(v=0\)</span>! Smart right?</p>
<p>Do you remember when a matrix did not have an inverse (<a href="pcamath.html#def:det">6.10</a>)? Exactly, when its determinant is zero! So we want to find a <span class="math inline">\(\lambda\)</span> so determinant of <span class="math inline">\((A -\lambda \  I_n)\)</span> is zero.
That is</p>
<p><span class="math inline">\(|A -\lambda \  I_n|=0\)</span></p>
<p>We know <span class="math inline">\(A=\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix}\)</span> and <span class="math inline">\(I_n=A=\begin{vmatrix} 1&amp;0\\0&amp;1\end{vmatrix}\)</span> let’s put back thins:</p>
<p><span class="math inline">\(|\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix} -\lambda \  \begin{vmatrix} 1&amp;0\\0&amp;1\end{vmatrix}|=0\)</span></p>
<p>We know that if we multiply a scalar by a matrix, every element of the matrix will be multiplied by that scalar so what is <span class="math inline">\(\lambda \  \begin{vmatrix} 1&amp;0\\0&amp;1\end{vmatrix}\)</span>?</p>
<p>It’s</p>
<p><span class="math display">\[\begin{vmatrix} \lambda \times 1 &amp;\lambda \times 0\\ \lambda \times 0 &amp; \lambda \times 1 \end{vmatrix}= \begin{vmatrix} \lambda &amp;0\\0&amp;\lambda \end{vmatrix}\]</span></p>
<p>Awesome! let’s put back things in <span class="math inline">\(|\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix} -\lambda \  \begin{vmatrix} 1&amp;0\\0&amp;1\end{vmatrix}|=0\)</span>:</p>
<p><span class="math display">\[|\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix} - \begin{vmatrix} \lambda &amp;0\\0&amp;\lambda \end{vmatrix}|=0\]</span></p>
<p>Let’s move forward! We know that if we subtract two matrices of similar size, each element of the left hand side will be subtracted by the corresponding element of the left hand side. So,</p>
<p><span class="math inline">\(|\begin{vmatrix} 2-\lambda&amp;1-0\\7-0 &amp; 2-\lambda\end{vmatrix}|=0\)</span> that is <span class="math inline">\(|\begin{vmatrix} 2-\lambda&amp;1\\7 &amp; 2-\lambda\end{vmatrix}|=0\)</span></p>
<p>Now time for determinant (<a href="pcamath.html#def:det">6.10</a>).</p>
<p><span class="math inline">\((2-\lambda) \times (2-\lambda) - 1 \times 7\)</span> which is <span class="math inline">\((2-\lambda) \times (2-\lambda) - 7\)</span>. Do you remember how solve this? Probably not. Long time from high school!</p>
<p>Let’s start with <span class="math inline">\((2-\lambda) \times (2-\lambda)\)</span>, we can fix this but multiplying every scalar or variable (<span class="math inline">\(\lambda\)</span>) in left parenthesis to everything in right parenthesis in a pairwise manner.</p>
<p>That is <span class="math inline">\((2-\lambda) \times (2-\lambda)= 2 \times 2 \ + \lambda \times -2 \ + 2 \times -\lambda \ + -\lambda \  \times -\lambda=4 - 2\lambda-2\lambda+\lambda^2=4 - 4\lambda+\lambda^2\)</span></p>
<p>We turn things around and it becomes <span class="math inline">\(\lambda^2 \ - 4\lambda + 4\)</span> we put this back in the original equation (<span class="math inline">\((2-\lambda) \times (2-\lambda) - 7\)</span>):</p>
<p><span class="math display">\[\lambda^2 \ - 4\lambda + 4-7=\lambda^2 \ - 4\lambda -3\]</span></p>
<p>We need to solve this beast! <span class="math inline">\(\lambda^2 \ - 4\lambda -3=0\)</span></p>
<p>This is a quadratic formula with the form. <span class="math inline">\(ax^2+bx+c=0\)</span>. So we have <span class="math inline">\(a=1 , b=-4, c=-3\)</span> for which we have a formula ready:</p>
<p><span class="math display">\[\lambda=\frac{-b \pm \sqrt{b^2-4ac}}{2a}\]</span>
So we plug in the numbers:</p>
<p><span class="math display">\[\lambda=\frac{-(-4) \pm \sqrt{-4^2-4(1)(-3)}}{2(1)}\]</span>
Which will give us</p>
<p><span class="math display">\[\lambda=\frac{4 \pm \sqrt{28}}{2}\]</span>
Did you notice we have plus and minus? So we have two <span class="math inline">\(x\)</span> one with plus and one with a minus:</p>
<p><span class="math inline">\(\lambda=2 + \sqrt{7}=4.64\)</span></p>
<p>and
<span class="math inline">\(\lambda=2 - \sqrt{7}=-0.64\)</span></p>
<p>These two are our eigenvalues.
Remember that we can also put these inside a matrix. Like <span class="math inline">\(\Lambda= \begin{vmatrix} \lambda &amp; 0 \\ 0 &amp; \lambda \end{vmatrix}\)</span>. We will see where we use this later. For now let’s have a look at the eigenvector formula again!</p>
<p><span class="math inline">\(A \  v = \lambda \  I_n \  v\)</span></p>
<p>Amazing, we have lambda now. We can put them inside the formula, one by one:
For the first one <span class="math inline">\(4.64\)</span>:</p>
<p><span class="math inline">\(A \  v = 4.64 \  v\)</span></p>
<p>Now we want <span class="math inline">\(v\)</span>! What is <span class="math inline">\(v\)</span>? We don’t know. So let’s just give it a name. We know that it’s an eigenvector with coordinates <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, so we just call it <span class="math inline">\([x,y]\)</span> but in matrix form:</p>
<p><span class="math inline">\(A \  \begin{vmatrix}x\\y\end{vmatrix} = 4.64 \  \begin{vmatrix}x\\y\end{vmatrix}\)</span></p>
<p>We know <span class="math inline">\(A\)</span> so we put it in</p>
<p><span class="math inline">\(\begin{vmatrix} 2&amp;1\\7&amp;2\end{vmatrix} \  \begin{vmatrix}x\\y\end{vmatrix} = 4.64 \  \begin{vmatrix}x\\y\end{vmatrix}\)</span>.</p>
<p>Fortunately, by now, we know how to multiply a matrix. So to use matrix multiplication to find <span class="math inline">\([x,y]\)</span> we first multiply the first row <span class="math inline">\(A\)</span> by <span class="math inline">\(v\)</span> on the left-hand side of the equation and the result will be equal to<span class="math inline">\(\lambda\)</span> multiply by the first row of <span class="math inline">\(v\)</span> on the right-hand side.</p>
<p><span class="math inline">\(2 \times x + 1\times y=4.64 \times x\)</span></p>
<p>Now we repeat the same thing but for the second row.</p>
<p><span class="math inline">\(7 \times x + 2\times y=4.64 \times y\)</span></p>
<p>Great! We can now start solving <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:</p>
<p>Let’s bring evenything on the left:</p>
<p><span class="math inline">\(2x + y-4.64x=0\)</span>
<span class="math inline">\(7x + 2y-4.64y=0\)</span></p>
<p>Let’s try to simplify the first equation. We have two x there, we could just subtract them so the first equation becomes
<span class="math inline">\(y-2.64x=0\)</span></p>
<p>The same thing for the second equation:
<span class="math inline">\(7x -2.64y=0\)</span></p>
<p>Let’s start with the simpler equation (the first one) and calculate x:
so <span class="math inline">\(y-2.64x=0\)</span> becomes <span class="math inline">\(x=\frac{y}{2.64}\)</span> and we do the same for the second equation that is <span class="math inline">\(7x -2.64y=0\)</span> becomes <span class="math inline">\(y=\frac{7x}{2.64}\)</span>.</p>
<p>Great! We are actually there! So now our first eigenvector is <span class="math inline">\([x,\frac{7x}{2.64}]\)</span>, you can put any value therein x! It does not matter!</p>
<p>With the similar setting we can solve the second eigenvector <span class="math inline">\([p,l]\)</span>:</p>
<p><span class="math inline">\(2 \times p + 1\times l=-0.64 \times p\)</span>
<span class="math inline">\(7 \times p + 2\times l=-0.64 \times l\)</span></p>
<p><span class="math inline">\(2p + l+0.64p=0\)</span>
<span class="math inline">\(7p + 2l+0.64l=0\)</span></p>
<p>which will give us</p>
<p><span class="math inline">\(l=-2.64p\)</span></p>
<p><span class="math inline">\(p=\frac{-2.64l}{7}\)</span></p>
<p>So our second eigenvector is <span class="math inline">\([p,-2.64p]\)</span>, you are free to choose any <span class="math inline">\(p\)</span>. So our amazing basis vectors are defined as</p>
<p><span class="math display">\[V=\begin{vmatrix} x&amp;p\\ \frac{7x}{2.64}&amp;-2.64p\end{vmatrix}\]</span>
Now i just put a value there and I get our eigenvector to be for example:</p>
<p><span class="math display">\[V=\begin{vmatrix} x&amp;p\\ \frac{7x}{2.64}&amp;-2.64p\end{vmatrix}\]</span></p>
<p><span class="math display">\[V=\begin{vmatrix} 0.3535534&amp;-0.3535534\\ 0.9354143&amp;0.9354143\end{vmatrix}\]</span>
How I got to those numbers? well, I just put a number in <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> and then calculate the two other numbers. Then for each column, I divided the values of the column by the norm (magnitude) of the vector in those columns. For example for the first column, i chose <span class="math inline">\(x=1\)</span> then the second row became <span class="math inline">\(2.645751\)</span> then i calculated the magnitude of this vector <span class="math inline">\([1,2.645751]\)</span> as <span class="math inline">\(\sqrt{1^2+2.645751^2}=2.828427\)</span> then i divided <span class="math inline">\([1,2.645751]\)</span> by <span class="math inline">\(2.828427\)</span> which gave me <span class="math inline">\([0.3535534,0.9354143]\)</span>.</p>
<p>You can try for the second column!</p>
<p>We now have eigenvector and their eigenvalues. We can put the <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(v\)</span> inside matrices and do everything with matrices : <span class="math inline">\(A \  V = \Lambda \  V\)</span>. This is called eigendecomposition and PCA uses this to rotated our data and put on the space of these vectors. We will see how it does it soon! In fact, eigenvectors are used in many different applications but here we focus on one application, called matrix diagonalization.</p>
</div>
<div id="matrix-diagonalization" class="section level3">
<h3><span class="header-section-number">6.4.7</span> Matrix diagonalization</h3>
<p>Matrix diagonalization is defined as taking a square matrix, like <span class="math inline">\(A=\begin{vmatrix} 1&amp;2&amp;3\\4&amp;5&amp;6\\7&amp;8&amp;9\end{vmatrix}\)</span> and transform it into another square matrix like <span class="math inline">\(B\)</span> where all the off-diagonal elements of the matrix is zero for example <span class="math inline">\(B=\begin{vmatrix} 1&amp;0&amp;0\\0&amp;5&amp;0\\0&amp;0&amp;9\end{vmatrix}\)</span> but this matrix should still capture whatever pattern it was in the original matrix! That seems fancy and in fact, it is! Before going through what should we do to achieve that, we might have a look at why we would like to do that in the context of PCA. That is getting back to <a href="#fig-simple-cov">covariance and variance of variables</a>.</p>
<div id="covariance-matrix" class="section level4">
<h4><span class="header-section-number">6.4.7.1</span> Covariance matrix</h4>
<p>If you remember, we said variance is our focus, at least here. We consider variance as both information and noise but we assume that variance of the signal is higher than the variance of noise (refer to the <a href="intro.html#intro">introduction</a> if you don’t remember this). We can simply calculate the variance as the spread around the mean:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="pcamath.html#cb110-1"></a><span class="co"># Select variable</span></span>
<span id="cb110-2"><a href="pcamath.html#cb110-2"></a>variableIndex&lt;-<span class="dv">1</span></span>
<span id="cb110-3"><a href="pcamath.html#cb110-3"></a></span>
<span id="cb110-4"><a href="pcamath.html#cb110-4"></a><span class="co"># plot the data for variable 1</span></span>
<span id="cb110-5"><a href="pcamath.html#cb110-5"></a><span class="kw">plot</span>(data[,variableIndex],<span class="dt">xlab =</span> <span class="st">&quot;Sample index&quot;</span>,<span class="dt">ylab =</span> <span class="kw">paste</span>(<span class="st">&quot;Variable&quot;</span>,variableIndex),</span>
<span id="cb110-6"><a href="pcamath.html#cb110-6"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="kw">min</span>(data[,variableIndex])<span class="op">-</span><span class="fl">0.1</span>,<span class="kw">max</span>(data[,variableIndex])<span class="op">+</span><span class="fl">0.1</span>),<span class="dt">xaxt=</span><span class="st">&#39;n&#39;</span>)</span>
<span id="cb110-7"><a href="pcamath.html#cb110-7"></a><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data), <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data))</span>
<span id="cb110-8"><a href="pcamath.html#cb110-8"></a></span>
<span id="cb110-9"><a href="pcamath.html#cb110-9"></a><span class="co"># fig position of labels</span></span>
<span id="cb110-10"><a href="pcamath.html#cb110-10"></a>pos_plot&lt;-(<span class="kw">as.numeric</span>(data[,variableIndex]<span class="op">&gt;</span><span class="kw">mean</span>(data[,variableIndex]))<span class="op">*</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb110-11"><a href="pcamath.html#cb110-11"></a><span class="co"># Draw sample index</span></span>
<span id="cb110-12"><a href="pcamath.html#cb110-12"></a><span class="kw">text</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data), data[,variableIndex],  <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data),</span>
<span id="cb110-13"><a href="pcamath.html#cb110-13"></a>     <span class="dt">cex=</span><span class="fl">0.65</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pos=</span>pos_plot)</span>
<span id="cb110-14"><a href="pcamath.html#cb110-14"></a></span>
<span id="cb110-15"><a href="pcamath.html#cb110-15"></a><span class="co"># draw the mean line</span></span>
<span id="cb110-16"><a href="pcamath.html#cb110-16"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">mean</span>(data[,variableIndex],),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb110-17"><a href="pcamath.html#cb110-17"></a></span>
<span id="cb110-18"><a href="pcamath.html#cb110-18"></a><span class="co"># for each observation draw a line from that point to the mean</span></span>
<span id="cb110-19"><a href="pcamath.html#cb110-19"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data))</span>
<span id="cb110-20"><a href="pcamath.html#cb110-20"></a>{</span>
<span id="cb110-21"><a href="pcamath.html#cb110-21"></a>  <span class="kw">segments</span>(<span class="dt">x0 =</span> i,<span class="dt">x1 =</span> i,<span class="dt">y0 =</span> data[i,variableIndex],<span class="dt">y1 =</span> <span class="kw">mean</span>(data[,variableIndex]),<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb110-22"><a href="pcamath.html#cb110-22"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pcavar"></span>
<img src="PCA_files/figure-html/pcavar-1.png" alt="Here, we select one variable (a gene) and show how the data is spread around the mean. The red numbers show the index of each sample. The red line shows the mean and the dashed lines show the distance between each observation and mean" width="672" />
<p class="caption">
Figure 6.40: Here, we select one variable (a gene) and show how the data is spread around the mean. The red numbers show the index of each sample. The red line shows the mean and the dashed lines show the distance between each observation and mean
</p>
</div>
<p>This is calculated as <span class="math inline">\(\sigma^2 = \frac{\sum_{i=1}^{n}(x_i - \mu)^2} {n-1}\)</span> which is saying that for each value in this specific variable, subtract it by the average of the variable and raise it to the power two. Then sum all resulting values and divide the results by <span class="math inline">\(n-1\)</span>. For example if we have <span class="math inline">\(a=[1,2,3]\)</span>, average of <span class="math inline">\(a\)</span> is <span class="math inline">\(2\)</span> and the variance is <span class="math inline">\(\sigma^{2}=\frac{(1-2)^{2}+(2-2)^{2}+(3-2)^{2}}{3-1}=1\)</span></p>
<p>We also defined covariance as the measure of redundancy in our data. More specifically, if we calculate the covariance between two variables, a value higher than zero means the variable shows similar information in the same direction. If it’s below zero they are showing the opposite information (still redundant but opposite). And if it’s zero, they are showing complementary information.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="pcamath.html#cb111-1"></a><span class="co"># define variables</span></span>
<span id="cb111-2"><a href="pcamath.html#cb111-2"></a>var1&lt;-<span class="dv">18924</span></span>
<span id="cb111-3"><a href="pcamath.html#cb111-3"></a>var2&lt;-<span class="dv">20355</span></span>
<span id="cb111-4"><a href="pcamath.html#cb111-4"></a><span class="co"># plot the data</span></span>
<span id="cb111-5"><a href="pcamath.html#cb111-5"></a><span class="kw">plot</span>(data[,<span class="kw">c</span>(var1,var2)],<span class="dt">xlab =</span> <span class="st">&quot;Variable 1&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Variable 2&quot;</span>)</span>
<span id="cb111-6"><a href="pcamath.html#cb111-6"></a></span>
<span id="cb111-7"><a href="pcamath.html#cb111-7"></a><span class="co"># fig position of labels</span></span>
<span id="cb111-8"><a href="pcamath.html#cb111-8"></a>pos_plot&lt;-(<span class="kw">as.numeric</span>(<span class="kw">sort</span>(data[,variableIndex])<span class="op">&gt;</span><span class="kw">mean</span>(data[,variableIndex]))<span class="op">*</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb111-9"><a href="pcamath.html#cb111-9"></a><span class="co"># Draw sample index</span></span>
<span id="cb111-10"><a href="pcamath.html#cb111-10"></a><span class="kw">text</span>((data[,var1]), (data[,var2]),  <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data),</span>
<span id="cb111-11"><a href="pcamath.html#cb111-11"></a>     <span class="dt">cex=</span><span class="fl">0.65</span>,<span class="dt">pos=</span>pos_plot)</span>
<span id="cb111-12"><a href="pcamath.html#cb111-12"></a></span>
<span id="cb111-13"><a href="pcamath.html#cb111-13"></a><span class="co"># plot mean of variable 1</span></span>
<span id="cb111-14"><a href="pcamath.html#cb111-14"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">mean</span>(data[,var1]),<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb111-15"><a href="pcamath.html#cb111-15"></a></span>
<span id="cb111-16"><a href="pcamath.html#cb111-16"></a><span class="co"># plot mean of variable 2</span></span>
<span id="cb111-17"><a href="pcamath.html#cb111-17"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">mean</span>(data[,var2]),<span class="dt">col=</span><span class="st">&quot;coral&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb111-18"><a href="pcamath.html#cb111-18"></a></span>
<span id="cb111-19"><a href="pcamath.html#cb111-19"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data))</span>
<span id="cb111-20"><a href="pcamath.html#cb111-20"></a>{</span>
<span id="cb111-21"><a href="pcamath.html#cb111-21"></a>  </span>
<span id="cb111-22"><a href="pcamath.html#cb111-22"></a>    <span class="kw">segments</span>(<span class="dt">x0 =</span> (data[,var1])[i],<span class="dt">x1 =</span> <span class="kw">mean</span>(data[,var1]),<span class="dt">y0 =</span> (data[,var2])[i],<span class="dt">y1 =</span>  (data[,var2])[i],<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb111-23"><a href="pcamath.html#cb111-23"></a>             <span class="dt">col=</span><span class="kw">ifelse</span>(data[i,var1]<span class="op">&gt;</span><span class="kw">mean</span>(data[,var1]),<span class="dt">yes =</span> <span class="st">&quot;indianred1&quot;</span>,<span class="dt">no =</span> <span class="st">&quot;lightblue&quot;</span>))</span>
<span id="cb111-24"><a href="pcamath.html#cb111-24"></a>  </span>
<span id="cb111-25"><a href="pcamath.html#cb111-25"></a>  </span>
<span id="cb111-26"><a href="pcamath.html#cb111-26"></a>    <span class="kw">segments</span>(<span class="dt">x0 =</span> (data[,var1])[i],<span class="dt">x1 =</span> (data[,var1])[i],<span class="dt">y0 =</span> (data[,var2])[i],<span class="dt">y1 =</span>  <span class="kw">mean</span>(data[,var2]),<span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb111-27"><a href="pcamath.html#cb111-27"></a>             <span class="dt">col=</span><span class="kw">ifelse</span>(data[i,var2]<span class="op">&gt;</span><span class="kw">mean</span>(data[,var2]),<span class="dt">yes =</span> <span class="st">&quot;indianred1&quot;</span>,<span class="dt">no =</span> <span class="st">&quot;lightblue&quot;</span>))</span>
<span id="cb111-28"><a href="pcamath.html#cb111-28"></a>}</span>
<span id="cb111-29"><a href="pcamath.html#cb111-29"></a></span>
<span id="cb111-30"><a href="pcamath.html#cb111-30"></a><span class="co"># add areas to the plot</span></span>
<span id="cb111-31"><a href="pcamath.html#cb111-31"></a></span>
<span id="cb111-32"><a href="pcamath.html#cb111-32"></a><span class="kw">text</span>(<span class="dv">4</span>,<span class="dv">8</span>,<span class="st">&quot;Area 1&quot;</span>)</span>
<span id="cb111-33"><a href="pcamath.html#cb111-33"></a><span class="kw">text</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="st">&quot;Area 2&quot;</span>)</span>
<span id="cb111-34"><a href="pcamath.html#cb111-34"></a><span class="kw">text</span>(<span class="dv">10</span>,<span class="fl">2.5</span>,<span class="st">&quot;Area 3&quot;</span>)</span>
<span id="cb111-35"><a href="pcamath.html#cb111-35"></a><span class="kw">text</span>(<span class="dv">4</span>,<span class="fl">2.5</span>,<span class="st">&quot;Area 4&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pcacov"></span>
<img src="PCA_files/figure-html/pcacov-1.png" alt="Here, we select two variables and show how the data is spread according to both of the variables. The solid purple and coral lines show mean of variable and variable 2, respectively. For each observation, we have two lines showing whether it has higher or lower value compared to mean of variable one and variable 2." width="672" />
<p class="caption">
Figure 6.41: Here, we select two variables and show how the data is spread according to both of the variables. The solid purple and coral lines show mean of variable and variable 2, respectively. For each observation, we have two lines showing whether it has higher or lower value compared to mean of variable one and variable 2.
</p>
</div>
<p>We calculate covariance as <span class="math inline">\(Cov(x,y)=\frac{\sum_{i=1}^{N}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n-1}\)</span> which is saying (as depicted in Figure <a href="pcamath.html#fig:pcacov">6.41</a>): We have two variables, select the first value in the first variable, find how much it’s going up or down compare to its mean. Now select the corresponding value in the second variable and do the same thing. Multiply the result. Then Do the same thing for all the values in the two variables. Sum the results and divide by number of values. The whole thing is asking where the values of two variables are consistently going up or down compared to their means. For example if we have <span class="math inline">\(a=[1,2,3]\)</span> and <span class="math inline">\(b=[4,2,5]\)</span> the covariance of <span class="math inline">\(a\)</span> with average of <span class="math inline">\(2\)</span> and <span class="math inline">\(b\)</span> with average of <span class="math inline">\(3.6\)</span> is <span class="math inline">\(Cov(a,b)=\frac{(1-2) \times (4-3.6) + (2-2) \times (2-3.6) + (3-2) \times (5-3.6)}{3-1}=0.5\)</span>.</p>
<p>There is a small little thing here! That we often have many variables (thousands) and we have to calculate variance for each of them and covariance for all the two pairs of variables. Can we store this information somewhere? That is a covariance matrix. The diagonal elements in the covariance matrix show variance and the off-diagonal elements show covariance. For example, if we have three variables (three genes): <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>, we can define the covariance matrix as follow</p>
<p><span class="math display">\[\begin{array}{c c} &amp;
\begin{array}{c c c} a &amp; b &amp;c \\
\end{array}
\\
\begin{array}{c c c}
a \\
b\\
c
\end{array}
&amp;
\left|
\begin{array}{c c c}
0.4 &amp; .3 &amp; 0 \\
0.3 &amp; 2 &amp; 5 \\
0 &amp; 5 &amp; 0.8
\end{array}
\right|
\end{array}\]</span></p>
<p>We can calculate the covariance matrix of <span class="math inline">\(A\)</span> simply by doing <span class="math inline">\(Cov(A)=\frac{1}{n-1} \times A^T \  A\)</span> (look the matrix multiplication). Look at covariance formula, the first part of <span class="math inline">\(Cov(A)=\frac{1}{n-1} \times A^T \  A\)</span> is <span class="math inline">\(\frac{1}{n-1}\)</span> which is basically the division we do in <span class="math inline">\(Cov(x,y)=\frac{\sum_{i=1}^{N}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n-1}\)</span>. The second part is doing <span class="math inline">\(Cov(x,y)=\sum_{i=1}^{N}(x_{i})(y_{i})\)</span> we are missing something! What is that? Subtraction by the average. Here comes the trick. If we <a href="#centerExample">center our data</a>, the average of each variable becomes zero. So <span class="math inline">\(Cov(x,y)=\frac{\sum_{i=1}^{N}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n-1}\)</span> becomes <span class="math inline">\(Cov(x,y)=\frac{\sum_{i=1}^{N}(x_{i}-0)(y_{i}-0)}{n-1}\)</span> that is exactly <span class="math inline">\(Cov(A)=\frac{1}{n-1} \times A^T \  A\)</span>. There are some functions, software that do covaraince matrix using the tradition formula however, to be safe, make sure that you <strong>ALWAYS</strong> center your data. In the rest of this chapter, we assume that we have centered our data.</p>
<p>The variance of variable a is 0.4 (diagonal element), the variance of b is 2, and the variance of c is 0.8. The covariance between a and b is 0.3 as defined by the first row and the second column of the matrix or the first column and the second row of the matrix (yes, it’s symmetric! Amazing!). The covariance of b and c is 5 (second row and third column) and so forth. I guess by now you realized we summarized the whole structure of our data is a covariance matrix. It shows how individual variables are spread and how they are related. Well, this pretty much our data characteristics! As we said we like our data to have good variance but low covariance, meaning that we have not wasted our time and money measuring things that show the same thing! But we rather have complementary information. With this definition, what is a nice covariance matrix? It’s a matrix that has zero on the off-diagonal elements (no covariance between any variable in our data) and large numbers on the diagonal elements. Or at least the first one is the largest then the second one and so on. Did I say there is a method (diagonalization) that can take a square matrix and make everything off-diagonal zero and still keep the structure? Yes! We want to apply diagonalization on the covariance matrix to end up with nonzero elements on the diagonal and zero elements elsewhere. This means a structure that is guaranteed to no have redundant information! Awesome! Let’s move on to how we calculate it.</p>
</div>
</div>
<div id="eigendecomposition-of-a-covariance-matrix" class="section level3">
<h3><span class="header-section-number">6.4.8</span> Eigendecomposition of a covariance matrix</h3>
<p>There are many methods for diagonalization but here we focus on the classic one using eigendecomposition.</p>
<p>Let’s say our data is sitting in matrix <span class="math inline">\(X\)</span>, in which the rows are observations and the columns are variables. Our goal is to find an orthonormal matrix <span class="math inline">\(P\)</span> that when we mapped map our original data <span class="math inline">\(X\)</span> to another space <span class="math inline">\(Y\)</span> so that the covariance of <span class="math inline">\(Y\)</span> becomes diagonal (zero on all off-diagonal elements). So the goal is <span class="math inline">\(Y=X \  P\)</span> so that <span class="math inline">\(Cov(Y)=diagonal \ or \ \frac{1}{n}Y^T \  Y=diagonal\)</span>.</p>
<p>So as said before we can calculate the covariance of the mapped data (<span class="math inline">\(Y\)</span>) as <span class="math inline">\(Cov(Y)= \frac{1}{n}Y \  Y^T\)</span>. We covariance of the original data (before transformation) is <span class="math inline">\(Cov(X)= \frac{1}{n}X^T \  X\)</span> We can try to rewrite this formula like this:</p>
<p><span class="math inline">\(Cov(Y)= \frac{1}{n}Y^T \  Y\)</span>
Did we say that <span class="math inline">\(Y=XP\)</span> right?
So let’s replace <span class="math inline">\(Y\)</span> by <span class="math inline">\(XP\)</span> in right side of <span class="math inline">\(Cov(Y)= \frac{1}{n}Y^T \  Y\)</span></p>
<p><span class="math inline">\(Cov(Y)= \frac{1}{n} (XP)^T \  (XP)\)</span></p>
<p>We just expand transpose in <span class="math inline">\((PX)^T\)</span> and write it like <span class="math inline">\(X^T P^T\)</span> (note that we have to switch the order to <span class="math inline">\(PX\)</span> to <span class="math inline">\(XP\)</span>). Now let’s reorder the division by <span class="math inline">\(n\)</span> and remove the parenthesis.</p>
<p><span class="math inline">\(Cov(Y)= P^T\frac{1}{n}X^T XP\)</span></p>
<p>Great! Do you see something cool in the middle of the equation? Yes. That is the covariance of the original matrix (<span class="math inline">\(Cov(X)= \frac{1}{n}X^T \  X\)</span>).</p>
<p><span class="math inline">\(Cov(Y)= P^T(\frac{1}{n}X^T X)P\)</span></p>
<p>It reads that if we have to come up with a matrix <span class="math inline">\(P\)</span> and put it inside a formula, then the covariance of the mapped data becomes diagonal. This is exactly what we wanted! How do we come up with such a matrix <span class="math inline">\(P\)</span>? There is a theory saying that if we have a symmetric matrix, we can diagonalize it using its eigenvector. What does it mean? We said that we can calculate the covariance matrix of our data and this covariance matrix is symmetric. We can find the eigenvectors of this covariance matrix and use it as <span class="math inline">\(P\)</span> in <span class="math inline">\(Cov(Y)= P^T(\frac{1}{n}X^T X)P\)</span>. This way we are mapping our data to another space (using eigenvectors) where the mapped data will not have any covariance between its variables. Exactly what we were aiming for. Let’s see a short proof.</p>
<p>Do you remember we have two <span class="math inline">\(\lambda\)</span> in the eigenvalue section (<a href="pcamath.html#def:eigens">6.14</a>)? We said that we can put them inside a diagonal matrix like this <span class="math inline">\(\Lambda= \begin{vmatrix} \lambda &amp; 0 \\ 0 &amp; \lambda \end{vmatrix}\)</span>. Doing so our eigenvector formula becomes <span class="math inline">\(A \  V = \Lambda \  V\)</span> where <span class="math inline">\(\Lambda\)</span> is a matrix. We said the we want to find eigenvalues for covariance matrix so for (<span class="math inline">\(Cov(X)\)</span>). So let’s fix the eigen formula first.</p>
<p><span class="math inline">\(A \  V = \Lambda \  V\)</span>.</p>
<p>How can we make <span class="math inline">\(Cov(X)\)</span> isolated (separated) from <span class="math inline">\(V\)</span>? Well, we can multiply both side of the equation with <span class="math inline">\(V^{-1}\)</span>. So our equation become <span class="math inline">\(Cov(X)=V^{-1} \Lambda \  V\)</span>.
Maybe we don’t remember anymore, but we said the if we find the eigenvectors of a symmetric matrix, the eigenvectors are orthogonal. There is a super amazing thing about orthogonality. If all the vectors inside a matrix are orthogonal, the inverse of that matrix is equal to its transpose. So we said vectors in <span class="math inline">\(V\)</span> (containing eigenvectors) are orthogonal, this means <span class="math inline">\(V^{-1}=V^T\)</span>. So let’s fix the equation above:</p>
<p><span class="math inline">\(Cov(X)=V \Lambda \  V^T\)</span>.</p>
<p>We said that <span class="math inline">\(Cov(X)=\frac{1}{n}X^TX\)</span> so then <span class="math inline">\(Cov(X)=V \Lambda \  V^T\)</span> becomes <span class="math inline">\(\frac{1}{n}XX^T=V \Lambda \  V^T\)</span></p>
<p>Now it’s much better. We can find covariance of our original data by using the eigenvector and eigenvalues of the covariance matrix. Now let’s get back to the mapped data <span class="math inline">\(Y\)</span></p>
<p><span class="math inline">\(Cov(Y)= P^T(\frac{1}{n}X^T X)P\)</span></p>
<p>We said that <span class="math inline">\(\frac{1}{n}XX^T=V \Lambda \  V^T\)</span> so why not replace <span class="math inline">\(\frac{1}{n}X^TX\)</span> in <span class="math inline">\(Cov(Y)= P^T(\frac{1}{n}X^T X)P\)</span> by <span class="math inline">\(V \Lambda \  V^T\)</span>? Then we get rid of <span class="math inline">\(X\)</span>.
Let’s do that</p>
<p><span class="math inline">\(Cov(Y)= P^T(V \Lambda \  V^T)P\)</span></p>
<p>So great! Didn’t we say that one way to diagonalize a symmetric matrix is by its eigenvectors and we said the eigenvectors are in <span class="math inline">\(P\)</span>? Awesome. We just calculate them. They are in <span class="math inline">\(V\)</span>. Yes!! So Let’s replace <span class="math inline">\(P\)</span> by <span class="math inline">\(V\)</span>:</p>
<p><span class="math inline">\(Cov(Y)= V^T(V \Lambda \  V^T)V\)</span></p>
<p>We said the <span class="math inline">\(V^T=V^{-1}\)</span>, what is the result of <span class="math inline">\(V \  V^T\)</span> in this case? It’s an identity matrix or to oversimplify it, it is <span class="math inline">\(1\)</span>.</p>
<p>So, let’s take off the parenthesis and start removing all the <span class="math inline">\(VV^T\)</span></p>
<p><span class="math inline">\(Cov(Y)= V^TV \Lambda \  V^TV=\Lambda\)</span></p>
<p>What happened? Well, if we calculate the eigenvalues and eigenvectors of a covariance matrix, then map the data using the eigenvectors, then take the covariance of all the variables in the mapped data, the result will be equal to our eigenvalue matrix. Yes, eigenvalue matrix (<span class="math inline">\(\Lambda\)</span>) is diagonal, showing that we will NOT have any redundancy in the mapped space. And each eigenvalue (the value on the diagonal of <span class="math inline">\(\Lambda\)</span>) is the variance of the each variable in the new space! Do you remember we said that eigenvalue show how much space has been changed related to each eigenvector? They are essentially the variance of your new variables. So for application, you start with the eigenvector that has the largest eigenvalue and then move to the second one. That corresponds to taking the PC1, PC2 PC3, etc in PCA.</p>
<p>We are almost reaching the end of this section. Let’s try to summarize what PCA does.</p>
<ul>
<li>Take the dataset (gene expression), <span class="math inline">\(A\)</span></li>
<li>Calculate covariance matrix of <span class="math inline">\(A\)</span> that is <span class="math inline">\(Cov(A)\)</span></li>
<li>Find eigenvectors of <span class="math inline">\(Cov(A)\)</span>, that are <span class="math inline">\(V\)</span> and eigenvalues of <span class="math inline">\(Cov(A)\)</span> that are <span class="math inline">\(\Lambda\)</span></li>
<li>Sort the eigenvectors with respect to eigenvalues so the vector with the largest eigenvalue comes first and the second largest come next and so on (the columns of <span class="math inline">\(V\)</span> are ordered based on <span class="math inline">\(\Lambda\)</span>)</li>
<li>Multiply <span class="math inline">\(A\)</span> by sorted <span class="math inline">\(V\)</span> and call it <span class="math inline">\(Y\)</span> that is <span class="math inline">\(Y=A \  v\)</span></li>
<li><span class="math inline">\(Y\)</span> contains your data in new space (called PC/components/scores)</li>
<li>Your variables in the new space are NOT correlated</li>
<li><span class="math inline">\(\Lambda\)</span> is the covariance matrix of your new data</li>
<li>The eigenvalues can also be interpreted as weights PCA has given to your original variables</li>
<li>The maximum number of eigenvectors is the rank of your data!</li>
</ul>
<p>Now you can start interpreting PCA! But before saying goodbye. There are a few things I want to mention quickly.</p>
</div>
</div>
<div id="extra-topics" class="section level2">
<h2><span class="header-section-number">6.5</span> Extra topics</h2>
<div id="pca-and-ellipses" class="section level3">
<h3><span class="header-section-number">6.5.1</span> PCA and ellipses</h3>
<p>I understand that the math behind PCA might be too difficult for some people. Probably the best way of understanding what is happening is by showing ellipses.</p>
<p>PCA can be thought of as fitting your data inside an ellipse in 2d (or ellipsoid in n dimensions) then rotating the ellipse so that the axis of the ellipse is aligned with the standard basis.</p>
<p>Let’s look at an example:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="pcamath.html#cb112-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb112-2"><a href="pcamath.html#cb112-2"></a><span class="co"># define variables</span></span>
<span id="cb112-3"><a href="pcamath.html#cb112-3"></a>var1&lt;-<span class="dv">18924</span></span>
<span id="cb112-4"><a href="pcamath.html#cb112-4"></a>var2&lt;-<span class="dv">20355</span></span>
<span id="cb112-5"><a href="pcamath.html#cb112-5"></a>var3&lt;-<span class="dv">18505</span></span>
<span id="cb112-6"><a href="pcamath.html#cb112-6"></a></span>
<span id="cb112-7"><a href="pcamath.html#cb112-7"></a><span class="co"># dfine data</span></span>
<span id="cb112-8"><a href="pcamath.html#cb112-8"></a>x&lt;-<span class="kw">scale</span>(data[,<span class="kw">c</span>(var1,var3)],<span class="dt">scale =</span> F)</span>
<span id="cb112-9"><a href="pcamath.html#cb112-9"></a><span class="co"># plot the data</span></span>
<span id="cb112-10"><a href="pcamath.html#cb112-10"></a><span class="kw">plot</span>(x,<span class="dt">xlab =</span> <span class="st">&quot;Variable 1&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Variable 2&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>),<span class="dt">axes =</span> F)</span>
<span id="cb112-11"><a href="pcamath.html#cb112-11"></a></span>
<span id="cb112-12"><a href="pcamath.html#cb112-12"></a><span class="kw">title</span>(<span class="st">&quot;Original data&quot;</span>)</span>
<span id="cb112-13"><a href="pcamath.html#cb112-13"></a><span class="co"># Draw ellipses</span></span>
<span id="cb112-14"><a href="pcamath.html#cb112-14"></a>heplots<span class="op">:::</span><span class="kw">covEllipses.data.frame</span>(<span class="kw">as.data.frame</span>(x),<span class="dt">add=</span>T)</span>
<span id="cb112-15"><a href="pcamath.html#cb112-15"></a></span>
<span id="cb112-16"><a href="pcamath.html#cb112-16"></a><span class="co"># Do PCA</span></span>
<span id="cb112-17"><a href="pcamath.html#cb112-17"></a>eigen_vectors&lt;-<span class="kw">prcomp</span>(x)<span class="op">$</span>rotation</span>
<span id="cb112-18"><a href="pcamath.html#cb112-18"></a></span>
<span id="cb112-19"><a href="pcamath.html#cb112-19"></a><span class="co"># Draw main axis of ellipses</span></span>
<span id="cb112-20"><a href="pcamath.html#cb112-20"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_vectors[<span class="dv">1</span>,<span class="dv">1</span>],eigen_vectors[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb112-21"><a href="pcamath.html#cb112-21"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eigen_vectors[<span class="dv">1</span>,<span class="dv">2</span>],eigen_vectors[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb112-22"><a href="pcamath.html#cb112-22"></a></span>
<span id="cb112-23"><a href="pcamath.html#cb112-23"></a><span class="co"># plot PCA</span></span>
<span id="cb112-24"><a href="pcamath.html#cb112-24"></a><span class="kw">plot</span>(<span class="kw">prcomp</span>(x)<span class="op">$</span>x,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb112-25"><a href="pcamath.html#cb112-25"></a><span class="kw">title</span>(<span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb112-26"><a href="pcamath.html#cb112-26"></a><span class="co"># Draw ellipse</span></span>
<span id="cb112-27"><a href="pcamath.html#cb112-27"></a>heplots<span class="op">:::</span><span class="kw">covEllipses</span>(<span class="kw">as.data.frame</span>(<span class="kw">prcomp</span>(x)<span class="op">$</span>x),<span class="dt">add=</span>T)</span>
<span id="cb112-28"><a href="pcamath.html#cb112-28"></a></span>
<span id="cb112-29"><a href="pcamath.html#cb112-29"></a><span class="co"># Rotate eigen vectors</span></span>
<span id="cb112-30"><a href="pcamath.html#cb112-30"></a>eg2&lt;-eigen_vectors<span class="op">%*%</span>eigen_vectors</span>
<span id="cb112-31"><a href="pcamath.html#cb112-31"></a></span>
<span id="cb112-32"><a href="pcamath.html#cb112-32"></a><span class="co"># plot arrows</span></span>
<span id="cb112-33"><a href="pcamath.html#cb112-33"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eg2[<span class="dv">1</span>,<span class="dv">1</span>],eg2[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span>
<span id="cb112-34"><a href="pcamath.html#cb112-34"></a><span class="kw">arrows</span>(<span class="dv">0</span>,<span class="dv">0</span>,eg2[<span class="dv">1</span>,<span class="dv">2</span>],eg2[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">length=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pcacov2"></span>
<img src="PCA_files/figure-html/pcacov2-1.png" alt="Here, we select two variables and show how the data is spread according to both of the variables. We plotted the main axis of the ellipse and showed how it is rotated by PCA" width="672" />
<p class="caption">
Figure 6.42: Here, we select two variables and show how the data is spread according to both of the variables. We plotted the main axis of the ellipse and showed how it is rotated by PCA
</p>
</div>
<p>We see that in Figure <a href="pcamath.html#fig:pcacov2">6.42</a>, that PCA put an ellipse on the data (the left panel). It finds its main axes The axis are eigenvectors! The axis of the largest spread of the ellipse is the eigenvector with the largest eigenvalue (red arrows) and the second one is the next largest. It then rotates the ellipse around the center so that the eigenvectors are aligned with standard bases <span class="math inline">\([1,0]\)</span> and <span class="math inline">\([0,1]\)</span>. I hope that it’s giving a better intuition about what PCA does!</p>
</div>
<div id="choosing-the-number-of-components" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Choosing the number of components</h3>
<p>I guess one key parameter to set when doing a PCA is to choose the number of components. This is sometimes an arbitrary choice. You can start with for example 2 and go to whatever number that you like. However their methods for choosing the number of components.</p>
<p>For example, one can compute all the components and their eigenvalues. Then we average all the eigenvalues and select those components that have larger eigenvalue than the average. For example for matrix <span class="math inline">\(A\)</span></p>
<p><span class="math display">\[Select \ v \ \ if \ \lambda_v &gt; \frac{\sum_{n=1}^{rank(A)}diag(v)}{rank(A)}\]</span></p>
<p>There are other more iterative methods. For example, doing bootstrapping on the dataset (randomly shuffle the data) and choose the number of components at long as <span class="math inline">\(\lambda\)</span> in the original dataset is larger than <span class="math inline">\(\lambda\)</span> in the bootstrapped data.</p>
<p>However, in practice, one might one to try a few first components. If you see a pattern of interest in the first component, there is normally little reason to go beyond <span class="math inline">\(1\)</span> or <span class="math inline">\(2\)</span> components.</p>
</div>
<div id="eigenvectors-and-regression" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Eigenvectors and regression</h3>
<p>You might end up with some resourcing saying that the PCA eigenvectors are coefficients of linear regression. This is in fact true. The values of eigenvectors can be regarded as coefficients of a multiple linear regression which regresses <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span>. This means if we assume that our first component is <span class="math inline">\(Y_{*,1}\)</span>, our original data is sitting in <span class="math inline">\(X\)</span> (with <span class="math inline">\(n\)</span> variables) and our eigenvector for the first component is <span class="math inline">\(v=[v_1,v_2,v_3,...,v_n]\)</span>, it can be shown that:</p>
<p><span class="math display">\[Y_{*,1}=incetcept+ v_1 \times X_{*,1}+ v_2 \times X_{*,2}+...+v_n \times X_{*,n}+\epsilon\]</span>
So the values of eigenvectors can be thought of as the weights our coefficients of a linear model regression PCA scores on original variables.</p>
</div>
<div id="eigenvectors-loadings-and-correlation" class="section level3">
<h3><span class="header-section-number">6.5.4</span> Eigenvectors, loadings, and correlation</h3>
<p>If you remember, we said that the eigenvectors are unit scaled (divided by their magnitude) and are showing the direction of the largest variance. Wouldn’t it be nice to add a little bit more information about the variance of the direction that eigenvectors point to? We can do this by multiplying eigenvectors by the standard deviation of the components. So now they are not only showing the direction but they are also showing the magnitude of importance. If we do that we start seeing some really cool things:</p>
<p>If we scale and center our data so the mean of each variable is zero and its standard deviation is <span class="math inline">\(1\)</span>. The PCA loadings will be equal to the Pearson correlation between the original data and the PC scores.</p>
<p>Recall, the formula for covariance. That is <span class="math inline">\(Cov(X)=\frac{1}{n-1}X^TX\)</span>, The Pearson correlation is given by the covariance divided by pooled standard deviation so. For two variables, we can say <span class="math inline">\(r=\frac{Cov(x,y)}{\sigma_x \sigma_y}\)</span>. In this formula <span class="math inline">\(\sigma\)</span> is standard deviation of a variable such as <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span>. We already said that we scalled our data so <span class="math inline">\(\sigma=1\)</span> therefore <span class="math inline">\(r_{x,y}=\frac{Cov(x,y)}{\sigma_x \sigma_y}==\frac{Cov(x,y)}{1}=Cov(x,y)\)</span>. So if we scale our data we can find the correlation matrix between original data <span class="math inline">\(X\)</span> and PC scores <span class="math inline">\(Y\)</span> as <span class="math inline">\(Cov(X,Y)=\frac{1}{n-1}X^TY\)</span></p>
<p><span class="math display">\[Cov(X,Y)=\frac{1}{n-1}X^TY=\frac{1}{n-1}(YV^T)^TY=\frac{1}{n-1}VY^TY =V\frac{1}{n-1}Y^TY \]</span>
Didn’t we say that the covariance of Y is <span class="math inline">\(Cov(Y)= \frac{1}{n-1}Y^TY= V^TV \Lambda \  V^TV=\Lambda\)</span>
So then we replace
<span class="math display">\[Cov(X,Y)=V\frac{1}{n-1}Y^TY=V \Lambda \]</span>
This is basically saying that if we scale our eigenvectors by eigenvalues we then have covariance between the original data <span class="math inline">\(X\)</span> and PCA scores <span class="math inline">\(Y\)</span>. If we take the square root of <span class="math inline">\(\Lambda\)</span> we have the correlation, only and only if we have scaled our data.</p>
<p><span class="math inline">\(r(X,Y)=V\sqrt{\Lambda}\)</span></p>
<p>This will come in handy when you start interpreting the results.</p>
</div>
<div id="eigenvector-decomposition-vs.-singular-value-decomposition" class="section level3">
<h3><span class="header-section-number">6.5.5</span> Eigenvector decomposition vs. singular value decomposition</h3>
<p>As said, eigenvector decomposition is only valid on square matrices. We data is normally not square. In PCA, we are interested in variance so PCA does a trick and converts our data to the square form by just taking covariance matrix. It then does eigenvector decomposition on the covariance matrix to diagonalize the covariance matrix giving us only variance.</p>
<p>Calculating the covariance matrix for a large dataset is computationally difficult. We will need to calculate all possible pairwise combinations of all variables which might take a lot of time and memory. In addition, some people might not want to do PCA. They might want to decompose their matrix which is not necessarily a square matrix.</p>
<p>People came up with a solution that can do decomposition on any matrix (necessary a square matrix). This method is called singular value decomposition or SVD. The very detail of this method is well beyond this scope of this chapter but we can quickly have a look at it.</p>
<p>Singular value decomposition says that I can decompose any matrix <span class="math inline">\(X\)</span> to <span class="math inline">\(X=USV^T\)</span>. In this case, <span class="math inline">\(V^T\)</span> has all the eigenvectors, <span class="math inline">\(S\)</span> is all the eigenvalues and <span class="math inline">\(US\)</span> is all the PC scores. Remember, <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are both orthonormal matrices. Isn’t this cool? If we have a matrix <span class="math inline">\(X\)</span> and its eigenvectors <span class="math inline">\(V\)</span>, we can diagonalize it, exactly like we did in eigenvector decomposition. However, in PCA we are not interested in diagonalizing <span class="math inline">\(X\)</span> but we want to do it for the covariance matrix. How do we solve this?</p>
<p>One traditional way to solve <span class="math inline">\(X=USV^T\)</span> is to multiply it by itself (transpose) and solve it like eigenvector decomposition:</p>
<p><span class="math inline">\(X=USV^T\)</span></p>
<p><span class="math inline">\(X^T=VS^TU^T\)</span></p>
<p><span class="math inline">\(X^TX=VS^TU^T \ USV^T\)</span></p>
<p>We know that if <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are orthonormal, then <span class="math inline">\(UU^T=U^TU=I\)</span> and <span class="math inline">\(VV^T=V^TV=1\)</span>. In addition, <span class="math inline">\(S\)</span> is diagonal so <span class="math inline">\(S=S^T\)</span> meaning that we can simplify the above equation to</p>
<p><span class="math inline">\(X^TX=VS^TU^T \ USV^T=VS^2V^T\)</span></p>
<p>Bringing <span class="math inline">\(V^T\)</span> to the other side will give us <span class="math inline">\(X^TXV=VS^2\)</span> What is this? If you remember this looks like the eigenvector decomposition formula:</p>
<p><span class="math display">\[A \  V = \Lambda \  V\]</span>
With this difference that <span class="math inline">\(A=X^TX\)</span>. We can solve this and we get to the same results.</p>
<p>In practice, you saw that this approach did not change our computational problem. In fact, SVD is nowadays calculated using iterative methods that will almost never calculate the whole covariance matrix, letting us do PCA for very large datasets.</p>
</div>
<div id="assumptions-of-pca" class="section level3">
<h3><span class="header-section-number">6.5.6</span> Assumptions of PCA</h3>
<p>PCA like any other method has some assumptions about the data and space. Here are some of the most important ones</p>
<ul>
<li><p>PCA assumes a multivariate normal distribution. As you saw for the ellipsoid example, elliptical distribution is just the generalization of normal distribution. You should also make sure that variance and covariance have meaning in your distribution. I would like to mention that, your data does not need to be strictly normally distributed. PCA works with moderately skewed data. However, if your data is very different from the normal distribution, you will have a problem with PCA</p></li>
<li><p>I guess you realized that PCA work by doing the linear transformation. This means if you suspect a non-linear relationship between your variables, PCA will be probably not that suitable</p></li>
<li><p>When doing PCA, our interest in variance between the observations. If your interest is not variance, PCA is not the method of choice</p></li>
</ul>
</div>
</div>
<div id="final-notes" class="section level2">
<h2><span class="header-section-number">6.6</span> Final notes</h2>
<p>Thanks for reading this chapter. I know the math behind PCA or any other method can be complicated. It’s not required to know the math to be able to apply PCA to your data. It’s just important that you understand the key concept and the thing that PCA does for you. Please remember now, PCA is just a tool. It does not replace a statistician. If for example, the assumptions are not met, this does not invalidate the method itself but it might change the meaning of the results leading to false interpretations. Please go ahead and apply the method to your data but it’s always a good idea to discuss your results with your statistician before concluding anything about the experiment.</p>
<p>Have fun!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exer.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PCA.pdf", "PCA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
